module.exports=[19972,(a,b,c)=>{"use strict";function d(a,b,c){if(a){for(let d of(c&&(c=c.toLowerCase()),a))if(b===d.domain?.split(":",1)[0].toLowerCase()||c===d.defaultLocale.toLowerCase()||d.locales?.some(a=>a.toLowerCase()===c))return d}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"detectDomainLocale",{enumerable:!0,get:function(){return d}})},41927,(a,b,c)=>{"use strict";function d(a){return a.replace(/\/$/,"")||"/"}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removeTrailingSlash",{enumerable:!0,get:function(){return d}})},86456,(a,b,c)=>{"use strict";function d(a){let b=a.indexOf("#"),c=a.indexOf("?"),d=c>-1&&(b<0||c<b);return d||b>-1?{pathname:a.substring(0,d?c:b),query:d?a.substring(c,b>-1?b:void 0):"",hash:b>-1?a.slice(b):""}:{pathname:a,query:"",hash:""}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"parsePath",{enumerable:!0,get:function(){return d}})},19177,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(86456);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${b}${c}${e}${f}`}},7076,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addPathSuffix",{enumerable:!0,get:function(){return e}});let d=a.r(86456);function e(a,b){if(!a.startsWith("/")||!b)return a;let{pathname:c,query:e,hash:f}=(0,d.parsePath)(a);return`${c}${b}${e}${f}`}},68739,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"pathHasPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(86456);function e(a,b){if("string"!=typeof a)return!1;let{pathname:c}=(0,d.parsePath)(a);return c===b||c.startsWith(b+"/")}},19230,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"addLocale",{enumerable:!0,get:function(){return f}});let d=a.r(19177),e=a.r(68739);function f(a,b,c,f){if(!b||b===c)return a;let g=a.toLowerCase();return!f&&((0,e.pathHasPrefix)(g,"/api")||(0,e.pathHasPrefix)(g,`/${b.toLowerCase()}`))?a:(0,d.addPathPrefix)(a,`/${b}`)}},81703,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"formatNextPathnameInfo",{enumerable:!0,get:function(){return h}});let d=a.r(41927),e=a.r(19177),f=a.r(7076),g=a.r(19230);function h(a){let b=(0,g.addLocale)(a.pathname,a.locale,a.buildId?void 0:a.defaultLocale,a.ignorePrefix);return(a.buildId||!a.trailingSlash)&&(b=(0,d.removeTrailingSlash)(b)),a.buildId&&(b=(0,f.addPathSuffix)((0,e.addPathPrefix)(b,`/_next/data/${a.buildId}`),"/"===a.pathname?"index.json":".json")),b=(0,e.addPathPrefix)(b,a.basePath),!a.buildId&&a.trailingSlash?b.endsWith("/")?b:(0,f.addPathSuffix)(b,"/"):(0,d.removeTrailingSlash)(b)}},34808,(a,b,c)=>{"use strict";function d(a,b){let c;if(b?.host&&!Array.isArray(b.host))c=b.host.toString().split(":",1)[0];else{if(!a.hostname)return;c=a.hostname}return c.toLowerCase()}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getHostname",{enumerable:!0,get:function(){return d}})},71294,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"normalizeLocalePath",{enumerable:!0,get:function(){return e}});let d=new WeakMap;function e(a,b){let c;if(!b)return{pathname:a};let e=d.get(b);e||(e=b.map(a=>a.toLowerCase()),d.set(b,e));let f=a.split("/",2);if(!f[1])return{pathname:a};let g=f[1].toLowerCase(),h=e.indexOf(g);return h<0?{pathname:a}:(c=b[h],{pathname:a=a.slice(c.length+1)||"/",detectedLocale:c})}},88735,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"removePathPrefix",{enumerable:!0,get:function(){return e}});let d=a.r(68739);function e(a,b){if(!(0,d.pathHasPrefix)(a,b))return a;let c=a.slice(b.length);return c.startsWith("/")?c:`/${c}`}},87696,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"getNextPathnameInfo",{enumerable:!0,get:function(){return g}});let d=a.r(71294),e=a.r(88735),f=a.r(68739);function g(a,b){let{basePath:c,i18n:g,trailingSlash:h}=b.nextConfig??{},i={pathname:a,trailingSlash:"/"!==a?a.endsWith("/"):h};c&&(0,f.pathHasPrefix)(i.pathname,c)&&(i.pathname=(0,e.removePathPrefix)(i.pathname,c),i.basePath=c);let j=i.pathname;if(i.pathname.startsWith("/_next/data/")&&i.pathname.endsWith(".json")){let a=i.pathname.replace(/^\/_next\/data\//,"").replace(/\.json$/,"").split("/");i.buildId=a[0],j="index"!==a[1]?`/${a.slice(1).join("/")}`:"/",!0===b.parseData&&(i.pathname=j)}if(g){let a=b.i18nProvider?b.i18nProvider.analyze(i.pathname):(0,d.normalizeLocalePath)(i.pathname,g.locales);i.locale=a.detectedLocale,i.pathname=a.pathname??i.pathname,!a.detectedLocale&&i.buildId&&(a=b.i18nProvider?b.i18nProvider.analyze(j):(0,d.normalizeLocalePath)(j,g.locales)).detectedLocale&&(i.locale=a.detectedLocale)}return i}},74482,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NextURL",{enumerable:!0,get:function(){return k}});let d=a.r(19972),e=a.r(81703),f=a.r(34808),g=a.r(87696),h=/(?!^https?:\/\/)(127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}|\[::1\]|localhost)/;function i(a,b){return new URL(String(a).replace(h,"localhost"),b&&String(b).replace(h,"localhost"))}let j=Symbol("NextURLInternal");class k{constructor(a,b,c){let d,e;"object"==typeof b&&"pathname"in b||"string"==typeof b?(d=b,e=c||{}):e=c||b||{},this[j]={url:i(a,d??e.base),options:e,basePath:""},this.analyze()}analyze(){var a,b,c,e,h;let i=(0,g.getNextPathnameInfo)(this[j].url.pathname,{nextConfig:this[j].options.nextConfig,parseData:!0,i18nProvider:this[j].options.i18nProvider}),k=(0,f.getHostname)(this[j].url,this[j].options.headers);this[j].domainLocale=this[j].options.i18nProvider?this[j].options.i18nProvider.detectDomainLocale(k):(0,d.detectDomainLocale)(null==(b=this[j].options.nextConfig)||null==(a=b.i18n)?void 0:a.domains,k);let l=(null==(c=this[j].domainLocale)?void 0:c.defaultLocale)||(null==(h=this[j].options.nextConfig)||null==(e=h.i18n)?void 0:e.defaultLocale);this[j].url.pathname=i.pathname,this[j].defaultLocale=l,this[j].basePath=i.basePath??"",this[j].buildId=i.buildId,this[j].locale=i.locale??l,this[j].trailingSlash=i.trailingSlash}formatPathname(){return(0,e.formatNextPathnameInfo)({basePath:this[j].basePath,buildId:this[j].buildId,defaultLocale:this[j].options.forceLocale?void 0:this[j].defaultLocale,locale:this[j].locale,pathname:this[j].url.pathname,trailingSlash:this[j].trailingSlash})}formatSearch(){return this[j].url.search}get buildId(){return this[j].buildId}set buildId(a){this[j].buildId=a}get locale(){return this[j].locale??""}set locale(a){var b,c;if(!this[j].locale||!(null==(c=this[j].options.nextConfig)||null==(b=c.i18n)?void 0:b.locales.includes(a)))throw Object.defineProperty(TypeError(`The NextURL configuration includes no locale "${a}"`),"__NEXT_ERROR_CODE",{value:"E597",enumerable:!1,configurable:!0});this[j].locale=a}get defaultLocale(){return this[j].defaultLocale}get domainLocale(){return this[j].domainLocale}get searchParams(){return this[j].url.searchParams}get host(){return this[j].url.host}set host(a){this[j].url.host=a}get hostname(){return this[j].url.hostname}set hostname(a){this[j].url.hostname=a}get port(){return this[j].url.port}set port(a){this[j].url.port=a}get protocol(){return this[j].url.protocol}set protocol(a){this[j].url.protocol=a}get href(){let a=this.formatPathname(),b=this.formatSearch();return`${this.protocol}//${this.host}${a}${b}${this.hash}`}set href(a){this[j].url=i(a),this.analyze()}get origin(){return this[j].url.origin}get pathname(){return this[j].url.pathname}set pathname(a){this[j].url.pathname=a}get hash(){return this[j].url.hash}set hash(a){this[j].url.hash=a}get search(){return this[j].url.search}set search(a){this[j].url.search=a}get password(){return this[j].url.password}set password(a){this[j].url.password=a}get username(){return this[j].url.username}set username(a){this[j].url.username=a}get basePath(){return this[j].basePath}set basePath(a){this[j].basePath=a.startsWith("/")?a:`/${a}`}toString(){return this.href}toJSON(){return this.href}[Symbol.for("edge-runtime.inspect.custom")](){return{href:this.href,origin:this.origin,protocol:this.protocol,username:this.username,password:this.password,host:this.host,hostname:this.hostname,port:this.port,pathname:this.pathname,search:this.search,searchParams:this.searchParams,hash:this.hash}}clone(){return new k(String(this),this[j].options)}}},14027,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ACTION_SUFFIX:function(){return q},APP_DIR_ALIAS:function(){return M},CACHE_ONE_YEAR:function(){return C},DOT_NEXT_ALIAS:function(){return K},ESLINT_DEFAULT_DIRS:function(){return ae},GSP_NO_RETURNED_VALUE:function(){return $},GSSP_COMPONENT_MEMBER_ERROR:function(){return ab},GSSP_NO_RETURNED_VALUE:function(){return _},HTML_CONTENT_TYPE_HEADER:function(){return g},INFINITE_CACHE:function(){return D},INSTRUMENTATION_HOOK_FILENAME:function(){return I},JSON_CONTENT_TYPE_HEADER:function(){return h},MATCHED_PATH_HEADER:function(){return k},MIDDLEWARE_FILENAME:function(){return E},MIDDLEWARE_LOCATION_REGEXP:function(){return F},NEXT_BODY_SUFFIX:function(){return t},NEXT_CACHE_IMPLICIT_TAG_ID:function(){return B},NEXT_CACHE_REVALIDATED_TAGS_HEADER:function(){return v},NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER:function(){return w},NEXT_CACHE_SOFT_TAG_MAX_LENGTH:function(){return A},NEXT_CACHE_TAGS_HEADER:function(){return u},NEXT_CACHE_TAG_MAX_ITEMS:function(){return y},NEXT_CACHE_TAG_MAX_LENGTH:function(){return z},NEXT_DATA_SUFFIX:function(){return r},NEXT_INTERCEPTION_MARKER_PREFIX:function(){return j},NEXT_META_SUFFIX:function(){return s},NEXT_QUERY_PARAM_PREFIX:function(){return i},NEXT_RESUME_HEADER:function(){return x},NON_STANDARD_NODE_ENV:function(){return ac},PAGES_DIR_ALIAS:function(){return J},PRERENDER_REVALIDATE_HEADER:function(){return l},PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER:function(){return m},PROXY_FILENAME:function(){return G},PROXY_LOCATION_REGEXP:function(){return H},PUBLIC_DIR_MIDDLEWARE_CONFLICT:function(){return U},ROOT_DIR_ALIAS:function(){return L},RSC_ACTION_CLIENT_WRAPPER_ALIAS:function(){return T},RSC_ACTION_ENCRYPTION_ALIAS:function(){return S},RSC_ACTION_PROXY_ALIAS:function(){return P},RSC_ACTION_VALIDATE_ALIAS:function(){return O},RSC_CACHE_WRAPPER_ALIAS:function(){return Q},RSC_DYNAMIC_IMPORT_WRAPPER_ALIAS:function(){return R},RSC_MOD_REF_PROXY_ALIAS:function(){return N},RSC_SEGMENTS_DIR_SUFFIX:function(){return n},RSC_SEGMENT_SUFFIX:function(){return o},RSC_SUFFIX:function(){return p},SERVER_PROPS_EXPORT_ERROR:function(){return Z},SERVER_PROPS_GET_INIT_PROPS_CONFLICT:function(){return W},SERVER_PROPS_SSG_CONFLICT:function(){return X},SERVER_RUNTIME:function(){return af},SSG_FALLBACK_EXPORT_ERROR:function(){return ad},SSG_GET_INITIAL_PROPS_CONFLICT:function(){return V},STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR:function(){return Y},TEXT_PLAIN_CONTENT_TYPE_HEADER:function(){return f},UNSTABLE_REVALIDATE_RENAME_ERROR:function(){return aa},WEBPACK_LAYERS:function(){return ai},WEBPACK_RESOURCE_QUERIES:function(){return aj},WEB_SOCKET_MAX_RECONNECTIONS:function(){return ag}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="text/plain",g="text/html; charset=utf-8",h="application/json; charset=utf-8",i="nxtP",j="nxtI",k="x-matched-path",l="x-prerender-revalidate",m="x-prerender-revalidate-if-generated",n=".segments",o=".segment.rsc",p=".rsc",q=".action",r=".json",s=".meta",t=".body",u="x-next-cache-tags",v="x-next-revalidated-tags",w="x-next-revalidate-tag-token",x="next-resume",y=128,z=256,A=1024,B="_N_T_",C=31536e3,D=0xfffffffe,E="middleware",F=`(?:src/)?${E}`,G="proxy",H=`(?:src/)?${G}`,I="instrumentation",J="private-next-pages",K="private-dot-next",L="private-next-root-dir",M="private-next-app-dir",N="private-next-rsc-mod-ref-proxy",O="private-next-rsc-action-validate",P="private-next-rsc-server-reference",Q="private-next-rsc-cache-wrapper",R="private-next-rsc-track-dynamic-import",S="private-next-rsc-action-encryption",T="private-next-rsc-action-client-wrapper",U="You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict",V="You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps",W="You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.",X="You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps",Y="can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props",Z="pages with `getServerSideProps` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export",$="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",_="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",aa="The `unstable_revalidate` property is available for general use.\nPlease use `revalidate` instead.",ab="can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member",ac='You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env',ad="Pages with `fallback` enabled in `getStaticPaths` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export",ae=["app","pages","components","lib","src"],af={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},ag=12,ah={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",apiNode:"api-node",apiEdge:"api-edge",middleware:"middleware",instrument:"instrument",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",pagesDirBrowser:"pages-dir-browser",pagesDirEdge:"pages-dir-edge",pagesDirNode:"pages-dir-node"},ai={...ah,GROUP:{builtinReact:[ah.reactServerComponents,ah.actionBrowser],serverOnly:[ah.reactServerComponents,ah.actionBrowser,ah.instrument,ah.middleware],neutralTarget:[ah.apiNode,ah.apiEdge],clientOnly:[ah.serverSideRendering,ah.appPagesBrowser],bundled:[ah.reactServerComponents,ah.actionBrowser,ah.serverSideRendering,ah.appPagesBrowser,ah.shared,ah.instrument,ah.middleware],appPages:[ah.reactServerComponents,ah.serverSideRendering,ah.appPagesBrowser,ah.actionBrowser]}},aj={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"}},89640,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={fromNodeOutgoingHttpHeaders:function(){return g},normalizeNextQueryParam:function(){return k},splitCookiesString:function(){return h},toNodeOutgoingHttpHeaders:function(){return i},validateURL:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(14027);function g(a){let b=new Headers;for(let[c,d]of Object.entries(a))for(let a of Array.isArray(d)?d:[d])void 0!==a&&("number"==typeof a&&(a=a.toString()),b.append(c,a));return b}function h(a){var b,c,d,e,f,g=[],h=0;function i(){for(;h<a.length&&/\s/.test(a.charAt(h));)h+=1;return h<a.length}for(;h<a.length;){for(b=h,f=!1;i();)if(","===(c=a.charAt(h))){for(d=h,h+=1,i(),e=h;h<a.length&&"="!==(c=a.charAt(h))&&";"!==c&&","!==c;)h+=1;h<a.length&&"="===a.charAt(h)?(f=!0,h=e,g.push(a.substring(b,d)),b=h):h=d+1}else h+=1;(!f||h>=a.length)&&g.push(a.substring(b,a.length))}return g}function i(a){let b={},c=[];if(a)for(let[d,e]of a.entries())"set-cookie"===d.toLowerCase()?(c.push(...h(e)),b[d]=1===c.length?c[0]:c):b[d]=e;return b}function j(a){try{return String(new URL(String(a)))}catch(b){throw Object.defineProperty(Error(`URL is malformed "${String(a)}". Please use only absolute URLs - https://nextjs.org/docs/messages/middleware-relative-urls`,{cause:b}),"__NEXT_ERROR_CODE",{value:"E61",enumerable:!1,configurable:!0})}}function k(a){for(let b of[f.NEXT_QUERY_PARAM_PREFIX,f.NEXT_INTERCEPTION_MARKER_PREFIX])if(a!==b&&a.startsWith(b))return a.substring(b.length);return null}},39253,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={PageSignatureError:function(){return f},RemovedPageError:function(){return g},RemovedUAError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});class f extends Error{constructor({page:a}){super(`The middleware "${a}" accepts an async API directly with the form:
  
  export function middleware(request, event) {
    return NextResponse.redirect('/new-location')
  }
  
  Read more: https://nextjs.org/docs/messages/middleware-new-signature
  `)}}class g extends Error{constructor(){super(`The request.page has been deprecated in favour of \`URLPattern\`.
  Read more: https://nextjs.org/docs/messages/middleware-request-page
  `)}}class h extends Error{constructor(){super(`The request.ua has been removed in favour of \`userAgent\` function.
  Read more: https://nextjs.org/docs/messages/middleware-parse-user-agent
  `)}}},77415,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(87164)},52471,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={INTERNALS:function(){return j},NextRequest:function(){return k}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(74482),g=a.r(89640),h=a.r(39253),i=a.r(77415),j=Symbol("internal request");class k extends Request{constructor(a,b={}){const c="string"!=typeof a&&"url"in a?a.url:String(a);(0,g.validateURL)(c),b.body&&"half"!==b.duplex&&(b.duplex="half"),a instanceof Request?super(a,b):super(c,b);const d=new f.NextURL(c,{headers:(0,g.toNodeOutgoingHttpHeaders)(this.headers),nextConfig:b.nextConfig});this[j]={cookies:new i.RequestCookies(this.headers),nextUrl:d,url:d.toString()}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,nextUrl:this.nextUrl,url:this.url,bodyUsed:this.bodyUsed,cache:this.cache,credentials:this.credentials,destination:this.destination,headers:Object.fromEntries(this.headers),integrity:this.integrity,keepalive:this.keepalive,method:this.method,mode:this.mode,redirect:this.redirect,referrer:this.referrer,referrerPolicy:this.referrerPolicy,signal:this.signal}}get cookies(){return this[j].cookies}get nextUrl(){return this[j].nextUrl}get page(){throw new h.RemovedPageError}get ua(){throw new h.RemovedUAError}get url(){return this[j].url}}},7938,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ReflectAdapter",{enumerable:!0,get:function(){return d}});class d{static get(a,b,c){let d=Reflect.get(a,b,c);return"function"==typeof d?d.bind(a):d}static set(a,b,c,d){return Reflect.set(a,b,c,d)}static has(a,b){return Reflect.has(a,b)}static deleteProperty(a,b){return Reflect.deleteProperty(a,b)}}},89750,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"NextResponse",{enumerable:!0,get:function(){return l}});let d=a.r(77415),e=a.r(74482),f=a.r(89640),g=a.r(7938),h=a.r(77415),i=Symbol("internal response"),j=new Set([301,302,303,307,308]);function k(a,b){var c;if(null==a||null==(c=a.request)?void 0:c.headers){if(!(a.request.headers instanceof Headers))throw Object.defineProperty(Error("request.headers must be an instance of Headers"),"__NEXT_ERROR_CODE",{value:"E119",enumerable:!1,configurable:!0});let c=[];for(let[d,e]of a.request.headers)b.set("x-middleware-request-"+d,e),c.push(d);b.set("x-middleware-override-headers",c.join(","))}}class l extends Response{constructor(a,b={}){super(a,b);const c=this.headers,j=new Proxy(new h.ResponseCookies(c),{get(a,e,f){switch(e){case"delete":case"set":return(...f)=>{let g=Reflect.apply(a[e],a,f),i=new Headers(c);return g instanceof h.ResponseCookies&&c.set("x-middleware-set-cookie",g.getAll().map(a=>(0,d.stringifyCookie)(a)).join(",")),k(b,i),g};default:return g.ReflectAdapter.get(a,e,f)}}});this[i]={cookies:j,url:b.url?new e.NextURL(b.url,{headers:(0,f.toNodeOutgoingHttpHeaders)(c),nextConfig:b.nextConfig}):void 0}}[Symbol.for("edge-runtime.inspect.custom")](){return{cookies:this.cookies,url:this.url,body:this.body,bodyUsed:this.bodyUsed,headers:Object.fromEntries(this.headers),ok:this.ok,redirected:this.redirected,status:this.status,statusText:this.statusText,type:this.type}}get cookies(){return this[i].cookies}static json(a,b){let c=Response.json(a,b);return new l(c.body,c)}static redirect(a,b){let c="number"==typeof b?b:(null==b?void 0:b.status)??307;if(!j.has(c))throw Object.defineProperty(RangeError('Failed to execute "redirect" on "response": Invalid status code'),"__NEXT_ERROR_CODE",{value:"E529",enumerable:!1,configurable:!0});let d="object"==typeof b?b:{},e=new Headers(null==d?void 0:d.headers);return e.set("Location",(0,f.validateURL)(a)),new l(null,{...d,headers:e,status:c})}static rewrite(a,b){let c=new Headers(null==b?void 0:b.headers);return c.set("x-middleware-rewrite",(0,f.validateURL)(a)),k(b,c),new l(null,{...b,headers:c})}static next(a){let b=new Headers(null==a?void 0:a.headers);return b.set("x-middleware-next","1"),k(a,b),new l(null,{...a,headers:b})}}},360,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error('ImageResponse moved from "next/server" to "next/og" since Next.js 14, please import from "next/og" instead'),"__NEXT_ERROR_CODE",{value:"E183",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ImageResponse",{enumerable:!0,get:function(){return d}})},536,(a,b,c)=>{var d={226:function(b,c){!function(d,e){"use strict";var f="function",g="undefined",h="object",i="string",j="major",k="model",l="name",m="type",n="vendor",o="version",p="architecture",q="console",r="mobile",s="tablet",t="smarttv",u="wearable",v="embedded",w="Amazon",x="Apple",y="ASUS",z="BlackBerry",A="Browser",B="Chrome",C="Firefox",D="Google",E="Huawei",F="Microsoft",G="Motorola",H="Opera",I="Samsung",J="Sharp",K="Sony",L="Xiaomi",M="Zebra",N="Facebook",O="Chromium OS",P="Mac OS",Q=function(a,b){var c={};for(var d in a)b[d]&&b[d].length%2==0?c[d]=b[d].concat(a[d]):c[d]=a[d];return c},R=function(a){for(var b={},c=0;c<a.length;c++)b[a[c].toUpperCase()]=a[c];return b},S=function(a,b){return typeof a===i&&-1!==T(b).indexOf(T(a))},T=function(a){return a.toLowerCase()},U=function(a,b){if(typeof a===i)return a=a.replace(/^\s\s*/,""),typeof b===g?a:a.substring(0,350)},V=function(a,b){for(var c,d,e,g,i,j,k=0;k<b.length&&!i;){var l=b[k],m=b[k+1];for(c=d=0;c<l.length&&!i&&l[c];)if(i=l[c++].exec(a))for(e=0;e<m.length;e++)j=i[++d],typeof(g=m[e])===h&&g.length>0?2===g.length?typeof g[1]==f?this[g[0]]=g[1].call(this,j):this[g[0]]=g[1]:3===g.length?typeof g[1]!==f||g[1].exec&&g[1].test?this[g[0]]=j?j.replace(g[1],g[2]):void 0:this[g[0]]=j?g[1].call(this,j,g[2]):void 0:4===g.length&&(this[g[0]]=j?g[3].call(this,j.replace(g[1],g[2])):void 0):this[g]=j||void 0;k+=2}},W=function(a,b){for(var c in b)if(typeof b[c]===h&&b[c].length>0){for(var d=0;d<b[c].length;d++)if(S(b[c][d],a))return"?"===c?void 0:c}else if(S(b[c],a))return"?"===c?void 0:c;return a},X={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},Y={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[o,[l,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[o,[l,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[l,o],[/opios[\/ ]+([\w\.]+)/i],[o,[l,H+" Mini"]],[/\bopr\/([\w\.]+)/i],[o,[l,H]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale(?!.+naver)|qqbrowserlite|qq|duckduckgo)\/([-\w\.]+)/i,/(heytap|ovi)browser\/([\d\.]+)/i,/(weibo)__([\d\.]+)/i],[l,o],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[o,[l,"UC"+A]],[/microm.+\bqbcore\/([\w\.]+)/i,/\bqbcore\/([\w\.]+).+microm/i],[o,[l,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[o,[l,"WeChat"]],[/konqueror\/([\w\.]+)/i],[o,[l,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[o,[l,"IE"]],[/ya(?:search)?browser\/([\w\.]+)/i],[o,[l,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[l,/(.+)/,"$1 Secure "+A],o],[/\bfocus\/([\w\.]+)/i],[o,[l,C+" Focus"]],[/\bopt\/([\w\.]+)/i],[o,[l,H+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[o,[l,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[o,[l,"Dolphin"]],[/coast\/([\w\.]+)/i],[o,[l,H+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[o,[l,"MIUI "+A]],[/fxios\/([-\w\.]+)/i],[o,[l,C]],[/\bqihu|(qi?ho?o?|360)browser/i],[[l,"360 "+A]],[/(oculus|samsung|sailfish|huawei)browser\/([\w\.]+)/i],[[l,/(.+)/,"$1 "+A],o],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],o],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[l,o],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i,/\[(linkedin)app\]/i],[l],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[l,N],o],[/(kakao(?:talk|story))[\/ ]([\w\.]+)/i,/(naver)\(.*?(\d+\.[\w\.]+).*\)/i,/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[l,o],[/\bgsa\/([\w\.]+) .*safari\//i],[o,[l,"GSA"]],[/musical_ly(?:.+app_?version\/|_)([\w\.]+)/i],[o,[l,"TikTok"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[o,[l,B+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[l,B+" WebView"],o],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[o,[l,"Android "+A]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[l,o],[/version\/([\w\.\,]+) .*mobile\/\w+ (safari)/i],[o,[l,"Mobile Safari"]],[/version\/([\w(\.|\,)]+) .*(mobile ?safari|safari)/i],[o,l],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[l,[o,W,{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}]],[/(webkit|khtml)\/([\w\.]+)/i],[l,o],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[l,"Netscape"],o],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[o,[l,C+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i,/panasonic;(viera)/i],[l,o],[/(cobalt)\/([\w\.]+)/i],[l,[o,/master.|lts./,""]]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,T]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[p,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[p,"armhf"]],[/windows (ce|mobile); ppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[p,/ower/,"",T]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[p,T]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[ptx]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[k,[n,I],[m,s]],[/\b((?:s[cgp]h|gt|sm)-\w+|sc[g-]?[\d]+a?|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[k,[n,I],[m,r]],[/(?:\/|\()(ip(?:hone|od)[\w, ]*)(?:\/|;)/i],[k,[n,x],[m,r]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[k,[n,x],[m,s]],[/(macintosh);/i],[k,[n,x]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[k,[n,J],[m,r]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[k,[n,E],[m,s]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}e?-[atu]?[ln][\dx][012359c][adn]?)\b(?!.+d\/s)/i],[k,[n,E],[m,r]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max|cc)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[k,/_/g," "],[n,L],[m,r]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[k,/_/g," "],[n,L],[m,s]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[k,[n,"OPPO"],[m,r]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[k,[n,"Vivo"],[m,r]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[k,[n,"Realme"],[m,r]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[k,[n,G],[m,r]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[k,[n,G],[m,s]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[k,[n,"LG"],[m,s]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[k,[n,"LG"],[m,r]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[k,[n,"Lenovo"],[m,s]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[k,/_/g," "],[n,"Nokia"],[m,r]],[/(pixel c)\b/i],[k,[n,D],[m,s]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[k,[n,D],[m,r]],[/droid.+ (a?\d[0-2]{2}so|[c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[k,[n,K],[m,r]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[k,"Xperia Tablet"],[n,K],[m,s]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[k,[n,"OnePlus"],[m,r]],[/(alexa)webm/i,/(kf[a-z]{2}wi|aeo[c-r]{2})( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[k,[n,w],[m,s]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[k,/(.+)/g,"Fire Phone $1"],[n,w],[m,r]],[/(playbook);[-\w\),; ]+(rim)/i],[k,n,[m,s]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[k,[n,z],[m,r]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[k,[n,y],[m,s]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[k,[n,y],[m,r]],[/(nexus 9)/i],[k,[n,"HTC"],[m,s]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic(?!(?:;|\.))|sony(?!-bra))[-_ ]?([-\w]*)/i],[n,[k,/_/g," "],[m,r]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[k,[n,"Acer"],[m,s]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[k,[n,"Meizu"],[m,r]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[n,k,[m,r]],[/(kobo)\s(ereader|touch)/i,/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[n,k,[m,s]],[/(surface duo)/i],[k,[n,F],[m,s]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[k,[n,"Fairphone"],[m,r]],[/(u304aa)/i],[k,[n,"AT&T"],[m,r]],[/\bsie-(\w*)/i],[k,[n,"Siemens"],[m,r]],[/\b(rct\w+) b/i],[k,[n,"RCA"],[m,s]],[/\b(venue[\d ]{2,7}) b/i],[k,[n,"Dell"],[m,s]],[/\b(q(?:mv|ta)\w+) b/i],[k,[n,"Verizon"],[m,s]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[k,[n,"Barnes & Noble"],[m,s]],[/\b(tm\d{3}\w+) b/i],[k,[n,"NuVision"],[m,s]],[/\b(k88) b/i],[k,[n,"ZTE"],[m,s]],[/\b(nx\d{3}j) b/i],[k,[n,"ZTE"],[m,r]],[/\b(gen\d{3}) b.+49h/i],[k,[n,"Swiss"],[m,r]],[/\b(zur\d{3}) b/i],[k,[n,"Swiss"],[m,s]],[/\b((zeki)?tb.*\b) b/i],[k,[n,"Zeki"],[m,s]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[n,"Dragon Touch"],k,[m,s]],[/\b(ns-?\w{0,9}) b/i],[k,[n,"Insignia"],[m,s]],[/\b((nxa|next)-?\w{0,9}) b/i],[k,[n,"NextBook"],[m,s]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[n,"Voice"],k,[m,r]],[/\b(lvtel\-)?(v1[12]) b/i],[[n,"LvTel"],k,[m,r]],[/\b(ph-1) /i],[k,[n,"Essential"],[m,r]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[k,[n,"Envizen"],[m,s]],[/\b(trio[-\w\. ]+) b/i],[k,[n,"MachSpeed"],[m,s]],[/\btu_(1491) b/i],[k,[n,"Rotor"],[m,s]],[/(shield[\w ]+) b/i],[k,[n,"Nvidia"],[m,s]],[/(sprint) (\w+)/i],[n,k,[m,r]],[/(kin\.[onetw]{3})/i],[[k,/\./g," "],[n,F],[m,r]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[k,[n,M],[m,s]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[k,[n,M],[m,r]],[/smart-tv.+(samsung)/i],[n,[m,t]],[/hbbtv.+maple;(\d+)/i],[[k,/^/,"SmartTV"],[n,I],[m,t]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[n,"LG"],[m,t]],[/(apple) ?tv/i],[n,[k,x+" TV"],[m,t]],[/crkey/i],[[k,B+"cast"],[n,D],[m,t]],[/droid.+aft(\w)( bui|\))/i],[k,[n,w],[m,t]],[/\(dtv[\);].+(aquos)/i,/(aquos-tv[\w ]+)\)/i],[k,[n,J],[m,t]],[/(bravia[\w ]+)( bui|\))/i],[k,[n,K],[m,t]],[/(mitv-\w{5}) bui/i],[k,[n,L],[m,t]],[/Hbbtv.*(technisat) (.*);/i],[n,k,[m,t]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w\+ ]*; *([\w\d][^;]*);([^;]*)/i],[[n,U],[k,U],[m,t]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[m,t]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[n,k,[m,q]],[/droid.+; (shield) bui/i],[k,[n,"Nvidia"],[m,q]],[/(playstation [345portablevi]+)/i],[k,[n,K],[m,q]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[k,[n,F],[m,q]],[/((pebble))app/i],[n,k,[m,u]],[/(watch)(?: ?os[,\/]|\d,\d\/)[\d\.]+/i],[k,[n,x],[m,u]],[/droid.+; (glass) \d/i],[k,[n,D],[m,u]],[/droid.+; (wt63?0{2,3})\)/i],[k,[n,M],[m,u]],[/(quest( 2| pro)?)/i],[k,[n,N],[m,u]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[n,[m,v]],[/(aeobc)\b/i],[k,[n,w],[m,v]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[k,[m,r]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[k,[m,s]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[m,s]],[/(phone|mobile(?:[;\/]| [ \w\/\.]*safari)|pda(?=.+windows ce))/i],[[m,r]],[/(android[-\w\. ]{0,9});.+buil/i],[k,[n,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[o,[l,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[o,[l,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i,/\b(libweb)/i],[l,o],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[o,l]],os:[[/microsoft (windows) (vista|xp)/i],[l,o],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[l,[o,W,X]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[l,"Windows"],[o,W,X]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/ios;fbsv\/([\d\.]+)/i,/cfnetwork\/.+darwin/i],[[o,/_/g,"."],[l,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[l,P],[o,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86|harmonyos)/i],[o,l],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[l,o],[/\(bb(10);/i],[o,[l,z]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[o,[l,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[o,[l,C+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[o,[l,"webOS"]],[/watch(?: ?os[,\/]|\d,\d\/)([\d\.]+)/i],[o,[l,"watchOS"]],[/crkey\/([\d\.]+)/i],[o,[l,B+"cast"]],[/(cros) [\w]+(?:\)| ([\w\.]+)\b)/i],[[l,O],o],[/panasonic;(viera)/i,/(netrange)mmh/i,/(nettv)\/(\d+\.[\w\.]+)/i,/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[l,o],[/(sunos) ?([\w\.\d]*)/i],[[l,"Solaris"],o],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux|serenityos)/i,/(unix) ?([\w\.]*)/i],[l,o]]},Z=function(a,b){if(typeof a===h&&(b=a,a=void 0),!(this instanceof Z))return new Z(a,b).getResult();var c=typeof d!==g&&d.navigator?d.navigator:void 0,e=a||(c&&c.userAgent?c.userAgent:""),q=c&&c.userAgentData?c.userAgentData:void 0,t=b?Q(Y,b):Y,u=c&&c.userAgent==e;return this.getBrowser=function(){var a,b={};return b[l]=void 0,b[o]=void 0,V.call(b,e,t.browser),b[j]=typeof(a=b[o])===i?a.replace(/[^\d\.]/g,"").split(".")[0]:void 0,u&&c&&c.brave&&typeof c.brave.isBrave==f&&(b[l]="Brave"),b},this.getCPU=function(){var a={};return a[p]=void 0,V.call(a,e,t.cpu),a},this.getDevice=function(){var a={};return a[n]=void 0,a[k]=void 0,a[m]=void 0,V.call(a,e,t.device),u&&!a[m]&&q&&q.mobile&&(a[m]=r),u&&"Macintosh"==a[k]&&c&&typeof c.standalone!==g&&c.maxTouchPoints&&c.maxTouchPoints>2&&(a[k]="iPad",a[m]=s),a},this.getEngine=function(){var a={};return a[l]=void 0,a[o]=void 0,V.call(a,e,t.engine),a},this.getOS=function(){var a={};return a[l]=void 0,a[o]=void 0,V.call(a,e,t.os),u&&!a[l]&&q&&"Unknown"!=q.platform&&(a[l]=q.platform.replace(/chrome os/i,O).replace(/macos/i,P)),a},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return e},this.setUA=function(a){return e=typeof a===i&&a.length>350?U(a,350):a,this},this.setUA(e),this};if(Z.VERSION="1.0.35",Z.BROWSER=R([l,o,j]),Z.CPU=R([p]),Z.DEVICE=R([k,n,m,q,r,t,s,u,v]),Z.ENGINE=Z.OS=R([l,o]),typeof c!==g)b.exports&&(c=b.exports=Z),c.UAParser=Z;else if(typeof define===f&&define.amd)a.r,void 0!==Z&&a.v(Z);else typeof d!==g&&(d.UAParser=Z);var $=typeof d!==g&&(d.jQuery||d.Zepto);if($&&!$.ua){var _=new Z;$.ua=_.getResult(),$.ua.get=function(){return _.getUA()},$.ua.set=function(a){_.setUA(a);var b=_.getResult();for(var c in b)$.ua[c]=b[c]}}}(this)}},e={};function f(a){var b=e[a];if(void 0!==b)return b.exports;var c=e[a]={exports:{}},g=!0;try{d[a].call(c.exports,c,c.exports,f),g=!1}finally{g&&delete e[a]}return c.exports}f.ab="/ROOT/node_modules/.pnpm/next@16.1.6_@babel+core@7.29.0_@opentelemetry+api@1.9.0_react-dom@19.2.4_react@19.2.4__react@19.2.4/node_modules/next/dist/compiled/ua-parser-js/",b.exports=f(226)},33072,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={isBot:function(){return h},userAgent:function(){return j},userAgentFromString:function(){return i}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=(d=a.r(536))&&d.__esModule?d:{default:d};function h(a){return/Googlebot|Mediapartners-Google|AdsBot-Google|googleweblight|Storebot-Google|Google-PageRenderer|Google-InspectionTool|Bingbot|BingPreview|Slurp|DuckDuckBot|baiduspider|yandex|sogou|LinkedInBot|bitlybot|tumblr|vkShare|quora link preview|facebookexternalhit|facebookcatalog|Twitterbot|applebot|redditbot|Slackbot|Discordbot|WhatsApp|SkypeUriPreview|ia_archiver/i.test(a)}function i(a){return{...(0,g.default)(a),isBot:void 0!==a&&h(a)}}function j({headers:a}){return i(a.get("user-agent")||void 0)}},51921,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"URLPattern",{enumerable:!0,get:function(){return d}});let d="u"<typeof URLPattern?void 0:URLPattern},3049,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"after",{enumerable:!0,get:function(){return e}});let d=a.r(56704);function e(a){let b=d.workAsyncStorage.getStore();if(!b)throw Object.defineProperty(Error("`after` was called outside a request scope. Read more: https://nextjs.org/docs/messages/next-dynamic-api-wrong-context"),"__NEXT_ERROR_CODE",{value:"E468",enumerable:!1,configurable:!0});let{afterContext:c}=b;return c.after(a)}},28706,(a,b,c)=>{"use strict";var d,e;Object.defineProperty(c,"__esModule",{value:!0}),d=a.r(3049),e=c,Object.keys(d).forEach(function(a){"default"===a||Object.prototype.hasOwnProperty.call(e,a)||Object.defineProperty(e,a,{enumerable:!0,get:function(){return d[a]}})})},18566,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={DynamicServerError:function(){return g},isDynamicServerError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="DYNAMIC_SERVER_USAGE";class g extends Error{constructor(a){super(`Dynamic server usage: ${a}`),this.description=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&"string"==typeof a.digest&&a.digest===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},83175,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={StaticGenBailoutError:function(){return g},isStaticGenBailoutError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="NEXT_STATIC_GEN_BAILOUT";class g extends Error{constructor(...a){super(...a),this.code=f}}function h(a){return"object"==typeof a&&null!==a&&"code"in a&&a.code===f}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},33645,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isHangingPromiseRejectionError:function(){return f},makeDevtoolsIOAwarePromise:function(){return l},makeHangingPromise:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});function f(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===g}let g="HANGING_PROMISE_REJECTION";class h extends Error{constructor(a,b){super(`During prerendering, ${b} rejects when the prerender is complete. Typically these errors are handled by React but if you move ${b} to a different context by using \`setTimeout\`, \`after\`, or similar functions you may observe this error and you should handle it in that context. This occurred at route "${a}".`),this.route=a,this.expression=b,this.digest=g}}let i=new WeakMap;function j(a,b,c){if(a.aborted)return Promise.reject(new h(b,c));{let d=new Promise((d,e)=>{let f=e.bind(null,new h(b,c)),g=i.get(a);if(g)g.push(f);else{let b=[f];i.set(a,b),a.addEventListener("abort",()=>{for(let a=0;a<b.length;a++)b[a]()},{once:!0})}});return d.catch(k),d}}function k(){}function l(a,b,c){return b.stagedRendering?b.stagedRendering.delayUntilStage(c,void 0,a):new Promise(b=>{setTimeout(()=>{b(a)},0)})}},37469,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={METADATA_BOUNDARY_NAME:function(){return f},OUTLET_BOUNDARY_NAME:function(){return h},ROOT_LAYOUT_BOUNDARY_NAME:function(){return i},VIEWPORT_BOUNDARY_NAME:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="__next_metadata_boundary__",g="__next_viewport_boundary__",h="__next_outlet_boundary__",i="__next_root_layout_boundary__"},24555,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={atLeastOneTask:function(){return h},scheduleImmediate:function(){return g},scheduleOnNextTick:function(){return f},waitAtLeastOneReactRenderTask:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a=>{Promise.resolve().then(()=>{process.nextTick(a)})},g=a=>{setImmediate(a)};function h(){return new Promise(a=>g(a))}function i(){return new Promise(a=>setImmediate(a))}},19493,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={BailoutToCSRError:function(){return g},isBailoutToCSRError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f="BAILOUT_TO_CLIENT_SIDE_RENDERING";class g extends Error{constructor(a){super(`Bail out to client-side rendering: ${a}`),this.reason=a,this.digest=f}}function h(a){return"object"==typeof a&&null!==a&&"digest"in a&&a.digest===f}},46939,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"InvariantError",{enumerable:!0,get:function(){return d}});class d extends Error{constructor(a,b){super(`Invariant: ${a.endsWith(".")?a:a+"."} This is a bug in Next.js.`,b),this.name="InvariantError"}}},38608,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e,f={Postpone:function(){return B},PreludeState:function(){return $},abortAndThrowOnSynchronousRequestDataAccess:function(){return A},abortOnSynchronousPlatformIOAccess:function(){return z},accessedDynamicData:function(){return J},annotateDynamicAccess:function(){return O},consumeDynamicAccess:function(){return K},createDynamicTrackingState:function(){return s},createDynamicValidationState:function(){return t},createHangingInputAbortSignal:function(){return N},createRenderInBrowserAbortSignal:function(){return M},delayUntilRuntimeStage:function(){return ac},formatDynamicAPIAccesses:function(){return L},getFirstDynamicReason:function(){return u},getStaticShellDisallowedDynamicReasons:function(){return ab},isDynamicPostpone:function(){return E},isPrerenderInterruptedError:function(){return I},logDisallowedDynamicError:function(){return _},markCurrentScopeAsDynamic:function(){return v},postponeWithTracking:function(){return C},throwIfDisallowedDynamic:function(){return aa},throwToInterruptStaticGeneration:function(){return w},trackAllowedDynamicAccess:function(){return W},trackDynamicDataInDynamicRender:function(){return x},trackDynamicHoleInRuntimeShell:function(){return X},trackDynamicHoleInStaticShell:function(){return Y},useDynamicRouteParams:function(){return P},useDynamicSearchParams:function(){return Q}};for(var g in f)Object.defineProperty(c,g,{enumerable:!0,get:f[g]});let h=(d=a.r(19190))&&d.__esModule?d:{default:d},i=a.r(18566),j=a.r(83175),k=a.r(32319),l=a.r(56704),m=a.r(33645),n=a.r(37469),o=a.r(24555),p=a.r(19493),q=a.r(46939),r="function"==typeof h.default.unstable_postpone;function s(a){return{isDebugDynamicAccesses:a,dynamicAccesses:[],syncDynamicErrorWithStack:null}}function t(){return{hasSuspenseAboveBody:!1,hasDynamicMetadata:!1,dynamicMetadata:null,hasDynamicViewport:!1,hasAllowedDynamic:!1,dynamicErrors:[]}}function u(a){var b;return null==(b=a.dynamicAccesses[0])?void 0:b.expression}function v(a,b,c){if(b)switch(b.type){case"cache":case"unstable-cache":case"private-cache":return}if(!a.forceDynamic&&!a.forceStatic){if(a.dynamicShouldError)throw Object.defineProperty(new j.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${c}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(b)switch(b.type){case"prerender-ppr":return C(a.route,c,b.dynamicTracking);case"prerender-legacy":b.revalidate=0;let d=Object.defineProperty(new i.DynamicServerError(`Route ${a.route} couldn't be rendered statically because it used ${c}. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E550",enumerable:!1,configurable:!0});throw a.dynamicUsageDescription=c,a.dynamicUsageStack=d.stack,d}}}function w(a,b,c){let d=Object.defineProperty(new i.DynamicServerError(`Route ${b.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.revalidate=0,b.dynamicUsageDescription=a,b.dynamicUsageStack=d.stack,d}function x(a){switch(a.type){case"cache":case"unstable-cache":case"private-cache":return}}function y(a,b,c){let d=H(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`);c.controller.abort(d);let e=c.dynamicTracking;e&&e.dynamicAccesses.push({stack:e.isDebugDynamicAccesses?Error().stack:void 0,expression:b})}function z(a,b,c,d){let e=d.dynamicTracking;y(a,b,d),e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}function A(a,b,c,d){if(!1===d.controller.signal.aborted){y(a,b,d);let e=d.dynamicTracking;e&&null===e.syncDynamicErrorWithStack&&(e.syncDynamicErrorWithStack=c)}throw H(`Route ${a} needs to bail out of prerendering at this point because it used ${b}.`)}function B({reason:a,route:b}){let c=k.workUnitAsyncStorage.getStore();C(b,a,c&&"prerender-ppr"===c.type?c.dynamicTracking:null)}function C(a,b,c){(function(){if(!r)throw Object.defineProperty(Error("Invariant: React.unstable_postpone is not defined. This suggests the wrong version of React was loaded. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E224",enumerable:!1,configurable:!0})})(),c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:b}),h.default.unstable_postpone(D(a,b))}function D(a,b){return`Route ${a} needs to bail out of prerendering at this point because it used ${b}. React throws this special object to indicate where. It should not be caught by your own try/catch. Learn more: https://nextjs.org/docs/messages/ppr-caught-error`}function E(a){return"object"==typeof a&&null!==a&&"string"==typeof a.message&&F(a.message)}function F(a){return a.includes("needs to bail out of prerendering at this point because it used")&&a.includes("Learn more: https://nextjs.org/docs/messages/ppr-caught-error")}if(!1===F(D("%%%","^^^")))throw Object.defineProperty(Error("Invariant: isDynamicPostpone misidentified a postpone reason. This is a bug in Next.js"),"__NEXT_ERROR_CODE",{value:"E296",enumerable:!1,configurable:!0});let G="NEXT_PRERENDER_INTERRUPTED";function H(a){let b=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return b.digest=G,b}function I(a){return"object"==typeof a&&null!==a&&a.digest===G&&"name"in a&&"message"in a&&a instanceof Error}function J(a){return a.length>0}function K(a,b){return a.dynamicAccesses.push(...b.dynamicAccesses),a.dynamicAccesses}function L(a){return a.filter(a=>"string"==typeof a.stack&&a.stack.length>0).map(({expression:a,stack:b})=>(b=b.split("\n").slice(4).filter(a=>!(a.includes("node_modules/next/")||a.includes(" (<anonymous>)")||a.includes(" (node:"))).join("\n"),`Dynamic API Usage Debug - ${a}:
${b}`))}function M(){let a=new AbortController;return a.abort(Object.defineProperty(new p.BailoutToCSRError("Render in Browser"),"__NEXT_ERROR_CODE",{value:"E721",enumerable:!1,configurable:!0})),a.signal}function N(a){switch(a.type){case"prerender":case"prerender-runtime":let b=new AbortController;if(a.cacheSignal)a.cacheSignal.inputReady().then(()=>{b.abort()});else{let c=(0,k.getRuntimeStagePromise)(a);c?c.then(()=>(0,o.scheduleOnNextTick)(()=>b.abort())):(0,o.scheduleOnNextTick)(()=>b.abort())}return b.signal;case"prerender-client":case"prerender-ppr":case"prerender-legacy":case"request":case"cache":case"private-cache":case"unstable-cache":return}}function O(a,b){let c=b.dynamicTracking;c&&c.dynamicAccesses.push({stack:c.isDebugDynamicAccesses?Error().stack:void 0,expression:a})}function P(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b&&c)switch(c.type){case"prerender-client":case"prerender":{let d=c.fallbackRouteParams;d&&d.size>0&&h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break}case"prerender-ppr":{let d=c.fallbackRouteParams;if(d&&d.size>0)return C(b.route,a,c.dynamicTracking);break}case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called during a runtime prerender. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E771",enumerable:!1,configurable:!0});case"cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0})}}function Q(a){let b=l.workAsyncStorage.getStore(),c=k.workUnitAsyncStorage.getStore();if(b)switch(!c&&(0,k.throwForMissingRequestStore)(a),c.type){case"prerender-client":h.default.use((0,m.makeHangingPromise)(c.renderSignal,b.route,a));break;case"prerender-legacy":case"prerender-ppr":if(b.forceStatic)return;throw Object.defineProperty(new p.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called from a Server Component. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E795",enumerable:!1,configurable:!0});case"cache":case"unstable-cache":case"private-cache":throw Object.defineProperty(new q.InvariantError(`\`${a}\` was called inside a cache scope. Next.js should be preventing ${a} from being included in server components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E745",enumerable:!1,configurable:!0});case"request":return}}let R=/\n\s+at Suspense \(<anonymous>\)/,S=RegExp(`\\n\\s+at Suspense \\(<anonymous>\\)(?:(?!\\n\\s+at (?:body|div|main|section|article|aside|header|footer|nav|form|p|span|h1|h2|h3|h4|h5|h6) \\(<anonymous>\\))[\\s\\S])*?\\n\\s+at ${n.ROOT_LAYOUT_BOUNDARY_NAME} \\([^\\n]*\\)`),T=RegExp(`\\n\\s+at ${n.METADATA_BOUNDARY_NAME}[\\n\\s]`),U=RegExp(`\\n\\s+at ${n.VIEWPORT_BOUNDARY_NAME}[\\n\\s]`),V=RegExp(`\\n\\s+at ${n.OUTLET_BOUNDARY_NAME}[\\n\\s]`);function W(a,b,c,d){if(!V.test(b)){if(T.test(b)){c.hasDynamicMetadata=!0;return}if(U.test(b)){c.hasDynamicViewport=!0;return}if(S.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(R.test(b)){c.hasAllowedDynamic=!0;return}else{if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let e=Z(`Route "${a.route}": Uncached data was accessed outside of <Suspense>. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,b);return void c.dynamicErrors.push(e)}}}function X(a,b,c,d){if(!V.test(b)){if(T.test(b)){c.dynamicMetadata=Z(`Route "${a.route}": Uncached data or \`connection()\` was accessed inside \`generateMetadata\`. Except for this instance, the page would have been entirely prerenderable which may have been the intended behavior. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`,b);return}if(U.test(b)){let d=Z(`Route "${a.route}": Uncached data or \`connection()\` was accessed inside \`generateViewport\`. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`,b);c.dynamicErrors.push(d);return}if(S.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(R.test(b)){c.hasAllowedDynamic=!0;return}else{if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let e=Z(`Route "${a.route}": Uncached data or \`connection()\` was accessed outside of \`<Suspense>\`. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,b);return void c.dynamicErrors.push(e)}}}function Y(a,b,c,d){if(!V.test(b)){if(T.test(b)){c.dynamicMetadata=Z(`Route "${a.route}": Runtime data such as \`cookies()\`, \`headers()\`, \`params\`, or \`searchParams\` was accessed inside \`generateMetadata\` or you have file-based metadata such as icons that depend on dynamic params segments. Except for this instance, the page would have been entirely prerenderable which may have been the intended behavior. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`,b);return}if(U.test(b)){let d=Z(`Route "${a.route}": Runtime data such as \`cookies()\`, \`headers()\`, \`params\`, or \`searchParams\` was accessed inside \`generateViewport\`. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`,b);c.dynamicErrors.push(d);return}if(S.test(b)){c.hasAllowedDynamic=!0,c.hasSuspenseAboveBody=!0;return}else if(R.test(b)){c.hasAllowedDynamic=!0;return}else{if(d.syncDynamicErrorWithStack)return void c.dynamicErrors.push(d.syncDynamicErrorWithStack);let e=Z(`Route "${a.route}": Runtime data such as \`cookies()\`, \`headers()\`, \`params\`, or \`searchParams\` was accessed outside of \`<Suspense>\`. This delays the entire page from rendering, resulting in a slow user experience. Learn more: https://nextjs.org/docs/messages/blocking-route`,b);return void c.dynamicErrors.push(e)}}}function Z(a,b){let c=Object.defineProperty(Error(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return c.stack=c.name+": "+a+b,c}var $=((e={})[e.Full=0]="Full",e[e.Empty=1]="Empty",e[e.Errored=2]="Errored",e);function _(a,b){console.error(b),a.dev||(a.hasReadableErrorStacks?console.error(`To get a more detailed stack trace and pinpoint the issue, start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.`):console.error(`To get a more detailed stack trace and pinpoint the issue, try one of the following:
  - Start the app in development mode by running \`next dev\`, then open "${a.route}" in your browser to investigate the error.
  - Rerun the production build with \`next build --debug-prerender\` to generate better stack traces.`))}function aa(a,b,c,d){if(d.syncDynamicErrorWithStack)throw _(a,d.syncDynamicErrorWithStack),new j.StaticGenBailoutError;if(0!==b){if(c.hasSuspenseAboveBody)return;let d=c.dynamicErrors;if(d.length>0){for(let b=0;b<d.length;b++)_(a,d[b]);throw new j.StaticGenBailoutError}if(c.hasDynamicViewport)throw console.error(`Route "${a.route}" has a \`generateViewport\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) without explicitly allowing fully dynamic rendering. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-viewport`),new j.StaticGenBailoutError;if(1===b)throw console.error(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason. This is a bug in Next.js.`),new j.StaticGenBailoutError}else if(!1===c.hasAllowedDynamic&&c.hasDynamicMetadata)throw console.error(`Route "${a.route}" has a \`generateMetadata\` that depends on Request data (\`cookies()\`, etc...) or uncached external data (\`fetch(...)\`, etc...) when the rest of the route does not. See more info here: https://nextjs.org/docs/messages/next-prerender-dynamic-metadata`),new j.StaticGenBailoutError}function ab(a,b,c){if(c.hasSuspenseAboveBody)return[];if(0!==b){let d=c.dynamicErrors;if(d.length>0)return d;if(1===b)return[Object.defineProperty(new q.InvariantError(`Route "${a.route}" did not produce a static shell and Next.js was unable to determine a reason.`),"__NEXT_ERROR_CODE",{value:"E936",enumerable:!1,configurable:!0})]}else if(!1===c.hasAllowedDynamic&&0===c.dynamicErrors.length&&c.dynamicMetadata)return[c.dynamicMetadata];return[]}function ac(a,b){return a.runtimeStagePromise?a.runtimeStagePromise.then(()=>b):b}},19978,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={isRequestAPICallableInsideAfter:function(){return j},throwForSearchParamsAccessInUseCache:function(){return i},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return h}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(83175),g=a.r(24725);function h(a,b){throw Object.defineProperty(new f.StaticGenBailoutError(`Route ${a} with \`dynamic = "error"\` couldn't be rendered statically because it used ${b}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function i(a,b){let c=Object.defineProperty(Error(`Route ${a.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(c,b),a.invalidDynamicUsageError??=c,c}function j(){let a=g.afterTaskAsyncStorage.getStore();return(null==a?void 0:a.rootTaskSpawnPhase)==="action"}},99857,(a,b,c)=>{"use strict";function d(){let a,b,c=new Promise((c,d)=>{a=c,b=d});return{resolve:a,reject:b,promise:c}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createPromiseWithResolvers",{enumerable:!0,get:function(){return d}})},72633,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={RenderStage:function(){return i},StagedRenderingController:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(46939),h=a.r(99857);var i=((d={})[d.Before=1]="Before",d[d.Static=2]="Static",d[d.Runtime=3]="Runtime",d[d.Dynamic=4]="Dynamic",d[d.Abandoned=5]="Abandoned",d);class j{constructor(a=null,b){this.abortSignal=a,this.hasRuntimePrefetch=b,this.currentStage=1,this.staticInterruptReason=null,this.runtimeInterruptReason=null,this.staticStageEndTime=1/0,this.runtimeStageEndTime=1/0,this.runtimeStageListeners=[],this.dynamicStageListeners=[],this.runtimeStagePromise=(0,h.createPromiseWithResolvers)(),this.dynamicStagePromise=(0,h.createPromiseWithResolvers)(),this.mayAbandon=!1,a&&(a.addEventListener("abort",()=>{let{reason:b}=a;this.currentStage<3&&(this.runtimeStagePromise.promise.catch(k),this.runtimeStagePromise.reject(b)),(this.currentStage<4||5===this.currentStage)&&(this.dynamicStagePromise.promise.catch(k),this.dynamicStagePromise.reject(b))},{once:!0}),this.mayAbandon=!0)}onStage(a,b){if(this.currentStage>=a)b();else if(3===a)this.runtimeStageListeners.push(b);else if(4===a)this.dynamicStageListeners.push(b);else throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}canSyncInterrupt(){if(1===this.currentStage)return!1;let a=this.hasRuntimePrefetch?4:3;return this.currentStage<a}syncInterruptCurrentStageWithReason(a){if(1!==this.currentStage){if(this.mayAbandon)return this.abandonRenderImpl();switch(this.currentStage){case 2:this.staticInterruptReason=a,this.advanceStage(4);return;case 3:this.hasRuntimePrefetch&&(this.runtimeInterruptReason=a,this.advanceStage(4));return}}}getStaticInterruptReason(){return this.staticInterruptReason}getRuntimeInterruptReason(){return this.runtimeInterruptReason}getStaticStageEndTime(){return this.staticStageEndTime}getRuntimeStageEndTime(){return this.runtimeStageEndTime}abandonRender(){if(!this.mayAbandon)throw Object.defineProperty(new g.InvariantError("`abandonRender` called on a stage controller that cannot be abandoned."),"__NEXT_ERROR_CODE",{value:"E938",enumerable:!1,configurable:!0});this.abandonRenderImpl()}abandonRenderImpl(){let{currentStage:a}=this;switch(a){case 2:this.currentStage=5,this.resolveRuntimeStage();return;case 3:this.currentStage=5;return}}advanceStage(a){if(a<=this.currentStage)return;let b=this.currentStage;if(this.currentStage=a,b<3&&a>=3&&(this.staticStageEndTime=performance.now()+performance.timeOrigin,this.resolveRuntimeStage()),b<4&&a>=4){this.runtimeStageEndTime=performance.now()+performance.timeOrigin,this.resolveDynamicStage();return}}resolveRuntimeStage(){let a=this.runtimeStageListeners;for(let b=0;b<a.length;b++)a[b]();a.length=0,this.runtimeStagePromise.resolve()}resolveDynamicStage(){let a=this.dynamicStageListeners;for(let b=0;b<a.length;b++)a[b]();a.length=0,this.dynamicStagePromise.resolve()}getStagePromise(a){switch(a){case 3:return this.runtimeStagePromise.promise;case 4:return this.dynamicStagePromise.promise;default:throw Object.defineProperty(new g.InvariantError(`Invalid render stage: ${a}`),"__NEXT_ERROR_CODE",{value:"E881",enumerable:!1,configurable:!0})}}waitForStage(a){return this.getStagePromise(a)}delayUntilStage(a,b,c){var d,e,f;let g,h=(d=this.getStagePromise(a),e=b,f=c,g=new Promise((a,b)=>{d.then(a.bind(null,f),b)}),void 0!==e&&(g.displayName=e),g);return this.abortSignal&&h.catch(k),h}}function k(){}},38654,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"connection",{enumerable:!0,get:function(){return j}});let d=a.r(56704),e=a.r(32319),f=a.r(38608),g=a.r(83175),h=a.r(33645),i=a.r(19978);function j(){let a=d.workAsyncStorage.getStore(),b=e.workUnitAsyncStorage.getStore();if(a){if(b&&"after"===b.phase&&!(0,i.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside \`after()\`. The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but \`after()\` executes after the request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E827",enumerable:!1,configurable:!0});if(a.forceStatic)return Promise.resolve(void 0);if(a.dynamicShouldError)throw Object.defineProperty(new g.StaticGenBailoutError(`Route ${a.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`connection()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E847",enumerable:!1,configurable:!0});if(b)switch(b.type){case"cache":{let b=Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside "use cache". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual request, but caches must be able to be produced before a request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E841",enumerable:!1,configurable:!0});throw Error.captureStackTrace(b,j),a.invalidDynamicUsageError??=b,b}case"private-cache":{let b=Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside "use cache: private". The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual navigation request, but caches must be able to be produced before a navigation request, so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E837",enumerable:!1,configurable:!0});throw Error.captureStackTrace(b,j),a.invalidDynamicUsageError??=b,b}case"unstable-cache":throw Object.defineProperty(Error(`Route ${a.route} used \`connection()\` inside a function cached with \`unstable_cache()\`. The \`connection()\` function is used to indicate the subsequent code must only run when there is an actual Request, but caches must be able to be produced before a Request so this function is not allowed in this scope. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E840",enumerable:!1,configurable:!0});case"prerender":case"prerender-client":case"prerender-runtime":return(0,h.makeHangingPromise)(b.renderSignal,a.route,"`connection()`");case"prerender-ppr":return(0,f.postponeWithTracking)(a.route,"connection",b.dynamicTracking);case"prerender-legacy":return(0,f.throwToInterruptStaticGeneration)("connection",a,b);case"request":return(0,f.trackDynamicDataInDynamicRender)(b),Promise.resolve(void 0)}}(0,e.throwForMissingRequestStore)("connection")}a.r(72633)},92229,(a,b,c)=>{let d={NextRequest:a.r(52471).NextRequest,NextResponse:a.r(89750).NextResponse,ImageResponse:a.r(360).ImageResponse,userAgentFromString:a.r(33072).userAgentFromString,userAgent:a.r(33072).userAgent,URLPattern:a.r(51921).URLPattern,after:a.r(28706).after,connection:a.r(38654).connection};b.exports=d,c.NextRequest=d.NextRequest,c.NextResponse=d.NextResponse,c.ImageResponse=d.ImageResponse,c.userAgentFromString=d.userAgentFromString,c.userAgent=d.userAgent,c.URLPattern=d.URLPattern,c.after=d.after,c.connection=d.connection},25062,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ActionDidNotRevalidate:function(){return f},ActionDidRevalidateDynamicOnly:function(){return h},ActionDidRevalidateStaticAndDynamic:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=0,g=1,h=2},53756,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={MutableRequestCookiesAdapter:function(){return o},ReadonlyRequestCookiesError:function(){return j},RequestCookiesAdapter:function(){return k},appendMutableCookies:function(){return n},areCookiesMutableInCurrentPhase:function(){return q},createCookiesWithMutableAccessCheck:function(){return p},getModifiedCookieValues:function(){return m},responseCookiesToRequestCookies:function(){return s}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(77415),g=a.r(7938),h=a.r(56704),i=a.r(25062);class j extends Error{constructor(){super("Cookies can only be modified in a Server Action or Route Handler. Read more: https://nextjs.org/docs/app/api-reference/functions/cookies#options")}static callable(){throw new j}}class k{static seal(a){return new Proxy(a,{get(a,b,c){switch(b){case"clear":case"delete":case"set":return j.callable;default:return g.ReflectAdapter.get(a,b,c)}}})}}let l=Symbol.for("next.mutated.cookies");function m(a){let b=a[l];return b&&Array.isArray(b)&&0!==b.length?b:[]}function n(a,b){let c=m(b);if(0===c.length)return!1;let d=new f.ResponseCookies(a),e=d.getAll();for(let a of c)d.set(a);for(let a of e)d.set(a);return!0}class o{static wrap(a,b){let c=new f.ResponseCookies(new Headers);for(let b of a.getAll())c.set(b);let d=[],e=new Set,j=()=>{let a=h.workAsyncStorage.getStore();if(a&&(a.pathWasRevalidated=i.ActionDidRevalidateStaticAndDynamic),d=c.getAll().filter(a=>e.has(a.name)),b){let a=[];for(let b of d){let c=new f.ResponseCookies(new Headers);c.set(b),a.push(c.toString())}b(a)}},k=new Proxy(c,{get(a,b,c){switch(b){case l:return d;case"delete":return function(...b){e.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.delete(...b),k}finally{j()}};case"set":return function(...b){e.add("string"==typeof b[0]?b[0]:b[0].name);try{return a.set(...b),k}finally{j()}};default:return g.ReflectAdapter.get(a,b,c)}}});return k}}function p(a){let b=new Proxy(a.mutableCookies,{get(c,d,e){switch(d){case"delete":return function(...d){return r(a,"cookies().delete"),c.delete(...d),b};case"set":return function(...d){return r(a,"cookies().set"),c.set(...d),b};default:return g.ReflectAdapter.get(c,d,e)}}});return b}function q(a){return"action"===a.phase}function r(a,b){if(!q(a))throw new j}function s(a){let b=new f.RequestCookies(new Headers);for(let c of a.getAll())b.set(c);return b}},23883,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"createDedupedByCallsiteServerErrorLoggerDev",{enumerable:!0,get:function(){return i}});let d=function(a,b){if(a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=e(void 0);if(c&&c.has(a))return c.get(a);var d={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(d,g,h):d[g]=a[g]}return d.default=a,c&&c.set(a,d),d}(a.r(19190));function e(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(e=function(a){return a?c:b})(a)}let f={current:null},g="function"==typeof d.cache?d.cache:a=>a,h=console.warn;function i(a){return function(...b){h(a(...b))}}g(a=>{try{h(f.current)}finally{f.current=null}})},90267,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"cookies",{enumerable:!0,get:function(){return n}});let d=a.r(53756),e=a.r(77415),f=a.r(56704),g=a.r(32319),h=a.r(38608),i=a.r(83175),j=a.r(33645),k=a.r(23883),l=a.r(19978),m=a.r(46939);function n(){let a="cookies",b=f.workAsyncStorage.getStore(),c=g.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,l.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`cookies()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E843",enumerable:!1,configurable:!0});if(b.forceStatic)return p(d.RequestCookiesAdapter.seal(new e.RequestCookies(new Headers({}))));if(b.dynamicShouldError)throw Object.defineProperty(new i.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`cookies()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E849",enumerable:!1,configurable:!0});if(c)switch(c.type){case"cache":let f=Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E831",enumerable:!1,configurable:!0});throw Error.captureStackTrace(f,n),b.invalidDynamicUsageError??=f,f;case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used \`cookies()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`cookies()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E846",enumerable:!1,configurable:!0});case"prerender":var k=b,q=c;let g=o.get(q);if(g)return g;let r=(0,j.makeHangingPromise)(q.renderSignal,k.route,"`cookies()`");return o.set(q,r),r;case"prerender-client":let s="`cookies`";throw Object.defineProperty(new m.InvariantError(`${s} must not be used within a Client Component. Next.js should be preventing ${s} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,h.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,h.throwToInterruptStaticGeneration)(a,b,c);case"prerender-runtime":return(0,h.delayUntilRuntimeStage)(c,p(c.cookies));case"private-cache":return p(c.cookies);case"request":return(0,h.trackDynamicDataInDynamicRender)(c),p((0,d.areCookiesMutableInCurrentPhase)(c)?c.userspaceMutableCookies:c.cookies)}}(0,g.throwForMissingRequestStore)(a)}a.r(72633);let o=new WeakMap;function p(a){let b=o.get(a);if(b)return b;let c=Promise.resolve(a);return o.set(a,c),c}(0,k.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`cookies()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E830",enumerable:!1,configurable:!0})})},17597,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HeadersAdapter:function(){return h},ReadonlyHeadersError:function(){return g}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(7938);class g extends Error{constructor(){super("Headers cannot be modified. Read more: https://nextjs.org/docs/app/api-reference/functions/headers")}static callable(){throw new g}}class h extends Headers{constructor(a){super(),this.headers=new Proxy(a,{get(b,c,d){if("symbol"==typeof c)return f.ReflectAdapter.get(b,c,d);let e=c.toLowerCase(),g=Object.keys(a).find(a=>a.toLowerCase()===e);if(void 0!==g)return f.ReflectAdapter.get(b,g,d)},set(b,c,d,e){if("symbol"==typeof c)return f.ReflectAdapter.set(b,c,d,e);let g=c.toLowerCase(),h=Object.keys(a).find(a=>a.toLowerCase()===g);return f.ReflectAdapter.set(b,h??c,d,e)},has(b,c){if("symbol"==typeof c)return f.ReflectAdapter.has(b,c);let d=c.toLowerCase(),e=Object.keys(a).find(a=>a.toLowerCase()===d);return void 0!==e&&f.ReflectAdapter.has(b,e)},deleteProperty(b,c){if("symbol"==typeof c)return f.ReflectAdapter.deleteProperty(b,c);let d=c.toLowerCase(),e=Object.keys(a).find(a=>a.toLowerCase()===d);return void 0===e||f.ReflectAdapter.deleteProperty(b,e)}})}static seal(a){return new Proxy(a,{get(a,b,c){switch(b){case"append":case"delete":case"set":return g.callable;default:return f.ReflectAdapter.get(a,b,c)}}})}merge(a){return Array.isArray(a)?a.join(", "):a}static from(a){return a instanceof Headers?a:new h(a)}append(a,b){let c=this.headers[a];"string"==typeof c?this.headers[a]=[c,b]:Array.isArray(c)?c.push(b):this.headers[a]=b}delete(a){delete this.headers[a]}get(a){let b=this.headers[a];return void 0!==b?this.merge(b):null}has(a){return void 0!==this.headers[a]}set(a,b){this.headers[a]=b}forEach(a,b){for(let[c,d]of this.entries())a.call(b,d,c,this)}*entries(){for(let a of Object.keys(this.headers)){let b=a.toLowerCase(),c=this.get(b);yield[b,c]}}*keys(){for(let a of Object.keys(this.headers)){let b=a.toLowerCase();yield b}}*values(){for(let a of Object.keys(this.headers)){let b=this.get(a);yield b}}[Symbol.iterator](){return this.entries()}}},63049,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"headers",{enumerable:!0,get:function(){return m}});let d=a.r(17597),e=a.r(56704),f=a.r(32319),g=a.r(38608),h=a.r(83175),i=a.r(33645),j=a.r(23883),k=a.r(19978),l=a.r(46939);function m(){let a="headers",b=e.workAsyncStorage.getStore(),c=f.workUnitAsyncStorage.getStore();if(b){if(c&&"after"===c.phase&&!(0,k.isRequestAPICallableInsideAfter)())throw Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside \`after()\`. This is not supported. If you need this data inside an \`after()\` callback, use \`headers()\` outside of the callback. See more info here: https://nextjs.org/docs/canary/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E839",enumerable:!1,configurable:!0});if(b.forceStatic)return o(d.HeadersAdapter.seal(new Headers({})));if(c)switch(c.type){case"cache":{let a=Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside "use cache". Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E833",enumerable:!1,configurable:!0});throw Error.captureStackTrace(a,m),b.invalidDynamicUsageError??=a,a}case"unstable-cache":throw Object.defineProperty(Error(`Route ${b.route} used \`headers()\` inside a function cached with \`unstable_cache()\`. Accessing Dynamic data sources inside a cache scope is not supported. If you need this data inside a cached function use \`headers()\` outside of the cached function and pass the required dynamic data in as an argument. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E838",enumerable:!1,configurable:!0})}if(b.dynamicShouldError)throw Object.defineProperty(new h.StaticGenBailoutError(`Route ${b.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`headers()\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E828",enumerable:!1,configurable:!0});if(c)switch(c.type){case"prerender":var j=b,p=c;let e=n.get(p);if(e)return e;let f=(0,i.makeHangingPromise)(p.renderSignal,j.route,"`headers()`");return n.set(p,f),f;case"prerender-client":let q="`headers`";throw Object.defineProperty(new l.InvariantError(`${q} must not be used within a client component. Next.js should be preventing ${q} from being included in client components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E693",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,g.postponeWithTracking)(b.route,a,c.dynamicTracking);case"prerender-legacy":return(0,g.throwToInterruptStaticGeneration)(a,b,c);case"prerender-runtime":return(0,g.delayUntilRuntimeStage)(c,o(c.headers));case"private-cache":return o(c.headers);case"request":return(0,g.trackDynamicDataInDynamicRender)(c),o(c.headers)}}(0,f.throwForMissingRequestStore)(a)}a.r(72633);let n=new WeakMap;function o(a){let b=n.get(a);if(b)return b;let c=Promise.resolve(a);return n.set(a,c),c}(0,j.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`headers()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E836",enumerable:!1,configurable:!0})})},13868,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"draftMode",{enumerable:!0,get:function(){return k}});let d=a.r(32319),e=a.r(56704),f=a.r(38608),g=a.r(23883),h=a.r(83175),i=a.r(18566),j=a.r(46939);function k(){let a=e.workAsyncStorage.getStore(),b=d.workUnitAsyncStorage.getStore();switch((!a||!b)&&(0,d.throwForMissingRequestStore)("draftMode"),b.type){case"prerender-runtime":return(0,f.delayUntilRuntimeStage)(b,l(b.draftMode,a));case"request":return l(b.draftMode,a);case"cache":case"private-cache":case"unstable-cache":let c=(0,d.getDraftModeProviderForCacheScope)(a,b);if(c)return l(c,a);case"prerender":case"prerender-client":case"prerender-ppr":case"prerender-legacy":return l(null,a);default:return b}}function l(a,b){let c=n.get(a??m);return c||Promise.resolve(new o(a))}a.r(7938);let m={},n=new WeakMap;class o{constructor(a){this._provider=a}get isEnabled(){return null!==this._provider&&this._provider.isEnabled}enable(){p("draftMode().enable()",this.enable),null!==this._provider&&this._provider.enable()}disable(){p("draftMode().disable()",this.disable),null!==this._provider&&this._provider.disable()}}function p(a,b){let c=e.workAsyncStorage.getStore(),g=d.workUnitAsyncStorage.getStore();if(c){if((null==g?void 0:g.phase)==="after")throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside \`after()\`. The enabled status of \`draftMode()\` can be read inside \`after()\` but you cannot enable or disable \`draftMode()\`. See more info here: https://nextjs.org/docs/app/api-reference/functions/after`),"__NEXT_ERROR_CODE",{value:"E845",enumerable:!1,configurable:!0});if(c.dynamicShouldError)throw Object.defineProperty(new h.StaticGenBailoutError(`Route ${c.route} with \`dynamic = "error"\` couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E553",enumerable:!1,configurable:!0});if(g)switch(g.type){case"cache":case"private-cache":{let d=Object.defineProperty(Error(`Route ${c.route} used "${a}" inside "use cache". The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E829",enumerable:!1,configurable:!0});throw Error.captureStackTrace(d,b),c.invalidDynamicUsageError??=d,d}case"unstable-cache":throw Object.defineProperty(Error(`Route ${c.route} used "${a}" inside a function cached with \`unstable_cache()\`. The enabled status of \`draftMode()\` can be read in caches but you must not enable or disable \`draftMode()\` inside a cache. See more info here: https://nextjs.org/docs/app/api-reference/functions/unstable_cache`),"__NEXT_ERROR_CODE",{value:"E844",enumerable:!1,configurable:!0});case"prerender":case"prerender-runtime":{let b=Object.defineProperty(Error(`Route ${c.route} used ${a} without first calling \`await connection()\`. See more info here: https://nextjs.org/docs/messages/next-prerender-sync-headers`),"__NEXT_ERROR_CODE",{value:"E126",enumerable:!1,configurable:!0});return(0,f.abortAndThrowOnSynchronousRequestDataAccess)(c.route,a,b,g)}case"prerender-client":let d="`draftMode`";throw Object.defineProperty(new j.InvariantError(`${d} must not be used within a Client Component. Next.js should be preventing ${d} from being included in Client Components statically, but did not in this case.`),"__NEXT_ERROR_CODE",{value:"E832",enumerable:!1,configurable:!0});case"prerender-ppr":return(0,f.postponeWithTracking)(c.route,a,g.dynamicTracking);case"prerender-legacy":g.revalidate=0;let e=Object.defineProperty(new i.DynamicServerError(`Route ${c.route} couldn't be rendered statically because it used \`${a}\`. See more info here: https://nextjs.org/docs/messages/dynamic-server-error`),"__NEXT_ERROR_CODE",{value:"E558",enumerable:!1,configurable:!0});throw c.dynamicUsageDescription=a,c.dynamicUsageStack=e.stack,e;case"request":(0,f.trackDynamicDataInDynamicRender)(g)}}}(0,g.createDedupedByCallsiteServerErrorLoggerDev)(function(a,b){let c=a?`Route "${a}" `:"This route ";return Object.defineProperty(Error(`${c}used ${b}. \`draftMode()\` returns a Promise and must be unwrapped with \`await\` or \`React.use()\` before accessing its properties. Learn more: https://nextjs.org/docs/messages/sync-dynamic-apis`),"__NEXT_ERROR_CODE",{value:"E835",enumerable:!1,configurable:!0})})},56030,(a,b,c)=>{b.exports.cookies=a.r(90267).cookies,b.exports.headers=a.r(63049).headers,b.exports.draftMode=a.r(13868).draftMode},43002,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ReadonlyURLSearchParams",{enumerable:!0,get:function(){return e}});class d extends Error{constructor(){super("Method unavailable on `ReadonlyURLSearchParams`. Read more: https://nextjs.org/docs/app/api-reference/functions/use-search-params#updating-searchparams")}}class e extends URLSearchParams{append(){throw new d}delete(){throw new d}set(){throw new d}sort(){throw new d}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},43567,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"RedirectStatusCode",{enumerable:!0,get:function(){return e}});var d,e=((d={})[d.SeeOther=303]="SeeOther",d[d.TemporaryRedirect=307]="TemporaryRedirect",d[d.PermanentRedirect=308]="PermanentRedirect",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},50092,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={REDIRECT_ERROR_CODE:function(){return h},RedirectType:function(){return i},isRedirectError:function(){return j}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g=a.r(43567),h="NEXT_REDIRECT";var i=((d={}).push="push",d.replace="replace",d);function j(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let b=a.digest.split(";"),[c,d]=b,e=b.slice(2,-2).join(";"),f=Number(b.at(-2));return c===h&&("replace"===d||"push"===d)&&"string"==typeof e&&!isNaN(f)&&f in g.RedirectStatusCode}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},51694,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={getRedirectError:function(){return i},getRedirectStatusCodeFromError:function(){return n},getRedirectTypeFromError:function(){return m},getURLFromRedirectError:function(){return l},permanentRedirect:function(){return k},redirect:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(43567),g=a.r(50092),h=a.r(20635).actionAsyncStorage;function i(a,b,c=f.RedirectStatusCode.TemporaryRedirect){let d=Object.defineProperty(Error(g.REDIRECT_ERROR_CODE),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});return d.digest=`${g.REDIRECT_ERROR_CODE};${b};${a};${c};`,d}function j(a,b){throw i(a,b??=h?.getStore()?.isAction?g.RedirectType.push:g.RedirectType.replace,f.RedirectStatusCode.TemporaryRedirect)}function k(a,b=g.RedirectType.replace){throw i(a,b,f.RedirectStatusCode.PermanentRedirect)}function l(a){return(0,g.isRedirectError)(a)?a.digest.split(";").slice(2,-2).join(";"):null}function m(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return a.digest.split(";",2)[1]}function n(a){if(!(0,g.isRedirectError)(a))throw Object.defineProperty(Error("Not a redirect error"),"__NEXT_ERROR_CODE",{value:"E260",enumerable:!1,configurable:!0});return Number(a.digest.split(";").at(-2))}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},18055,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={HTTPAccessErrorStatus:function(){return f},HTTP_ERROR_FALLBACK_ERROR_CODE:function(){return h},getAccessFallbackErrorTypeByStatus:function(){return k},getAccessFallbackHTTPStatus:function(){return j},isHTTPAccessFallbackError:function(){return i}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f={NOT_FOUND:404,FORBIDDEN:403,UNAUTHORIZED:401},g=new Set(Object.values(f)),h="NEXT_HTTP_ERROR_FALLBACK";function i(a){if("object"!=typeof a||null===a||!("digest"in a)||"string"!=typeof a.digest)return!1;let[b,c]=a.digest.split(";");return b===h&&g.has(Number(c))}function j(a){return Number(a.digest.split(";")[1])}function k(a){switch(a){case 401:return"unauthorized";case 403:return"forbidden";case 404:return"not-found";default:return}}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},17303,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"notFound",{enumerable:!0,get:function(){return f}});let d=a.r(18055),e=`${d.HTTP_ERROR_FALLBACK_ERROR_CODE};404`;function f(){let a=Object.defineProperty(Error(e),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0});throw a.digest=e,a}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},50278,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`forbidden()` is experimental and only allowed to be enabled when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E488",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"forbidden",{enumerable:!0,get:function(){return d}}),a.r(18055).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},6304,(a,b,c)=>{"use strict";function d(){throw Object.defineProperty(Error("`unauthorized()` is experimental and only allowed to be used when `experimental.authInterrupts` is enabled."),"__NEXT_ERROR_CODE",{value:"E411",enumerable:!1,configurable:!0})}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unauthorized",{enumerable:!0,get:function(){return d}}),a.r(18055).HTTP_ERROR_FALLBACK_ERROR_CODE,("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},501,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isPostpone",{enumerable:!0,get:function(){return e}});let d=Symbol.for("react.postpone");function e(a){return"object"==typeof a&&null!==a&&a.$$typeof===d}},90158,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isNextRouterError",{enumerable:!0,get:function(){return f}});let d=a.r(18055),e=a.r(50092);function f(a){return(0,e.isRedirectError)(a)||(0,d.isHTTPAccessFallbackError)(a)}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},58744,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return function a(b){if((0,g.isNextRouterError)(b)||(0,f.isBailoutToCSRError)(b)||(0,i.isDynamicServerError)(b)||(0,h.isDynamicPostpone)(b)||(0,e.isPostpone)(b)||(0,d.isHangingPromiseRejectionError)(b)||(0,h.isPrerenderInterruptedError)(b))throw b;b instanceof Error&&"cause"in b&&a(b.cause)}}});let d=a.r(33645),e=a.r(501),f=a.r(19493),g=a.r(90158),h=a.r(38608),i=a.r(18566);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},81403,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"unstable_rethrow",{enumerable:!0,get:function(){return d}});let d=a.r(58744).unstable_rethrow;("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},20145,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={ReadonlyURLSearchParams:function(){return f.ReadonlyURLSearchParams},RedirectType:function(){return h.RedirectType},forbidden:function(){return j.forbidden},notFound:function(){return i.notFound},permanentRedirect:function(){return g.permanentRedirect},redirect:function(){return g.redirect},unauthorized:function(){return k.unauthorized},unstable_isUnrecognizedActionError:function(){return m},unstable_rethrow:function(){return l.unstable_rethrow}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(43002),g=a.r(51694),h=a.r(50092),i=a.r(17303),j=a.r(50278),k=a.r(6304),l=a.r(81403);function m(){throw Object.defineProperty(Error("`unstable_isUnrecognizedActionError` can only be used on the client."),"__NEXT_ERROR_CODE",{value:"E776",enumerable:!1,configurable:!0})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},18145,a=>{"use strict";let b,c,d,e,f,g,h,i,j,k;var l=a.i(46786),m=a.i(22734);let n=new Map,o=new Map,p=Symbol("OriginError"),q={};class r extends Promise{constructor(a,b,c,d,e={}){let f,g;super((a,b)=>{f=a,g=b}),this.tagged=Array.isArray(a.raw),this.strings=a,this.args=b,this.handler=c,this.canceller=d,this.options=e,this.state=null,this.statement=null,this.resolve=a=>(this.active=!1,f(a)),this.reject=a=>(this.active=!1,g(a)),this.active=!1,this.cancelled=null,this.executed=!1,this.signature="",this[p]=this.handler.debug?Error():this.tagged&&function(a){if(n.has(a))return n.get(a);let b=Error.stackTraceLimit;return Error.stackTraceLimit=4,n.set(a,Error()),Error.stackTraceLimit=b,n.get(a)}(this.strings)}get origin(){return(this.handler.debug?this[p].stack:this.tagged&&o.has(this.strings)?o.get(this.strings):o.set(this.strings,this[p].stack).get(this.strings))||""}static get[Symbol.species](){return Promise}cancel(){return this.canceller&&(this.canceller(this),this.canceller=null)}simple(){return this.options.simple=!0,this.options.prepare=!1,this}async readable(){return this.simple(),this.streaming=!0,this}async writable(){return this.simple(),this.streaming=!0,this}cursor(a=1,b){let c;return(this.options.simple=!1,"function"==typeof a&&(b=a,a=1),this.cursorRows=a,"function"==typeof b)?(this.cursorFn=b,this):{[Symbol.asyncIterator]:()=>({next:()=>{if(this.executed&&!this.active)return{done:!0};c&&c();let a=new Promise((a,b)=>{this.cursorFn=b=>(a({value:b,done:!1}),new Promise(a=>c=a)),this.resolve=()=>(this.active=!1,a({done:!0})),this.reject=a=>(this.active=!1,b(a))});return this.execute(),a},return:()=>(c&&c(q),{done:!0})})}}describe(){return this.options.simple=!1,this.onlyDescribe=this.options.prepare=!0,this}stream(){throw Error(".stream has been renamed to .forEach")}forEach(a){return this.forEachFn=a,this.handle(),this}raw(){return this.isRaw=!0,this}values(){return this.isRaw="values",this}async handle(){!this.executed&&(this.executed=!0)&&await 1&&this.handler(this)}execute(){return this.handle(),this}then(){return this.handle(),super.then.apply(this,arguments)}catch(){return this.handle(),super.catch.apply(this,arguments)}finally(){return this.handle(),super.finally.apply(this,arguments)}}class s extends Error{constructor(a){super(a.message),this.name=this.constructor.name,Object.assign(this,a)}}let t=function a(b,c,d){let{host:e,port:f}=d||c,g=Object.assign(Error("write "+b+" "+(c.path||e+":"+f)),{code:b,errno:b,address:c.path||e},c.path?{}:{port:f});return Error.captureStackTrace(g,a),g},u=function a(b){let c=new s(b);return Error.captureStackTrace(c,a),c},v=function a(b,c){let d=Object.assign(Error(b+": "+c),{code:b});return Error.captureStackTrace(d,a),d},w=function a(b){let c=Object.assign(Error(b+" (B) is not supported"),{code:"MESSAGE_NOT_SUPPORTED",name:b});return Error.captureStackTrace(c,a),c};class x{then(){K()}catch(){K()}finally(){K()}}class y extends x{constructor(a){super(),this.value=Q(a)}}class z extends x{constructor(a,b,c){super(),this.value=a,this.type=b,this.array=c}}class A extends x{constructor(a,b){super(),this.first=a,this.rest=b}build(a,b,c,d){let e=J.map(([b,c])=>({fn:c,i:a.search(b)})).sort((a,b)=>a.i-b.i).pop();return -1===e.i?P(this.first,d):e.fn(this.first,this.rest,b,c,d)}}function B(a,b,c,d){let e=a instanceof z?a.value:a;if(void 0===e&&(a instanceof z?a.value=d.transform.undefined:e=a=d.transform.undefined,void 0===e))throw v("UNDEFINED_VALUE","Undefined values are not allowed");return"$"+c.push(a instanceof z?(b.push(a.value),a.array?a.array[a.type||R(a.value)]||a.type||function a(b){return Array.isArray(b)?a(b[0]):1009*("string"==typeof b)}(a.value):a.type):(b.push(a),R(a)))}let C=O({string:{to:25,from:null,serialize:a=>""+a},number:{to:0,from:[21,23,26,700,701],serialize:a=>""+a,parse:a=>+a},json:{to:114,from:[114,3802],serialize:a=>JSON.stringify(a),parse:a=>JSON.parse(a)},boolean:{to:16,from:16,serialize:a=>!0===a?"t":"f",parse:a=>"t"===a},date:{to:1184,from:[1082,1114,1184],serialize:a=>(a instanceof Date?a:new Date(a)).toISOString(),parse:a=>new Date(a)},bytea:{to:17,from:17,serialize:a=>"\\x"+Buffer.from(a).toString("hex"),parse:a=>Buffer.from(a.slice(2),"hex")}});function D(a,b,c,d,e,f){for(let g=1;g<a.strings.length;g++)b+=E(b,c,d,e,f)+a.strings[g],c=a.args[g];return b}function E(a,b,c,d,e){return b instanceof A?b.build(a,c,d,e):b instanceof r?F(b,c,d,e):b instanceof y?b.value:b&&b[0]instanceof r?b.reduce((a,b)=>a+" "+F(b,c,d,e),""):B(b,c,d,e)}function F(a,b,c,d){return a.fragment=!0,D(a,a.strings[0],a.args[0],b,c,d)}function G(a,b,c,d,e){return a.map(a=>"("+d.map(d=>E("values",a[d],b,c,e)).join(",")+")").join(",")}function H(a,b,c,d,e){let f=Array.isArray(a[0]),g=b.length?b.flat():Object.keys(f?a[0]:a);return G(f?a:[a],c,d,g,e)}function I(a,b,c,d,e){let f;return("string"==typeof a&&(a=[a].concat(b)),Array.isArray(a))?P(a,e):(b.length?b.flat():Object.keys(a)).map(b=>((f=a[b])instanceof r?F(f,c,d,e):f instanceof y?f.value:B(f,c,d,e))+" as "+Q(e.transform.column.to?e.transform.column.to(b):b)).join(",")}let J=Object.entries({values:H,in:(...a)=>{let b=H(...a);return"()"===b?"(null)":b},select:I,as:I,returning:I,"\\(":I,update:(a,b,c,d,e)=>(b.length?b.flat():Object.keys(a)).map(b=>Q(e.transform.column.to?e.transform.column.to(b):b)+"="+E("values",a[b],c,d,e)),insert(a,b,c,d,e){let f=b.length?b.flat():Object.keys(Array.isArray(a)?a[0]:a);return"("+P(f,e)+")values"+G(Array.isArray(a)?a:[a],c,d,f,e)}}).map(([a,b])=>[RegExp("((?:^|[\\s(])"+a+"(?:$|[\\s(]))(?![\\s\\S]*\\1)","i"),b]);function K(){throw v("NOT_TAGGED_CALL","Query not called as a tagged template literal")}let L=C.serializers,M=C.parsers,N=function(a){let b=O(a||{});return{serializers:Object.assign({},L,b.serializers),parsers:Object.assign({},M,b.parsers)}};function O(a){return Object.keys(a).reduce((b,c)=>(a[c].from&&[].concat(a[c].from).forEach(d=>b.parsers[d]=a[c].parse),a[c].serialize&&(b.serializers[a[c].to]=a[c].serialize,a[c].from&&[].concat(a[c].from).forEach(d=>b.serializers[d]=a[c].serialize)),b),{parsers:{},serializers:{}})}function P(a,{transform:{column:b}}){return a.map(a=>Q(b.to?b.to(a):a)).join(",")}let Q=function(a){return'"'+a.replace(/"/g,'""').replace(/\./g,'"."')+'"'},R=function a(b){return b instanceof z?b.type:b instanceof Date?1184:b instanceof Uint8Array?17:!0===b||!1===b?16:"bigint"==typeof b?20:Array.isArray(b)?a(b[0]):0},S=/\\/g,T=/"/g,U=function a(b,c,d,e){if(!1===Array.isArray(b))return b;if(!b.length)return"{}";let f=b[0],g=1020===e?";":",";return Array.isArray(f)&&!f.type?"{"+b.map(b=>a(b,c,d,e)).join(g)+"}":"{"+b.map(a=>{if(void 0===a&&void 0===(a=d.transform.undefined))throw v("UNDEFINED_VALUE","Undefined values are not allowed");return null===a?"null":'"'+(c?c(a.type?a.value:a):""+a).replace(S,"\\\\").replace(T,'\\"')+'"'}).join(g)+"}"},V={i:0,char:null,str:"",quoted:!1,last:0},W=a=>{let b=a[0];for(let c=1;c<a.length;c++)b+="_"===a[c]?a[++c].toUpperCase():a[c];return b},X=a=>{let b=a[0].toUpperCase();for(let c=1;c<a.length;c++)b+="_"===a[c]?a[++c].toUpperCase():a[c];return b},Y=a=>a.replace(/_/g,"-"),Z=a=>a.replace(/([A-Z])/g,"_$1").toLowerCase(),$=a=>(a.slice(0,1)+a.slice(1).replace(/([A-Z])/g,"_$1")).toLowerCase(),_=a=>a.replace(/-/g,"_");function aa(a){return function b(c,d){return"object"==typeof c&&null!==c&&(114===d.type||3802===d.type)?Array.isArray(c)?c.map(a=>b(a,d)):Object.entries(c).reduce((c,[e,f])=>Object.assign(c,{[a(e)]:b(f,d)}),{}):c}}W.column={from:W},W.value={from:aa(W)},Z.column={to:Z};let ab={...W};ab.column.to=Z,X.column={from:X},X.value={from:aa(X)},$.column={to:$};let ac={...X};ac.column.to=$,Y.column={from:Y},Y.value={from:aa(Y)},_.column={to:_};let ad={...Y};ad.column.to=_;var ae=a.i(4446),af=a.i(55004),ag=a.i(54799),ah=a.i(88947),ai=a.i(60438);class aj extends Array{constructor(){super(),Object.defineProperties(this,{count:{value:null,writable:!0},state:{value:null,writable:!0},command:{value:null,writable:!0},columns:{value:null,writable:!0},statement:{value:null,writable:!0}})}static get[Symbol.species](){return Array}}let ak=function(a=[]){let b=a.slice(),c=0;return{get length(){return b.length-c},remove:a=>{let c=b.indexOf(a);return -1===c?null:(b.splice(c,1),a)},push:a=>(b.push(a),a),shift:()=>{let a=b[c++];return c===b.length?(c=0,b=[]):b[c-1]=void 0,a}}},al=Buffer.allocUnsafe(256),am=Object.assign(function(){return am.i=0,am},"BCcDdEFfHPpQSX".split("").reduce((a,b)=>{let c=b.charCodeAt(0);return a[b]=()=>(al[0]=c,am.i=5,am),a},{}),{N:"\0",i:0,inc:a=>(am.i+=a,am),str(a){let b=Buffer.byteLength(a);return an(b),am.i+=al.write(a,am.i,b,"utf8"),am},i16:a=>(an(2),al.writeUInt16BE(a,am.i),am.i+=2,am),i32:(a,b)=>(b||0===b?al.writeUInt32BE(a,b):(an(4),al.writeUInt32BE(a,am.i),am.i+=4),am),z:a=>(an(a),al.fill(0,am.i,am.i+a),am.i+=a,am),raw:a=>(al=Buffer.concat([al.subarray(0,am.i),a]),am.i=al.length,am),end(a=1){al.writeUInt32BE(am.i-a,a);let b=al.subarray(0,am.i);return am.i=0,al=Buffer.allocUnsafe(256),b}});function an(a){if(al.length-am.i<a){let b=al,c=b.length;al=Buffer.allocUnsafe(c+(c>>1)+a),b.copy(al)}}let ao=function a(b,c={},{onopen:d=av,onend:e=av,onclose:f=av}={}){let{sslnegotiation:g,ssl:h,max:i,user:j,host:k,port:l,database:m,parsers:n,transform:o,onnotice:p,onnotify:s,onparameter:x,max_pipeline:y,keep_alive:z,backoff:A,target_session_attrs:C}=b,E=ak(),F=ap++,G={pid:null,secret:null},H=aB(aZ,b.idle_timeout),I=aB(aZ,b.max_lifetime),J=aB(function(){aX(t("CONNECT_TIMEOUT",b,K)),K.destroy()},b.connect_timeout),K=null,L,M=null,N=new aj,O=Buffer.alloc(0),P=b.fetch_types,Q={},R={},S=Math.random().toString(36).slice(2),T=1,W=0,X=0,Y=0,Z=0,$=0,_=0,aa=0,ab=null,ac=null,ad=!1,al=null,an=null,ao=null,ax=null,aC=null,aD=null,aE=null,aF=null,aG=null,aH=null,aI={queue:c.closed,idleTimer:H,connect(a){ao=a,aU()},terminate:a$,execute:aL,cancel:aK,end:aZ,count:0,id:F};return c.closed&&c.closed.push(aI),aI;async function aJ(){let a;try{a=b.socket?await Promise.resolve(b.socket(b)):new ae.default.Socket}catch(a){aW(a);return}return a.on("error",aW),a.on("close",a_),a.on("drain",aR),a}async function aK({pid:a,secret:b},c,d){try{L=am().i32(16).i32(0x4d2162e).i32(a).i32(b).end(16),await aT(),K.once("error",d),K.once("close",c)}catch(a){d(a)}}function aL(a){if(ad)return aY(a,t("CONNECTION_DESTROYED",b));if(aC)return aY(a,v("COPY_IN_PROGRESS","You cannot execute queries during copy"));if(!a.cancelled)try{var c;let d,e,f;return a.state=G,aG?E.push(a):(aG=a).active=!0,c=a,d=[],e=[],f=D(c,c.strings[0],c.args[0],d,e,b),c.tagged||c.args.forEach(a=>B(a,d,e,b)),c.prepare=b.prepare&&(!("prepare"in c.options)||c.options.prepare),c.string=f,c.signature=c.prepare&&e+f,c.onlyDescribe&&delete R[c.signature],c.parameters=c.parameters||d,c.prepared=c.prepare&&c.signature in R,c.describeFirst=c.onlyDescribe||d.length&&!c.prepared,c.statement=c.prepared?R[c.signature]:{string:f,types:e,name:c.prepare?S+T++:""},"function"==typeof b.debug&&b.debug(F,f,d,e),aO(function(a){var b;if(a.parameters.length>=65534)throw v("MAX_PARAMETERS_EXCEEDED","Max number of parameters (65534) exceeded");return a.options.simple?am().Q().str(a.statement.string+am.N).end():a.describeFirst?Buffer.concat([aM(a),ar]):a.prepare?a.prepared?aN(a):Buffer.concat([aM(a),aN(a)]):(b=a,Buffer.concat([a9(b.statement.string,b.parameters,b.statement.types),au,aN(b)]))}(a))&&!a.describeFirst&&!a.cursorFn&&E.length<y&&(!a.options.onexecute||a.options.onexecute(aI))}catch(a){return 0===E.length&&aO(aq),aX(a),!0}}function aM(a){return Buffer.concat([a9(a.statement.string,a.parameters,a.statement.types,a.statement.name),function(a,b=""){return am().D().str("S").str(b+am.N).end()}("S",a.statement.name)])}function aN(a){return Buffer.concat([function(a,c,d="",e=""){let f,g;return am().B().str(e+am.N).str(d+am.N).i16(0).i16(a.length),a.forEach((d,e)=>{if(null===d)return am.i32(0xffffffff);g=c[e],a[e]=d=g in b.serializers?b.serializers[g](d):""+d,f=am.i,am.inc(4).str(d).i32(am.i-f-4,f)}),am.i16(0),am.end()}(a.parameters,a.statement.types,a.statement.name,a.cursorName),a.cursorFn?ba("",a.cursorRows):at])}function aO(a,b){return(aD=aD?Buffer.concat([aD,a]):Buffer.from(a),b||aD.length>=1024)?aP(b):(null===ac&&(ac=setImmediate(aP)),!0)}function aP(a){let b=K.write(aD,a);return null!==ac&&clearImmediate(ac),aD=ac=null,b}async function aQ(){if("direct"!==g&&(aO(as),!await new Promise(a=>K.once("data",b=>a(83===b[0])))&&"prefer"===h))return aV();let a={socket:K,servername:ae.default.isIP(K.host)?void 0:K.host};"direct"===g&&(a.ALPNProtocols=["postgresql"]),"require"===h||"allow"===h||"prefer"===h?a.rejectUnauthorized=!1:"object"==typeof h&&Object.assign(a,h),K.removeAllListeners(),(K=af.default.connect(a)).on("secureConnect",aV),K.on("error",aW),K.on("close",a_),K.on("drain",aR)}function aR(){aG||d(aI)}function aS(c){if(!al||(al.push(c),!((X-=c.length)>0)))for(O=al?Buffer.concat(al,$-X):0===O.length?c:Buffer.concat([O,c],O.length+c.length);O.length>4;){if(($=O.readUInt32BE(1))>=O.length){X=$-O.length,al=[O];break}try{!function(c,e=c[0]){(68===e?function(a){let b,c,d,e=7,f=aG.isRaw?Array(aG.statement.columns.length):{};for(let g=0;g<aG.statement.columns.length;g++)c=aG.statement.columns[g],b=a.readInt32BE(e),e+=4,d=-1===b?null:!0===aG.isRaw?a.subarray(e,e+=b):void 0===c.parser?a.toString("utf8",e,e+=b):!0===c.parser.array?c.parser(a.toString("utf8",e+1,e+=b)):c.parser(a.toString("utf8",e,e+=b)),aG.isRaw?f[g]=!0===aG.isRaw?d:o.value.from?o.value.from(d,c):d:f[c.name]=o.value.from?o.value.from(d,c):d;aG.forEachFn?aG.forEachFn(o.row.from?o.row.from(f):f,N):N[aa++]=o.row.from?o.row.from(f):f}:100===e?function(a){aC&&(aC.push(a.subarray(5))||K.pause())}:65===e?function(a){if(!s)return;let b=9;for(;0!==a[b++];);s(a.toString("utf8",9,b-1),a.toString("utf8",b,a.length-1))}:83===e?function(a){let[c,d]=a.toString("utf8",5,a.length-1).split(am.N);Q[c]=d,b.parameters[c]!==d&&(b.parameters[c]=d,x&&x(c,d))}:90===e?function(c){var e,f,g,h;if(aG?M?aG.retried?aX(aG.retried):aG.prepared&&aw.has(M.routine)?(e=aG,f=M,delete R[e.signature],e.retried=f,aL(e)):aX(M):aG.resolve(an||N):M&&aX(M),aG=an=M=null,N=new aj,J.cancel(),ao){if(C)if(!Q.in_hot_standby||!Q.default_transaction_read_only)return function(){let a=new r([`
      show transaction_read_only;
      select pg_catalog.pg_is_in_recovery()
    `],[],aL,null,{simple:!0});a.resolve=([[a],[b]])=>{Q.default_transaction_read_only=a.transaction_read_only,Q.in_hot_standby=b.pg_is_in_recovery?"on":"off"},a.execute()}();else{if(g=C,h=Q,"read-write"===g&&"on"===h.default_transaction_read_only||"read-only"===g&&"off"===h.default_transaction_read_only||"primary"===g&&"on"===h.in_hot_standby||"standby"===g&&"off"===h.in_hot_standby||"prefer-standby"===g&&"off"===h.in_hot_standby&&b.host[Z])return a$()}return P?(ao.reserve&&(ao=null),a7()):(ao&&!ao.reserve&&aL(ao),b.shared.retries=Z=0,void(ao=null))}for(;E.length&&(aG=E.shift())&&(aG.active=!0,aG.cancelled);)a(b).cancel(aG.state,aG.cancelled.resolve,aG.cancelled.reject);aG||(aI.reserved?aI.reserved.release||73!==c[5]?aI.reserved():ax?a$():(aI.reserved=null,d(aI)):ax?a$():d(aI))}:67===e?function(a){aa=0;for(let b=a.length-1;b>0;b--)if(32===a[b]&&a[b+1]<58&&null===N.count&&(N.count=+a.toString("utf8",b+1,a.length-1)),a[b-1]>=65){N.command=a.toString("utf8",5,b),N.state=G;break}return(aH&&(aH(),aH=null),"BEGIN"!==N.command||1===i||aI.reserved)?aG.options.simple?a0():void(aG.cursorFn&&(N.count&&aG.cursorFn(N),aO(aq))):aX(v("UNSAFE_TRANSACTION","Only use sql.begin, sql.reserved or max: 1"))}:50===e?a0:49===e?function(){aG.parsing=!1}:116===e?function(a){let b=a.readUInt16BE(5);for(let c=0;c<b;++c)aG.statement.types[c]||(aG.statement.types[c]=a.readUInt32BE(7+4*c));aG.prepare&&(R[aG.signature]=aG.statement),aG.describeFirst&&!aG.onlyDescribe&&(aO(aN(aG)),aG.describeFirst=!1)}:84===e?function(a){let b;N.command&&((an=an||[N]).push(N=new aj),N.count=null,aG.statement.columns=null);let c=a.readUInt16BE(5),d=7;aG.statement.columns=Array(c);for(let e=0;e<c;++e){for(b=d;0!==a[d++];);let c=a.readUInt32BE(d),f=a.readUInt16BE(d+4),g=a.readUInt32BE(d+6);aG.statement.columns[e]={name:o.column.from?o.column.from(a.toString("utf8",b,d-1)):a.toString("utf8",b,d-1),parser:n[g],table:c,number:f,type:g},d+=18}if(N.statement=aG.statement,aG.onlyDescribe)return aG.resolve(aG.statement),aO(aq)}:82===e?a1:110===e?function(){if(N.statement=aG.statement,N.statement.columns=[],aG.onlyDescribe)return aG.resolve(aG.statement),aO(aq)}:75===e?function(a){G.pid=a.readUInt32BE(5),G.secret=a.readUInt32BE(9)}:69===e?function(a){aG?((aG.cursorFn||aG.describeFirst)&&aO(aq),M=u(ay(a))):aX(u(ay(a)))}:115===e?a8:51===e?function(){N.count&&aG.cursorFn(N),aG.resolve(N)}:71===e?function(){aC=new ah.default.Writable({autoDestroy:!0,write(a,b,c){K.write(am().d().raw(a).end(),c)},destroy(a,b){b(a),K.write(am().f().str(a+am.N).end()),aC=null},final(a){K.write(am().c().end()),aH=a,aC=null}}),aG.resolve(aC)}:78===e?function(a){p?p(ay(a)):console.log(ay(a))}:72===e?function(){aC=new ah.default.Readable({read(){K.resume()}}),aG.resolve(aC)}:99===e?function(){aC&&aC.push(null),aC=null}:73===e?function(){}:86===e?function(){aX(w("FunctionCallResponse"))}:118===e?function(){aX(w("NegotiateProtocolVersion"))}:87===e?function(){aC=new ah.default.Duplex({autoDestroy:!0,read(){K.resume()},write(a,b,c){K.write(am().d().raw(a).end(),c)},destroy(a,b){b(a),K.write(am().f().str(a+am.N).end()),aC=null},final(a){K.write(am().c().end()),aH=a}}),aG.resolve(aC)}:function(a){console.error("Postgres.js : Unknown Message:",a[0])})(c)}(O.subarray(0,$+1))}catch(a){aG&&(aG.cursorFn||aG.describeFirst)&&aO(aq),aX(a)}O=O.subarray($+1),X=0,al=null}}async function aT(){if(ad=!1,Q={},K||(K=await aJ()),K){if(J.start(),b.socket)return h?aQ():aV();if(K.on("connect",h?aQ:aV),b.path)return K.connect(b.path);K.ssl=h,K.connect(l[Y],k[Y]),K.host=k[Y],K.port=l[Y],Y=(Y+1)%l.length}}function aU(){setTimeout(aT,W?Math.max(0,W+_-ai.performance.now()):0)}function aV(){try{R={},P=b.fetch_types,S=Math.random().toString(36).slice(2),T=1,I.start(),K.on("data",aS),z&&K.setKeepAlive&&K.setKeepAlive(!0,1e3*z);let a=L||am().inc(4).i16(3).z(2).str(Object.entries(Object.assign({user:j,database:m,client_encoding:"UTF8"},b.connection)).filter(([,a])=>a).map(([a,b])=>a+am.N+b).join(am.N)).z(2).end(0);aO(a)}catch(a){aW(a)}}function aW(a){if(aI.queue!==c.connecting||!b.host[Z+1])for(aX(a);E.length;)aY(E.shift(),a)}function aX(a){aC&&(aC.destroy(a),aC=null),aG&&aY(aG,a),ao&&(aY(ao,a),ao=null)}function aY(a,c){if(a.reserve)return a.reject(c);c&&"object"==typeof c||(c=Error(c)),"query"in c||"parameters"in c||Object.defineProperties(c,{stack:{value:c.stack+a.origin.replace(/.*\n/,"\n"),enumerable:b.debug},query:{value:a.string,enumerable:b.debug},parameters:{value:a.parameters,enumerable:b.debug},args:{value:a.args,enumerable:b.debug},types:{value:a.statement&&a.statement.types,enumerable:b.debug}}),a.reject(c)}function aZ(){return ax||(aI.reserved||e(aI),aI.reserved||ao||aG||0!==E.length?ax=new Promise(a=>aE=a):(a$(),new Promise(a=>K&&"closed"!==K.readyState?K.once("close",a):a())))}function a$(){ad=!0,(aC||aG||ao||E.length)&&aW(t("CONNECTION_DESTROYED",b)),clearImmediate(ac),K&&(K.removeListener("data",aS),K.removeListener("connect",aV),"open"===K.readyState&&K.end(am().X().end())),aE&&(aE(),ax=aE=null)}async function a_(a){if(O=Buffer.alloc(0),X=0,al=null,clearImmediate(ac),K.removeListener("data",aS),K.removeListener("connect",aV),H.cancel(),I.cancel(),J.cancel(),K.removeAllListeners(),K=null,ao)return aU();!a&&(aG||E.length)&&aW(t("CONNECTION_CLOSED",b,K)),W=ai.performance.now(),a&&b.shared.retries++,_=("function"==typeof A?A(b.shared.retries):A)*1e3,f(aI,t("CONNECTION_CLOSED",b,K))}function a0(){N.statement||(N.statement=aG.statement),N.columns=aG.statement.columns}async function a1(a,b=a.readUInt32BE(5)){(3===b?a2:5===b?a3:10===b?a4:11===b?a5:12===b?function(a){a.toString("utf8",9).split(am.N,1)[0].slice(2)!==ab&&(aX(v("SASL_SIGNATURE_MISMATCH","The server did not return the correct signature")),K.destroy())}:0!==b?function(a,b){console.error("Postgres.js : Unknown Auth:",b)}:av)(a,b)}async function a2(){let a=await a6();aO(am().p().str(a).z(1).end())}async function a3(a){let b="md5"+await az(Buffer.concat([Buffer.from(await az(await a6()+j)),a.subarray(9)]));aO(am().p().str(b).z(1).end())}async function a4(){aF=(await ag.default.randomBytes(18)).toString("base64"),am().p().str("SCRAM-SHA-256"+am.N);let a=am.i;aO(am.inc(4).str("n,,n=*,r="+aF).i32(am.i-a-4,a).end())}async function a5(a){var b;let c=a.toString("utf8",9).split(",").reduce((a,b)=>(a[b[0]]=b.slice(2),a),{}),d=await ag.default.pbkdf2Sync(await a6(),Buffer.from(c.s,"base64"),parseInt(c.i),32,"sha256"),e=await aA(d,"Client Key"),f="n=*,r="+aF+",r="+c.r+",s="+c.s+",i="+c.i+",c=biws,r="+c.r;ab=(await aA(await aA(d,"Server Key"),f)).toString("base64");let g="c=biws,r="+c.r+",p="+(function(a,b){let c=Math.max(a.length,b.length),d=Buffer.allocUnsafe(c);for(let e=0;e<c;e++)d[e]=a[e]^b[e];return d})(e,Buffer.from(await aA(await (b=e,ag.default.createHash("sha256").update(b).digest()),f))).toString("base64");aO(am().p().str(g).end())}function a6(){return Promise.resolve("function"==typeof b.pass?b.pass():b.pass)}async function a7(){P=!1,(await new r([`
      select b.oid, b.typarray
      from pg_catalog.pg_type a
      left join pg_catalog.pg_type b on b.oid = a.typelem
      where a.typcategory = 'A'
      group by b.oid, b.typarray
      order by b.oid
    `],[],aL)).forEach(({oid:a,typarray:c})=>(function(a,c){if(b.parsers[c]&&b.serializers[c])return;let d=b.parsers[a];b.shared.typeArrayMap[a]=c,b.parsers[c]=a=>(V.i=V.last=0,function a(b,c,d,e){let f=[],g=1020===e?";":",";for(;b.i<c.length;b.i++){if(b.char=c[b.i],b.quoted)"\\"===b.char?b.str+=c[++b.i]:'"'===b.char?(f.push(d?d(b.str):b.str),b.str="",b.quoted='"'===c[b.i+1],b.last=b.i+2):b.str+=b.char;else if('"'===b.char)b.quoted=!0;else if("{"===b.char)b.last=++b.i,f.push(a(b,c,d,e));else if("}"===b.char){b.quoted=!1,b.last<b.i&&f.push(d?d(c.slice(b.last,b.i)):c.slice(b.last,b.i)),b.last=b.i+1;break}else b.char===g&&"}"!==b.p&&'"'!==b.p&&(f.push(d?d(c.slice(b.last,b.i)):c.slice(b.last,b.i)),b.last=b.i+1);b.p=b.char}return b.last<b.i&&f.push(d?d(c.slice(b.last,b.i+1)):c.slice(b.last,b.i+1)),f}(V,a,d,c)),b.parsers[c].array=!0,b.serializers[c]=d=>U(d,b.serializers[a],b,c)})(a,c))}async function a8(){try{let a=await Promise.resolve(aG.cursorFn(N));aa=0,a===q?aO(function(a=""){return Buffer.concat([am().C().str("P").str(a+am.N).end(),am().S().end()])}(aG.portal)):(N=new aj,aO(ba("",aG.cursorRows)))}catch(a){aO(aq),aG.reject(a)}}function a9(a,b,c,d=""){return am().P().str(d+am.N).str(a+am.N).i16(b.length),b.forEach((a,b)=>am.i32(c[b]||0)),am.end()}function ba(a="",b=0){return Buffer.concat([am().E().str(a+am.N).i32(b).end(),ar])}},ap=1,aq=am().S().end(),ar=am().H().end(),as=am().i32(8).i32(0x4d2162f).end(8),at=Buffer.concat([am().E().str(am.N).i32(0).end(),aq]),au=am().D().str("S").str(am.N).end(),av=()=>{},aw=new Set(["FetchPreparedStatement","RevalidateCachedQuery","transformAssignedExpr"]),ax={83:"severity_local",86:"severity",67:"code",77:"message",68:"detail",72:"hint",80:"position",112:"internal_position",113:"internal_query",87:"where",115:"schema_name",116:"table_name",99:"column_name",100:"data type_name",110:"constraint_name",70:"file",76:"line",82:"routine"};function ay(a){let b={},c=5;for(let d=5;d<a.length-1;d++)0===a[d]&&(b[ax[a[c]]]=a.toString("utf8",c+1,d),c=d+1);return b}function az(a){return ag.default.createHash("md5").update(a).digest("hex")}function aA(a,b){return ag.default.createHmac("sha256",a).update(b).digest()}function aB(a,b){let c;if(!(b="function"==typeof b?b():b))return{cancel:av,start:av};return{cancel(){c&&(clearTimeout(c),c=null)},start(){c&&clearTimeout(c),c=setTimeout(d,1e3*b,arguments)}};function d(b){a.apply(null,b),c=null}}let aC=()=>{};function aD(a,b,c,d){let e,f,g,h=d.raw?Array(b.length):{};for(let i=0;i<b.length;i++)e=a[c++],f=b[i],g=110===e?null:117===e?void 0:void 0===f.parser?a.toString("utf8",c+4,c+=4+a.readUInt32BE(c)):!0===f.parser.array?f.parser(a.toString("utf8",c+5,c+=4+a.readUInt32BE(c))):f.parser(a.toString("utf8",c+4,c+=4+a.readUInt32BE(c))),d.raw?h[i]=!0===d.raw?g:d.value.from?d.value.from(g,f):g:h[f.name]=d.value.from?d.value.from(g,f):g;return{i:c,row:d.row.from?d.row.from(h):h}}function aE(a,b,c=393216){return new Promise(async(d,e)=>{await a.begin(async a=>{let e;b||([{oid:b}]=await a`select lo_creat(-1) as oid`);let[{fd:f}]=await a`select lo_open(${b}, ${c}) as fd`,g={writable:i,readable:h,close:()=>a`select lo_close(${f})`.then(e),tell:()=>a`select lo_tell64(${f})`,read:b=>a`select loread(${f}, ${b}) as data`,write:b=>a`select lowrite(${f}, ${b})`,truncate:b=>a`select lo_truncate64(${f}, ${b})`,seek:(b,c=0)=>a`select lo_lseek64(${f}, ${b}, ${c})`,size:()=>a`
          select
            lo_lseek64(${f}, location, 0) as position,
            seek.size
          from (
            select
              lo_lseek64($1, 0, 2) as size,
              tell.location
            from (select lo_tell64($1) as location) tell
          ) seek
        `};return d(g),new Promise(async a=>e=a);async function h({highWaterMark:a=16384,start:b=0,end:c=1/0}={}){let d=c-b;return b&&await g.seek(b),new ah.default.Readable({highWaterMark:a,async read(a){let b=a>d?a-d:a;d-=a;let[{data:c}]=await g.read(b);this.push(c),c.length<a&&this.push(null)}})}async function i({highWaterMark:a=16384,start:b=0}={}){return b&&await g.seek(b),new ah.default.Writable({highWaterMark:a,write(a,b,c){g.write(a).then(()=>c(),c)}})}}).catch(e)})}Object.assign(aG,{PostgresError:s,toPascal:X,pascal:ac,toCamel:W,camel:ab,toKebab:Y,kebab:ad,fromPascal:$,fromCamel:Z,fromKebab:_,BigInt:{to:20,from:[20],parse:a=>BigInt(a),serialize:a=>a.toString()}});let aF=aG;function aG(a,b){let c=function(a,b){var c;if(a&&a.shared)return a;let d=process.env,e=(a&&"string"!=typeof a?a:b)||{},{url:f,multihost:g}=function(a){if(!a||"string"!=typeof a)return{url:{searchParams:new Map}};let b=a;b=decodeURIComponent((b=b.slice(b.indexOf("://")+3).split(/[?/]/)[0]).slice(b.indexOf("@")+1));let c=new URL(a.replace(b,b.split(",")[0]));return{url:{username:decodeURIComponent(c.username),password:decodeURIComponent(c.password),host:c.host,hostname:c.hostname,port:c.port,pathname:c.pathname,searchParams:c.searchParams},multihost:b.indexOf(",")>-1&&b}}(a),h=[...f.searchParams].reduce((a,[b,c])=>(a[b]=c,a),{}),i=e.hostname||e.host||g||f.hostname||d.PGHOST||"localhost",j=e.port||f.port||d.PGPORT||5432,k=e.user||e.username||f.username||d.PGUSERNAME||d.PGUSER||function(){try{return l.default.userInfo().username}catch(a){return process.env.USERNAME||process.env.USER||process.env.LOGNAME}}();e.no_prepare&&(e.prepare=!1),h.sslmode&&(h.ssl=h.sslmode,delete h.sslmode),"timeout"in e&&(console.log("The timeout option is deprecated, use idle_timeout instead"),e.idle_timeout=e.timeout),"system"===h.sslrootcert&&(h.ssl="verify-full");let m=["idle_timeout","connect_timeout","max_lifetime","max_pipeline","backoff","keep_alive"],n={max:globalThis.Cloudflare?3:10,ssl:!1,sslnegotiation:null,idle_timeout:null,connect_timeout:30,max_lifetime:aI,max_pipeline:100,backoff:aH,keep_alive:60,prepare:!0,debug:!1,fetch_types:!0,publications:"alltables",target_session_attrs:null};return{host:Array.isArray(i)?i:i.split(",").map(a=>a.split(":")[0]),port:Array.isArray(j)?j:i.split(",").map(a=>parseInt(a.split(":")[1]||j)),path:e.path||i.indexOf("/")>-1&&i+"/.s.PGSQL."+j,database:e.database||e.db||(f.pathname||"").slice(1)||d.PGDATABASE||k,user:k,pass:e.pass||e.password||f.password||d.PGPASSWORD||"",...Object.entries(n).reduce((a,[b,c])=>{let f=b in e?e[b]:b in h?"disable"!==h[b]&&"false"!==h[b]&&h[b]:d["PG"+b.toUpperCase()]||c;return a[b]="string"==typeof f&&m.includes(b)?+f:f,a},{}),connection:{application_name:d.PGAPPNAME||"postgres.js",...e.connection,...Object.entries(h).reduce((a,[b,c])=>(b in n||(a[b]=c),a),{})},types:e.types||{},target_session_attrs:function(a,b,c){let d=a.target_session_attrs||b.searchParams.get("target_session_attrs")||c.PGTARGETSESSIONATTRS;if(!d||["read-write","read-only","primary","standby","prefer-standby"].includes(d))return d;throw Error("target_session_attrs "+d+" is not supported")}(e,f,d),onnotice:e.onnotice,onnotify:e.onnotify,onclose:e.onclose,onparameter:e.onparameter,socket:e.socket,transform:{undefined:(c=e.transform||{undefined:void 0}).undefined,column:{from:"function"==typeof c.column?c.column:c.column&&c.column.from,to:c.column&&c.column.to},value:{from:"function"==typeof c.value?c.value:c.value&&c.value.from,to:c.value&&c.value.to},row:{from:"function"==typeof c.row?c.row:c.row&&c.row.from,to:c.row&&c.row.to}},parameters:{},shared:{retries:0,typeArrayMap:{}},...N(e.types)}}(a,b),d=c.no_subscribe||function(a,b){let c=new Map,d="postgresjs_"+Math.random().toString(36).slice(2),e={},f,g,h=!1,i=l.sql=a({...b,transform:{column:{},value:{},row:{}},max:1,fetch_types:!1,idle_timeout:null,max_lifetime:null,connection:{...b.connection,replication:"database"},onclose:async function(){h||(g=null,e.pid=e.secret=void 0,m(await n(i,d,b.publications)),c.forEach(a=>a.forEach(({onsubscribe:a})=>a())))},no_subscribe:!0}),j=i.end,k=i.close;return i.end=async()=>(h=!0,g&&await new Promise(a=>(g.once("close",a),g.end())),j()),i.close=async()=>(g&&await new Promise(a=>(g.once("close",a),g.end())),k()),l;async function l(a,h,j=aC,k=aC){a=function(a){let[,b,c,d]=a.match(/^(\*|insert|update|delete)?:?([^.]+?\.?[^=]+)?=?(.+)?/i)||[];return(b||"*")+(c?":"+(-1===c.indexOf(".")?"public."+c:c):"")+(d?"="+d:"")}(a),f||(f=n(i,d,b.publications));let o={fn:h,onsubscribe:j},p=c.has(a)?c.get(a).add(o):c.set(a,new Set([o])).get(a),q=()=>{p.delete(o),0===p.size&&c.delete(a)};return f.then(a=>(m(a),j(),g&&g.on("error",k),{unsubscribe:q,state:e,sql:i}))}function m(a){g=a.stream,e.pid=a.state.pid,e.secret=a.state.secret}async function n(a,c,d){if(!d)throw Error("Missing publication names");let e=await a.unsafe(`CREATE_REPLICATION_SLOT ${c} TEMPORARY LOGICAL pgoutput NOEXPORT_SNAPSHOT`),[f]=e,g=await a.unsafe(`START_REPLICATION SLOT ${c} LOGICAL ${f.consistent_point} (proto_version '1', publication_names '${d}')`).writable(),h={lsn:Buffer.concat(f.consistent_point.split("/").map(a=>Buffer.from(("00000000"+a).slice(-8),"hex")))};return g.on("data",function(c){var d,e,f,j,k;let l;119===c[0]?(d=c.subarray(25),e=h,f=a.options.parsers,j=i,k=b.transform,Object.entries({R:a=>{let b=1,c=e[a.readUInt32BE(b)]={schema:a.toString("utf8",b+=4,b=a.indexOf(0,b))||"pg_catalog",table:a.toString("utf8",b+1,b=a.indexOf(0,b+1)),columns:Array(a.readUInt16BE(b+=2)),keys:[]};b+=2;let d=0,g;for(;b<a.length;)(g=c.columns[d++]={key:a[b++],name:k.column.from?k.column.from(a.toString("utf8",b,b=a.indexOf(0,b))):a.toString("utf8",b,b=a.indexOf(0,b)),type:a.readUInt32BE(b+=1),parser:f[a.readUInt32BE(b)],atttypmod:a.readUInt32BE(b+=4)}).key&&c.keys.push(g),b+=4},Y:()=>{},O:()=>{},B:a=>{var b;b=a.readBigInt64BE(9),e.date=new Date(Date.UTC(2e3,0,1)+Number(b/BigInt(1e3))),e.lsn=a.subarray(1,9)},I:a=>{let b=1,c=e[a.readUInt32BE(b)],{row:d}=aD(a,c.columns,b+=7,k);j(d,{command:"insert",relation:c})},D:a=>{let b=1,c=e[a.readUInt32BE(b)],d=75===a[b+=4];j(d||79===a[b]?aD(a,c.columns,b+=3,k).row:null,{command:"delete",relation:c,key:d})},U:a=>{let b=1,c=e[a.readUInt32BE(b)],d=75===a[b+=4],f=d||79===a[b]?aD(a,c.columns,b+=3,k):null;f&&(b=f.i);let{row:g}=aD(a,c.columns,b+3,k);j(g,{command:"update",relation:c,key:d,old:f&&f.row})},T:()=>{},C:()=>{}}).reduce((a,[b,c])=>(a[b.charCodeAt(0)]=c,a),{})[d[0]](d)):107===c[0]&&c[17]&&(h.lsn=c.subarray(1,9),(l=Buffer.alloc(34))[0]=114,l.fill(h.lsn,1),l.writeBigInt64BE(BigInt(Date.now()-Date.UTC(2e3,0,1))*BigInt(1e3),25),g.write(l))}),g.on("error",function(a){console.error("Unexpected error during logical streaming - reconnecting",a)}),g.on("close",a.close),{stream:g,state:e.state};function i(a,b){let c=b.relation.schema+"."+b.relation.table;o("*",a,b),o("*:"+c,a,b),b.relation.keys.length&&o("*:"+c+"="+b.relation.keys.map(b=>a[b.name]),a,b),o(b.command,a,b),o(b.command+":"+c,a,b),b.relation.keys.length&&o(b.command+":"+c+"="+b.relation.keys.map(b=>a[b.name]),a,b)}}function o(a,b,d){c.has(a)&&c.get(a).forEach(({fn:c})=>c(b,d,a))}}(aG,{...c}),e=!1,f=ak(),g=ak(),h=ak(),i=ak(),j=ak(),k=ak(),n=ak(),o=ak(),p={connecting:g,reserved:h,closed:i,ended:j,open:k,busy:n,full:o},u=[...Array(c.max)].map(()=>ao(c,p,{onopen:P,onend:O,onclose:Q})),w=x(function(a){return e?a.reject(t("CONNECTION_ENDED",c,c)):k.length?H(k.shift(),a):i.length?M(i.shift(),a):void(n.length?H(n.shift(),a):f.push(a))});return Object.assign(w,{get parameters(){return c.parameters},largeObject:aE.bind(null,w),subscribe:d,CLOSE:q,END:q,PostgresError:s,options:c,reserve:D,listen:B,begin:E,close:K,end:J}),w;function x(a){return a.debug=c.debug,Object.entries(c.types).reduce((a,[b,c])=>(a[b]=a=>new z(a,c.to),a),b),Object.assign(d,{types:b,typed:b,unsafe:function(b,c=[],d={}){return 2!=arguments.length||Array.isArray(c)||(d=c,c=[]),new r([b],c,a,I,{prepare:!1,...d,simple:"simple"in d?d.simple:0===c.length})},notify:C,array:function a(b,d){return Array.isArray(b)?new z(b,d||(b.length?R(b)||25:0),c.shared.typeArrayMap):a(Array.from(arguments))},json:G,file:function(b,c=[],d={}){return 2!=arguments.length||Array.isArray(c)||(d=c,c=[]),new r([],c,c=>{m.default.readFile(b,"utf8",(b,d)=>{if(b)return c.reject(b);c.strings=[d],a(c)})},I,{...d,simple:"simple"in d?d.simple:0===c.length})}}),d;function b(a,b){return new z(a,b)}function d(b,...e){return b&&Array.isArray(b.raw)?new r(b,e,a,I):"string"!=typeof b||e.length?new A(b,e):new y(c.transform.column.to?c.transform.column.to(b):b)}}async function B(a,b,d){let e={fn:b,onlisten:d},f=B.sql||(B.sql=aG({...c,max:1,idle_timeout:null,max_lifetime:null,fetch_types:!1,onclose(){Object.entries(B.channels).forEach(([a,{listeners:b}])=>{delete B.channels[a],Promise.all(b.map(b=>B(a,b.fn,b.onlisten).catch(()=>{})))})},onnotify(a,b){a in B.channels&&B.channels[a].listeners.forEach(a=>a.fn(b))}})),g=B.channels||(B.channels={});if(a in g){g[a].listeners.push(e);let b=await g[a].result;return e.onlisten&&e.onlisten(),{state:b.state,unlisten:i}}g[a]={result:f`listen ${f.unsafe('"'+a.replace(/"/g,'""')+'"')}`,listeners:[e]};let h=await g[a].result;return e.onlisten&&e.onlisten(),{state:h.state,unlisten:i};async function i(){if(a in g!=!1&&(g[a].listeners=g[a].listeners.filter(a=>a!==e),!g[a].listeners.length))return delete g[a],f`unlisten ${f.unsafe('"'+a.replace(/"/g,'""')+'"')}`}}async function C(a,b){return await w`select pg_notify(${a}, ${""+b})`}async function D(){let a=ak(),b=k.length?k.shift():await new Promise((a,b)=>{let c={reserve:a,reject:b};f.push(c),i.length&&M(i.shift(),c)});F(b,h),b.reserved=()=>a.length?b.execute(a.shift()):F(b,h),b.reserved.release=!0;let c=x(function(c){b.queue===o?a.push(c):b.execute(c)||F(b,o)});return c.release=()=>{b.reserved=null,P(b)},c}async function E(a,b){b||(b=a,a="");let c=ak(),d=0,e,f=null;try{return await w.unsafe("begin "+a.replace(/[^a-z ]/ig,""),[],{onexecute:function(a){e=a,F(a,h),a.reserved=()=>c.length?a.execute(c.shift()):F(a,h)}}).execute(),await Promise.race([g(e,b),new Promise((a,b)=>e.onclose=b)])}catch(a){throw a}async function g(a,b,e){let h,i,j=x(function(b){b.catch(a=>h||(h=a)),a.queue===o?c.push(b):a.execute(b)||F(a,o)});j.savepoint=function b(c,e){return c&&Array.isArray(c.raw)?b(a=>a.apply(a,arguments)):(1==arguments.length&&(e=c,c=null),g(a,e,"s"+d+++(c?"_"+c:"")))},j.prepare=a=>f=a.replace(/[^a-z0-9$-_. ]/gi),e&&await j`savepoint ${j(e)}`;try{if(i=await new Promise((a,c)=>{let d=b(j);Promise.resolve(Array.isArray(d)?Promise.all(d):d).then(a,c)}),h)throw h}catch(a){throw await (e?j`rollback to ${j(e)}`:j`rollback`),a instanceof s&&"25P02"===a.code&&h||a}return e||(f?await j`prepare transaction '${j.unsafe(f)}'`:await j`commit`),i}}function F(a,b){return a.queue.remove(a),b.push(a),a.queue=b,b===k?a.idleTimer.start():a.idleTimer.cancel(),a}function G(a){return new z(a,3802)}function H(a,b){return a.execute(b)?F(a,n):F(a,o)}function I(a){return new Promise((b,d)=>{a.state?a.active?ao(c).cancel(a.state,b,d):a.cancelled={resolve:b,reject:d}:(f.remove(a),a.cancelled=!0,a.reject(v("57014","canceling statement due to user request")),b())})}async function J({timeout:a=null}={}){let b;return e||(await 1,e=Promise.race([new Promise(c=>null!==a&&(b=setTimeout(L,1e3*a,c))),Promise.all(u.map(a=>a.end()).concat(B.sql?B.sql.end({timeout:0}):[],d.sql?d.sql.end({timeout:0}):[]))]).then(()=>clearTimeout(b)))}async function K(){await Promise.all(u.map(a=>a.end()))}async function L(a){for(await Promise.all(u.map(a=>a.terminate()));f.length;)f.shift().reject(t("CONNECTION_DESTROYED",c));a()}function M(a,b){return F(a,g),a.connect(b),a}function O(a){F(a,j)}function P(a){if(0===f.length)return F(a,k);let b=Math.ceil(f.length/(g.length+1)),c=!0;for(;c&&f.length&&b-- >0;){let b=f.shift();if(b.reserve)return b.reserve(a);c=a.execute(b)}c?F(a,n):F(a,o)}function Q(a,b){F(a,i),a.reserved=null,a.onclose&&(a.onclose(b),a.onclose=null),c.onclose&&c.onclose(a.id),f.length&&M(a,f.shift())}}function aH(a){return(.5+Math.random()/2)*Math.min(3**a/100,20)}function aI(){return 60*(30+30*Math.random())}let aJ=Symbol.for("drizzle:entityKind");function aK(a,b){if(!a||"object"!=typeof a)return!1;if(a instanceof b)return!0;if(!Object.prototype.hasOwnProperty.call(b,aJ))throw Error(`Class "${b.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let c=Object.getPrototypeOf(a).constructor;if(c)for(;c;){if(aJ in c&&c[aJ]===b[aJ])return!0;c=Object.getPrototypeOf(c)}return!1}Symbol.for("drizzle:hasOwnEntityKind");class aL{static [aJ]="ConsoleLogWriter";write(a){console.log(a)}}class aM{static [aJ]="DefaultLogger";writer;constructor(a){this.writer=a?.writer??new aL}logQuery(a,b){let c=b.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),d=c.length?` -- params: [${c.join(", ")}]`:"";this.writer.write(`Query: ${a}${d}`)}}class aN{static [aJ]="NoopLogger";logQuery(){}}class aO{static [aJ]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}then(a,b){return this.execute().then(a,b)}}class aP{constructor(a,b){this.table=a,this.config=b,this.name=b.name,this.keyAsName=b.keyAsName,this.notNull=b.notNull,this.default=b.default,this.defaultFn=b.defaultFn,this.onUpdateFn=b.onUpdateFn,this.hasDefault=b.hasDefault,this.primary=b.primaryKey,this.isUnique=b.isUnique,this.uniqueName=b.uniqueName,this.uniqueType=b.uniqueType,this.dataType=b.dataType,this.columnType=b.columnType,this.generated=b.generated,this.generatedIdentity=b.generatedIdentity}static [aJ]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(a){return a}mapToDriverValue(a){return a}shouldDisableInsert(){return void 0!==this.config.generated&&"byDefault"!==this.config.generated.type}}class aQ{static [aJ]="ColumnBuilder";config;constructor(a,b,c){this.config={name:a,keyAsName:""===a,notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:b,columnType:c,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(a){return this.config.default=a,this.config.hasDefault=!0,this}$defaultFn(a){return this.config.defaultFn=a,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(a){return this.config.onUpdateFn=a,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(a){""===this.config.name&&(this.config.name=a)}}let aR=Symbol.for("drizzle:Name");class aS{static [aJ]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=void 0===a?"no action":a,this}onDelete(a){return this._onDelete=void 0===a?"no action":a,this}build(a){return new aT(a,this)}}class aT{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [aJ]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[aR],...d,c[0].table[aR],...e];return a??`${f.join("_")}_fk`}}function aU(a,...b){return a(...b)}function aV(a,b){return`${a[aR]}_${b.join("_")}_unique`}class aW{constructor(a,b){this.name=b,this.columns=a}static [aJ]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(a){return new aY(a,this.columns,this.nullsNotDistinctConfig,this.name)}}class aX{static [aJ]="PgUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new aW(a,this.name)}}class aY{constructor(a,b,c,d){this.table=a,this.columns=b,this.name=d??aV(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=c}static [aJ]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}function aZ(a,b,c){for(let d=b;d<a.length;d++){let e=a[d];if("\\"===e){d++;continue}if('"'===e)return[a.slice(b,d).replace(/\\/g,""),d+1];if(!c&&(","===e||"}"===e))return[a.slice(b,d).replace(/\\/g,""),d]}return[a.slice(b).replace(/\\/g,""),a.length]}class a$ extends aQ{foreignKeyConfigs=[];static [aJ]="PgColumnBuilder";array(a){return new a2(this.config.name,this,a)}references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a,b){return this.config.isUnique=!0,this.config.uniqueName=a,this.config.uniqueType=b?.nulls,this}generatedAlwaysAs(a){return this.config.generated={as:a,type:"always",mode:"stored"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>aU((c,d)=>{let e=new aS(()=>({columns:[a],foreignColumns:[c()]}));return d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)},c,d))}buildExtraConfigColumn(a){return new a0(a,this.config)}}class a_ extends aP{constructor(a,b){b.uniqueName||(b.uniqueName=aV(a,[b.name])),super(a,b),this.table=a}static [aJ]="PgColumn"}class a0 extends a_{static [aJ]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(a){return this.indexConfig.opClass=a,this}}class a1{static [aJ]="IndexedColumn";constructor(a,b,c,d){this.name=a,this.keyAsName=b,this.type=c,this.indexConfig=d}name;keyAsName;type;indexConfig}class a2 extends a${static [aJ]="PgArrayBuilder";constructor(a,b,c){super(a,"array","PgArray"),this.config.baseBuilder=b,this.config.size=c}build(a){let b=this.config.baseBuilder.build(a);return new a3(a,this.config,b)}}class a3 extends a_{constructor(a,b,c,d){super(a,b),this.baseColumn=c,this.range=d,this.size=b.size}size;static [aJ]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${"number"==typeof this.size?this.size:""}]`}mapFromDriverValue(a){return"string"==typeof a&&(a=function(a){let[b]=function a(b,c=0){let d=[],e=c,f=!1;for(;e<b.length;){let g=b[e];if(","===g){(f||e===c)&&d.push(""),f=!0,e++;continue}if(f=!1,"\\"===g){e+=2;continue}if('"'===g){let[a,c]=aZ(b,e+1,!0);d.push(a),e=c;continue}if("}"===g)return[d,e+1];if("{"===g){let[c,f]=a(b,e+1);d.push(c),e=f;continue}let[h,i]=aZ(b,e,!1);d.push(h),e=i}return[d,e]}(a,1);return b}(a)),a.map(a=>this.baseColumn.mapFromDriverValue(a))}mapToDriverValue(a,b=!1){let c=a.map(a=>null===a?null:aK(this.baseColumn,a3)?this.baseColumn.mapToDriverValue(a,!0):this.baseColumn.mapToDriverValue(a));return b?c:function a(b){return`{${b.map(b=>Array.isArray(b)?a(b):"string"==typeof b?`"${b.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${b}`).join(",")}}`}(c)}}class a4 extends a${static [aJ]="PgEnumObjectColumnBuilder";constructor(a,b){super(a,"string","PgEnumObjectColumn"),this.config.enum=b}build(a){return new a5(a,this.config)}}class a5 extends a_{static [aJ]="PgEnumObjectColumn";enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}let a6=Symbol.for("drizzle:isPgEnum");class a7 extends a${static [aJ]="PgEnumColumnBuilder";constructor(a,b){super(a,"string","PgEnumColumn"),this.config.enum=b}build(a){return new a8(a,this.config)}}class a8 extends a_{static [aJ]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(a,b){super(a,b),this.enum=b.enum}getSQLType(){return this.enum.enumName}}class a9{static [aJ]="Subquery";constructor(a,b,c,d=!1,e=[]){this._={brand:"Subquery",sql:a,selectedFields:b,alias:c,isWith:d,usedTables:e}}}class ba extends a9{static [aJ]="WithSubquery"}let bb=(a,d)=>b?(c||(c=b.trace.getTracer("drizzle-orm","0.45.1")),aU((b,c)=>c.startActiveSpan(a,a=>{try{return d(a)}catch(c){throw a.setStatus({code:b.SpanStatusCode.ERROR,message:c instanceof Error?c.message:"Unknown error"}),c}finally{a.end()}}),b,c)):d(),bc=Symbol.for("drizzle:ViewBaseConfig"),bd=Symbol.for("drizzle:Schema"),be=Symbol.for("drizzle:Columns"),bf=Symbol.for("drizzle:ExtraConfigColumns"),bg=Symbol.for("drizzle:OriginalName"),bh=Symbol.for("drizzle:BaseName"),bi=Symbol.for("drizzle:IsAlias"),bj=Symbol.for("drizzle:ExtraConfigBuilder"),bk=Symbol.for("drizzle:IsDrizzleTable");class bl{static [aJ]="Table";static Symbol={Name:aR,Schema:bd,OriginalName:bg,Columns:be,ExtraConfigColumns:bf,BaseName:bh,IsAlias:bi,ExtraConfigBuilder:bj};[aR];[bg];[bd];[be];[bf];[bh];[bi]=!1;[bk]=!0;[bj]=void 0;constructor(a,b,c){this[aR]=this[bg]=a,this[bd]=b,this[bh]=c}}function bm(a){return`${a[bd]??"public"}.${a[aR]}`}class bn{static [aJ]="FakePrimitiveParam"}function bo(a){return null!=a&&"function"==typeof a.getSQL}class bp{static [aJ]="StringChunk";value;constructor(a){this.value=Array.isArray(a)?a:[a]}getSQL(){return new bq([this])}}class bq{constructor(a){for(const b of(this.queryChunks=a,a))if(aK(b,bl)){const a=b[bl.Symbol.Schema];this.usedTables.push(void 0===a?b[bl.Symbol.Name]:a+"."+b[bl.Symbol.Name])}}static [aJ]="SQL";decoder=bs;shouldInlineParams=!1;usedTables=[];append(a){return this.queryChunks.push(...a.queryChunks),this}toQuery(a){return bb("drizzle.buildSQL",b=>{let c=this.buildQueryFromSourceParams(this.queryChunks,a);return b?.setAttributes({"drizzle.query.text":c.sql,"drizzle.query.params":JSON.stringify(c.params)}),c})}buildQueryFromSourceParams(a,b){let c=Object.assign({},b,{inlineParams:b.inlineParams||this.shouldInlineParams,paramStartIndex:b.paramStartIndex||{value:0}}),{casing:d,escapeName:e,escapeParam:f,prepareTyping:g,inlineParams:h,paramStartIndex:i}=c;var j=a.map(a=>{if(aK(a,bp))return{sql:a.value.join(""),params:[]};if(aK(a,br))return{sql:e(a.value),params:[]};if(void 0===a)return{sql:"",params:[]};if(Array.isArray(a)){let b=[new bp("(")];for(let[c,d]of a.entries())b.push(d),c<a.length-1&&b.push(new bp(", "));return b.push(new bp(")")),this.buildQueryFromSourceParams(b,c)}if(aK(a,bq))return this.buildQueryFromSourceParams(a.queryChunks,{...c,inlineParams:h||a.shouldInlineParams});if(aK(a,bl)){let b=a[bl.Symbol.Schema],c=a[bl.Symbol.Name];return{sql:void 0===b||a[bi]?e(c):e(b)+"."+e(c),params:[]}}if(aK(a,aP)){let c=d.getColumnCasing(a);if("indexes"===b.invokeSource)return{sql:e(c),params:[]};let f=a.table[bl.Symbol.Schema];return{sql:a.table[bi]||void 0===f?e(a.table[bl.Symbol.Name])+"."+e(c):e(f)+"."+e(a.table[bl.Symbol.Name])+"."+e(c),params:[]}}if(aK(a,bB)){let b=a[bc].schema,c=a[bc].name;return{sql:void 0===b||a[bc].isAlias?e(c):e(b)+"."+e(c),params:[]}}if(aK(a,bu)){if(aK(a.value,by))return{sql:f(i.value++,a),params:[a],typings:["none"]};let b=null===a.value?null:a.encoder.mapToDriverValue(a.value);if(aK(b,bq))return this.buildQueryFromSourceParams([b],c);if(h)return{sql:this.mapInlineParam(b,c),params:[]};let d=["none"];return g&&(d=[g(a.encoder)]),{sql:f(i.value++,b),params:[b],typings:d}}return aK(a,by)?{sql:f(i.value++,a),params:[a],typings:["none"]}:aK(a,bq.Aliased)&&void 0!==a.fieldAlias?{sql:e(a.fieldAlias),params:[]}:aK(a,a9)?a._.isWith?{sql:e(a._.alias),params:[]}:this.buildQueryFromSourceParams([new bp("("),a._.sql,new bp(") "),new br(a._.alias)],c):a&&"function"==typeof a&&a6 in a&&!0===a[a6]?a.schema?{sql:e(a.schema)+"."+e(a.enumName),params:[]}:{sql:e(a.enumName),params:[]}:bo(a)?a.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([a.getSQL()],c):this.buildQueryFromSourceParams([new bp("("),a.getSQL(),new bp(")")],c):h?{sql:this.mapInlineParam(a,c),params:[]}:{sql:f(i.value++,a),params:[a],typings:["none"]}});let k={sql:"",params:[]};for(let a of j)k.sql+=a.sql,k.params.push(...a.params),a.typings?.length&&(k.typings||(k.typings=[]),k.typings.push(...a.typings));return k}mapInlineParam(a,{escapeString:b}){if(null===a)return"null";if("number"==typeof a||"boolean"==typeof a)return a.toString();if("string"==typeof a)return b(a);if("object"==typeof a){let c=a.toString();return"[object Object]"===c?b(JSON.stringify(a)):b(c)}throw Error("Unexpected param value: "+a)}getSQL(){return this}as(a){return void 0===a?this:new bq.Aliased(this,a)}mapWith(a){return this.decoder="function"==typeof a?{mapFromDriverValue:a}:a,this}inlineParams(){return this.shouldInlineParams=!0,this}if(a){return a?this:void 0}}class br{constructor(a){this.value=a}static [aJ]="Name";brand;getSQL(){return new bq([this])}}let bs={mapFromDriverValue:a=>a},bt={mapToDriverValue:a=>a};({...bs,...bt});class bu{constructor(a,b=bt){this.value=a,this.encoder=b}static [aJ]="Param";brand;getSQL(){return new bq([this])}}function bv(a,...b){let c=[];for(let[d,e]of((b.length>0||a.length>0&&""!==a[0])&&c.push(new bp(a[0])),b.entries()))c.push(e,new bp(a[d+1]));return new bq(c)}(lJ=bv||(bv={})).empty=function(){return new bq([])},lJ.fromList=function(a){return new bq(a)},lJ.raw=function(a){return new bq([new bp(a)])},lJ.join=function(a,b){let c=[];for(let[d,e]of a.entries())d>0&&void 0!==b&&c.push(b),c.push(e);return new bq(c)},lJ.identifier=function(a){return new br(a)},lJ.placeholder=function(a){return new by(a)},lJ.param=function(a,b){return new bu(a,b)};var bw=bq||(bq={});class bx{constructor(a,b){this.sql=a,this.fieldAlias=b}static [aJ]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new bx(this.sql,this.fieldAlias)}}bw.Aliased=bx;class by{constructor(a){this.name=a}static [aJ]="Placeholder";getSQL(){return new bq([this])}}function bz(a,b){return a.map(a=>{if(aK(a,by)){if(!(a.name in b))throw Error(`No value for placeholder "${a.name}" was provided`);return b[a.name]}if(aK(a,bu)&&aK(a.value,by)){if(!(a.value.name in b))throw Error(`No value for placeholder "${a.value.name}" was provided`);return a.encoder.mapToDriverValue(b[a.value.name])}return a})}let bA=Symbol.for("drizzle:IsDrizzleView");class bB{static [aJ]="View";[bc];[bA]=!0;constructor({name:a,schema:b,selectedFields:c,query:d}){this[bc]={name:a,originalName:a,schema:b,selectedFields:c,query:d,isExisting:!d,isAlias:!1}}getSQL(){return new bq([this])}}aP.prototype.getSQL=function(){return new bq([this])},bl.prototype.getSQL=function(){return new bq([this])},a9.prototype.getSQL=function(){return new bq([this])};class bC{constructor(a){this.table=a}static [aJ]="ColumnAliasProxyHandler";get(a,b){return"table"===b?this.table:a[b]}}class bD{constructor(a,b){this.alias=a,this.replaceOriginalName=b}static [aJ]="TableAliasProxyHandler";get(a,b){if(b===bl.Symbol.IsAlias)return!0;if(b===bl.Symbol.Name||this.replaceOriginalName&&b===bl.Symbol.OriginalName)return this.alias;if(b===bc)return{...a[bc],name:this.alias,isAlias:!0};if(b===bl.Symbol.Columns){let b=a[bl.Symbol.Columns];if(!b)return b;let c={};return Object.keys(b).map(d=>{c[d]=new Proxy(b[d],new bC(new Proxy(a,this)))}),c}let c=a[b];return aK(c,aP)?new Proxy(c,new bC(new Proxy(a,this))):c}}class bE{constructor(a){this.alias=a}static [aJ]="RelationTableAliasProxyHandler";get(a,b){return"sourceTable"===b?bF(a.sourceTable,this.alias):a[b]}}function bF(a,b){return new Proxy(a,new bD(b,!1))}function bG(a,b){return new Proxy(a,new bC(new Proxy(a.table,new bD(b,!1))))}function bH(a,b){return new bq.Aliased(bI(a.sql,b),a.fieldAlias)}function bI(a,b){return bv.join(a.queryChunks.map(a=>aK(a,aP)?bG(a,b):aK(a,bq)?bI(a,b):aK(a,bq.Aliased)?bH(a,b):a))}class bJ{static [aJ]="SelectionProxyHandler";config;constructor(a){this.config={...a}}get(a,b){if("_"===b)return{...a._,selectedFields:new Proxy(a._.selectedFields,this)};if(b===bc)return{...a[bc],selectedFields:new Proxy(a[bc].selectedFields,this)};if("symbol"==typeof b)return a[b];let c=(aK(a,a9)?a._.selectedFields:aK(a,bB)?a[bc].selectedFields:a)[b];if(aK(c,bq.Aliased)){if("sql"===this.config.sqlAliasedBehavior&&!c.isSelectionField)return c.sql;let a=c.clone();return a.isSelectionField=!0,a}if(aK(c,bq)){if("sql"===this.config.sqlBehavior)return c;throw Error(`You tried to reference "${b}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return aK(c,aP)?this.config.alias?new Proxy(c,new bC(new Proxy(c.table,new bD(this.config.alias,this.config.replaceOriginalName??!1)))):c:"object"!=typeof c||null===c?c:new Proxy(c,new bJ(this.config))}}function bK(a,b){return Object.entries(a).reduce((a,[c,d])=>{if("string"!=typeof c)return a;let e=b?[...b,c]:[c];return aK(d,aP)||aK(d,bq)||aK(d,bq.Aliased)||aK(d,a9)?a.push({path:e,field:d}):aK(d,bl)?a.push(...bK(d[bl.Symbol.Columns],e)):a.push(...bK(d,e)),a},[])}function bL(a,b){let c=Object.keys(a),d=Object.keys(b);if(c.length!==d.length)return!1;for(let[a,b]of c.entries())if(b!==d[a])return!1;return!0}function bM(a,b){let c=Object.entries(b).filter(([,a])=>void 0!==a).map(([b,c])=>aK(c,bq)||aK(c,aP)?[b,c]:[b,new bu(c,a[bl.Symbol.Columns][b])]);if(0===c.length)throw Error("No values to set");return Object.fromEntries(c)}function bN(a,b){for(let c of b)for(let b of Object.getOwnPropertyNames(c.prototype))"constructor"!==b&&Object.defineProperty(a.prototype,b,Object.getOwnPropertyDescriptor(c.prototype,b)||Object.create(null))}function bO(a){return a[bl.Symbol.Columns]}function bP(a){return aK(a,a9)?a._.alias:aK(a,bB)?a[bc].name:aK(a,bq)?void 0:a[bl.Symbol.IsAlias]?a[bl.Symbol.Name]:a[bl.Symbol.BaseName]}function bQ(a,b){return{name:"string"==typeof a&&a.length>0?a:"",config:"object"==typeof a?a:b}}let bR="u"<typeof TextDecoder?null:new TextDecoder;class bS extends a${static [aJ]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"always",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(a){if(a){let{name:b,...c}=a;this.config.generatedIdentity={type:"byDefault",sequenceName:b,sequenceOptions:c}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class bT extends bS{static [aJ]="PgBigInt53Builder";constructor(a){super(a,"number","PgBigInt53")}build(a){return new bU(a,this.config)}}class bU extends a_{static [aJ]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class bV extends bS{static [aJ]="PgBigInt64Builder";constructor(a){super(a,"bigint","PgBigInt64")}build(a){return new bW(a,this.config)}}class bW extends a_{static [aJ]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(a){return BigInt(a)}}function bX(a,b){let{name:c,config:d}=bQ(a,b);return"number"===d.mode?new bT(c):new bV(c)}class bY extends a${static [aJ]="PgBigSerial53Builder";constructor(a){super(a,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new bZ(a,this.config)}}class bZ extends a_{static [aJ]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class b$ extends a${static [aJ]="PgBigSerial64Builder";constructor(a){super(a,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(a){return new b_(a,this.config)}}class b_ extends a_{static [aJ]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(a){return BigInt(a)}}function b0(a,b){let{name:c,config:d}=bQ(a,b);return"number"===d.mode?new bY(c):new b$(c)}class b1 extends a${static [aJ]="PgBooleanBuilder";constructor(a){super(a,"boolean","PgBoolean")}build(a){return new b2(a,this.config)}}class b2 extends a_{static [aJ]="PgBoolean";getSQLType(){return"boolean"}}function b3(a){return new b1(a??"")}class b4 extends a${static [aJ]="PgCharBuilder";constructor(a,b){super(a,"string","PgChar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new b5(a,this.config)}}class b5 extends a_{static [aJ]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function b6(a,b={}){let{name:c,config:d}=bQ(a,b);return new b4(c,d)}class b7 extends a${static [aJ]="PgCidrBuilder";constructor(a){super(a,"string","PgCidr")}build(a){return new b8(a,this.config)}}class b8 extends a_{static [aJ]="PgCidr";getSQLType(){return"cidr"}}function b9(a){return new b7(a??"")}class ca extends a${static [aJ]="PgCustomColumnBuilder";constructor(a,b,c){super(a,"custom","PgCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new cb(a,this.config)}}class cb extends a_{static [aJ]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function cc(a){return(b,c)=>{let{name:d,config:e}=bQ(b,c);return new ca(d,e,a)}}class cd extends a${static [aJ]="PgDateColumnBaseBuilder";defaultNow(){return this.default(bv`now()`)}}class ce extends cd{static [aJ]="PgDateBuilder";constructor(a){super(a,"date","PgDate")}build(a){return new cf(a,this.config)}}class cf extends a_{static [aJ]="PgDate";getSQLType(){return"date"}mapFromDriverValue(a){return"string"==typeof a?new Date(a):a}mapToDriverValue(a){return a.toISOString()}}class cg extends cd{static [aJ]="PgDateStringBuilder";constructor(a){super(a,"string","PgDateString")}build(a){return new ch(a,this.config)}}class ch extends a_{static [aJ]="PgDateString";getSQLType(){return"date"}mapFromDriverValue(a){return"string"==typeof a?a:a.toISOString().slice(0,-14)}}function ci(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode==="date"?new ce(c):new cg(c)}class cj extends a${static [aJ]="PgDoublePrecisionBuilder";constructor(a){super(a,"number","PgDoublePrecision")}build(a){return new ck(a,this.config)}}class ck extends a_{static [aJ]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(a){return"string"==typeof a?Number.parseFloat(a):a}}function cl(a){return new cj(a??"")}class cm extends a${static [aJ]="PgInetBuilder";constructor(a){super(a,"string","PgInet")}build(a){return new cn(a,this.config)}}class cn extends a_{static [aJ]="PgInet";getSQLType(){return"inet"}}function co(a){return new cm(a??"")}class cp extends bS{static [aJ]="PgIntegerBuilder";constructor(a){super(a,"number","PgInteger")}build(a){return new cq(a,this.config)}}class cq extends a_{static [aJ]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(a){return"string"==typeof a?Number.parseInt(a):a}}function cr(a){return new cp(a??"")}class cs extends a${static [aJ]="PgIntervalBuilder";constructor(a,b){super(a,"string","PgInterval"),this.config.intervalConfig=b}build(a){return new ct(a,this.config)}}class ct extends a_{static [aJ]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let a=this.fields?` ${this.fields}`:"",b=this.precision?`(${this.precision})`:"";return`interval${a}${b}`}}function cu(a,b={}){let{name:c,config:d}=bQ(a,b);return new cs(c,d)}class cv extends a${static [aJ]="PgJsonBuilder";constructor(a){super(a,"json","PgJson")}build(a){return new cw(a,this.config)}}class cw extends a_{static [aJ]="PgJson";constructor(a,b){super(a,b)}getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function cx(a){return new cv(a??"")}class cy extends a${static [aJ]="PgJsonbBuilder";constructor(a){super(a,"json","PgJsonb")}build(a){return new cz(a,this.config)}}class cz extends a_{static [aJ]="PgJsonb";constructor(a,b){super(a,b)}getSQLType(){return"jsonb"}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){if("string"==typeof a)try{return JSON.parse(a)}catch{}return a}}function cA(a){return new cy(a??"")}class cB extends a${static [aJ]="PgLineBuilder";constructor(a){super(a,"array","PgLine")}build(a){return new cC(a,this.config)}}class cC extends a_{static [aJ]="PgLine";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c),Number.parseFloat(d)]}mapToDriverValue(a){return`{${a[0]},${a[1]},${a[2]}}`}}class cD extends a${static [aJ]="PgLineABCBuilder";constructor(a){super(a,"json","PgLineABC")}build(a){return new cE(a,this.config)}}class cE extends a_{static [aJ]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(a){let[b,c,d]=a.slice(1,-1).split(",");return{a:Number.parseFloat(b),b:Number.parseFloat(c),c:Number.parseFloat(d)}}mapToDriverValue(a){return`{${a.a},${a.b},${a.c}}`}}function cF(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode&&"tuple"!==d.mode?new cD(c):new cB(c)}class cG extends a${static [aJ]="PgMacaddrBuilder";constructor(a){super(a,"string","PgMacaddr")}build(a){return new cH(a,this.config)}}class cH extends a_{static [aJ]="PgMacaddr";getSQLType(){return"macaddr"}}function cI(a){return new cG(a??"")}class cJ extends a${static [aJ]="PgMacaddr8Builder";constructor(a){super(a,"string","PgMacaddr8")}build(a){return new cK(a,this.config)}}class cK extends a_{static [aJ]="PgMacaddr8";getSQLType(){return"macaddr8"}}function cL(a){return new cJ(a??"")}class cM extends a${static [aJ]="PgNumericBuilder";constructor(a,b,c){super(a,"string","PgNumeric"),this.config.precision=b,this.config.scale=c}build(a){return new cN(a,this.config)}}class cN extends a_{static [aJ]="PgNumeric";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class cO extends a${static [aJ]="PgNumericNumberBuilder";constructor(a,b,c){super(a,"number","PgNumericNumber"),this.config.precision=b,this.config.scale=c}build(a){return new cP(a,this.config)}}class cP extends a_{static [aJ]="PgNumericNumber";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}class cQ extends a${static [aJ]="PgNumericBigIntBuilder";constructor(a,b,c){super(a,"bigint","PgNumericBigInt"),this.config.precision=b,this.config.scale=c}build(a){return new cR(a,this.config)}}class cR extends a_{static [aJ]="PgNumericBigInt";precision;scale;constructor(a,b){super(a,b),this.precision=b.precision,this.scale=b.scale}mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`numeric(${this.precision}, ${this.scale})`:void 0===this.precision?"numeric":`numeric(${this.precision})`}}function cS(a,b){let{name:c,config:d}=bQ(a,b),e=d?.mode;return"number"===e?new cO(c,d?.precision,d?.scale):"bigint"===e?new cQ(c,d?.precision,d?.scale):new cM(c,d?.precision,d?.scale)}class cT extends a${static [aJ]="PgPointTupleBuilder";constructor(a){super(a,"array","PgPointTuple")}build(a){return new cU(a,this.config)}}class cU extends a_{static [aJ]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return[Number.parseFloat(b),Number.parseFloat(c)]}return[a.x,a.y]}mapToDriverValue(a){return`(${a[0]},${a[1]})`}}class cV extends a${static [aJ]="PgPointObjectBuilder";constructor(a){super(a,"json","PgPointObject")}build(a){return new cW(a,this.config)}}class cW extends a_{static [aJ]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(a){if("string"==typeof a){let[b,c]=a.slice(1,-1).split(",");return{x:Number.parseFloat(b),y:Number.parseFloat(c)}}return a}mapToDriverValue(a){return`(${a.x},${a.y})`}}function cX(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode&&"tuple"!==d.mode?new cV(c):new cT(c)}function cY(a,b){let c=new DataView(new ArrayBuffer(8));for(let d=0;d<8;d++)c.setUint8(d,a[b+d]);return c.getFloat64(0,!0)}function cZ(a){let b=function(a){let b=[];for(let c=0;c<a.length;c+=2)b.push(Number.parseInt(a.slice(c,c+2),16));return new Uint8Array(b)}(a),c=0,d=b[0];c+=1;let e=new DataView(b.buffer),f=e.getUint32(c,1===d);if(c+=4,0x20000000&f&&(e.getUint32(c,1===d),c+=4),(65535&f)==1){let a=cY(b,c),d=cY(b,c+=8);return c+=8,[a,d]}throw Error("Unsupported geometry type")}class c$ extends a${static [aJ]="PgGeometryBuilder";constructor(a){super(a,"array","PgGeometry")}build(a){return new c_(a,this.config)}}class c_ extends a_{static [aJ]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){return cZ(a)}mapToDriverValue(a){return`point(${a[0]} ${a[1]})`}}class c0 extends a${static [aJ]="PgGeometryObjectBuilder";constructor(a){super(a,"json","PgGeometryObject")}build(a){return new c1(a,this.config)}}class c1 extends a_{static [aJ]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(a){let b=cZ(a);return{x:b[0],y:b[1]}}mapToDriverValue(a){return`point(${a.x} ${a.y})`}}function c2(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode&&"tuple"!==d.mode?new c0(c):new c$(c)}class c3 extends a${static [aJ]="PgRealBuilder";constructor(a,b){super(a,"number","PgReal"),this.config.length=b}build(a){return new c4(a,this.config)}}class c4 extends a_{static [aJ]="PgReal";constructor(a,b){super(a,b)}getSQLType(){return"real"}mapFromDriverValue=a=>"string"==typeof a?Number.parseFloat(a):a}function c5(a){return new c3(a??"")}class c6 extends a${static [aJ]="PgSerialBuilder";constructor(a){super(a,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new c7(a,this.config)}}class c7 extends a_{static [aJ]="PgSerial";getSQLType(){return"serial"}}function c8(a){return new c6(a??"")}class c9 extends bS{static [aJ]="PgSmallIntBuilder";constructor(a){super(a,"number","PgSmallInt")}build(a){return new da(a,this.config)}}class da extends a_{static [aJ]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=a=>"string"==typeof a?Number(a):a}function db(a){return new c9(a??"")}class dc extends a${static [aJ]="PgSmallSerialBuilder";constructor(a){super(a,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(a){return new dd(a,this.config)}}class dd extends a_{static [aJ]="PgSmallSerial";getSQLType(){return"smallserial"}}function de(a){return new dc(a??"")}class df extends a${static [aJ]="PgTextBuilder";constructor(a,b){super(a,"string","PgText"),this.config.enumValues=b.enum}build(a){return new dg(a,this.config)}}class dg extends a_{static [aJ]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function dh(a,b={}){let{name:c,config:d}=bQ(a,b);return new df(c,d)}class di extends cd{constructor(a,b,c){super(a,"string","PgTime"),this.withTimezone=b,this.precision=c,this.config.withTimezone=b,this.config.precision=c}static [aJ]="PgTimeBuilder";build(a){return new dj(a,this.config)}}class dj extends a_{static [aJ]="PgTime";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`time${a}${this.withTimezone?" with time zone":""}`}}function dk(a,b={}){let{name:c,config:d}=bQ(a,b);return new di(c,d.withTimezone??!1,d.precision)}class dl extends cd{static [aJ]="PgTimestampBuilder";constructor(a,b,c){super(a,"date","PgTimestamp"),this.config.withTimezone=b,this.config.precision=c}build(a){return new dm(a,this.config)}}class dm extends a_{static [aJ]="PgTimestamp";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":` (${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(a){return"string"==typeof a?new Date(this.withTimezone?a:a+"+0000"):a}mapToDriverValue=a=>a.toISOString()}class dn extends cd{static [aJ]="PgTimestampStringBuilder";constructor(a,b,c){super(a,"string","PgTimestampString"),this.config.withTimezone=b,this.config.precision=c}build(a){return new dp(a,this.config)}}class dp extends a_{static [aJ]="PgTimestampString";withTimezone;precision;constructor(a,b){super(a,b),this.withTimezone=b.withTimezone,this.precision=b.precision}getSQLType(){let a=void 0===this.precision?"":`(${this.precision})`;return`timestamp${a}${this.withTimezone?" with time zone":""}`}mapFromDriverValue(a){if("string"==typeof a)return a;let b=a.toISOString().slice(0,-1).replace("T"," ");if(this.withTimezone){let c=a.getTimezoneOffset();return`${b}${c<=0?"+":"-"}${Math.floor(Math.abs(c)/60).toString().padStart(2,"0")}`}return b}}function dq(a,b={}){let{name:c,config:d}=bQ(a,b);return d?.mode==="string"?new dn(c,d.withTimezone??!1,d.precision):new dl(c,d?.withTimezone??!1,d?.precision)}class dr extends a${static [aJ]="PgUUIDBuilder";constructor(a){super(a,"string","PgUUID")}defaultRandom(){return this.default(bv`gen_random_uuid()`)}build(a){return new ds(a,this.config)}}class ds extends a_{static [aJ]="PgUUID";getSQLType(){return"uuid"}}function dt(a){return new dr(a??"")}class du extends a${static [aJ]="PgVarcharBuilder";constructor(a,b){super(a,"string","PgVarchar"),this.config.length=b.length,this.config.enumValues=b.enum}build(a){return new dv(a,this.config)}}class dv extends a_{static [aJ]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function dw(a,b={}){let{name:c,config:d}=bQ(a,b);return new du(c,d)}class dx extends a${static [aJ]="PgBinaryVectorBuilder";constructor(a,b){super(a,"string","PgBinaryVector"),this.config.dimensions=b.dimensions}build(a){return new dy(a,this.config)}}class dy extends a_{static [aJ]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function dz(a,b){let{name:c,config:d}=bQ(a,b);return new dx(c,d)}class dA extends a${static [aJ]="PgHalfVectorBuilder";constructor(a,b){super(a,"array","PgHalfVector"),this.config.dimensions=b.dimensions}build(a){return new dB(a,this.config)}}class dB extends a_{static [aJ]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function dC(a,b){let{name:c,config:d}=bQ(a,b);return new dA(c,d)}class dD extends a${static [aJ]="PgSparseVectorBuilder";constructor(a,b){super(a,"string","PgSparseVector"),this.config.dimensions=b.dimensions}build(a){return new dE(a,this.config)}}class dE extends a_{static [aJ]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function dF(a,b){let{name:c,config:d}=bQ(a,b);return new dD(c,d)}class dG extends a${static [aJ]="PgVectorBuilder";constructor(a,b){super(a,"array","PgVector"),this.config.dimensions=b.dimensions}build(a){return new dH(a,this.config)}}class dH extends a_{static [aJ]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(a){return JSON.stringify(a)}mapFromDriverValue(a){return a.slice(1,-1).split(",").map(a=>Number.parseFloat(a))}}function dI(a,b){let{name:c,config:d}=bQ(a,b);return new dG(c,d)}let dJ=Symbol.for("drizzle:PgInlineForeignKeys"),dK=Symbol.for("drizzle:EnableRLS");class dL extends bl{static [aJ]="PgTable";static Symbol=Object.assign({},bl.Symbol,{InlineForeignKeys:dJ,EnableRLS:dK});[dJ]=[];[dK]=!1;[bl.Symbol.ExtraConfigBuilder]=void 0;[bl.Symbol.ExtraConfigColumns]={}}let dM=(a,b,c)=>(function(a,b,c,d,e=a){let f=new dL(a,d,e),g="function"==typeof b?b({bigint:bX,bigserial:b0,boolean:b3,char:b6,cidr:b9,customType:cc,date:ci,doublePrecision:cl,inet:co,integer:cr,interval:cu,json:cx,jsonb:cA,line:cF,macaddr:cI,macaddr8:cL,numeric:cS,point:cX,geometry:c2,real:c5,serial:c8,smallint:db,smallserial:de,text:dh,time:dk,timestamp:dq,uuid:dt,varchar:dw,bit:dz,halfvec:dC,sparsevec:dF,vector:dI}):b,h=Object.fromEntries(Object.entries(g).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[dJ].push(...b.buildForeignKeys(c,f)),[a,c]})),i=Object.fromEntries(Object.entries(g).map(([a,b])=>(b.setName(a),[a,b.buildExtraConfigColumn(f)]))),j=Object.assign(f,h);return j[bl.Symbol.Columns]=h,j[bl.Symbol.ExtraConfigColumns]=i,c&&(j[dL.Symbol.ExtraConfigBuilder]=c),Object.assign(j,{enableRLS:()=>(j[dL.Symbol.EnableRLS]=!0,j)})})(a,b,c,void 0);class dN{constructor(a,b){this.name=a,this.value=b}static [aJ]="PgCheckBuilder";brand;build(a){return new dO(a,this)}}class dO{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [aJ]="PgCheck";name;value}class dP{constructor(a,b){this.unique=a,this.name=b}static [aJ]="PgIndexBuilderOn";on(...a){return new dQ(a.map(a=>{if(aK(a,bq))return a;let b=new a1(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!1,this.name)}onOnly(...a){return new dQ(a.map(a=>{if(aK(a,bq))return a;let b=new a1(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=a.defaultConfig,b}),this.unique,!0,this.name)}using(a,...b){return new dQ(b.map(a=>{if(aK(a,bq))return a;let b=new a1(a.name,!!a.keyAsName,a.columnType,a.indexConfig);return a.indexConfig=JSON.parse(JSON.stringify(a.defaultConfig)),b}),this.unique,!0,this.name,a)}}class dQ{static [aJ]="PgIndexBuilder";config;constructor(a,b,c,d,e="btree"){this.config={name:d,columns:a,unique:b,only:c,method:e}}concurrently(){return this.config.concurrently=!0,this}with(a){return this.config.with=a,this}where(a){return this.config.where=a,this}build(a){return new dR(this.config,a)}}class dR{static [aJ]="PgIndex";config;constructor(a,b){this.config={...a,table:b}}}class dS{constructor(a,b){this.name=a,b&&(this.as=b.as,this.for=b.for,this.to=b.to,this.using=b.using,this.withCheck=b.withCheck)}static [aJ]="PgPolicy";as;for;to;using;withCheck;_linkedTable;link(a){return this._linkedTable=a,this}}function dT(...a){return a[0].columns?new dU(a[0].columns,a[0].name):new dU(a)}class dU{static [aJ]="PgPrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new dV(a,this.columns,this.name)}}class dV{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [aJ]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[dL.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}let dW=Symbol.for("drizzle:PgViewConfig");function dX(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(a=>a.toLowerCase()).join("_")}function dY(a){return(a.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((a,b,c)=>a+(0===c?b.toLowerCase():`${b[0].toUpperCase()}${b.slice(1)}`),"")}function dZ(a){return a}class d${static [aJ]="CasingCache";cache={};cachedTables={};convert;constructor(a){this.convert="snake_case"===a?dX:"camelCase"===a?dY:dZ}getColumnCasing(a){if(!a.keyAsName)return a.name;let b=a.table[bl.Symbol.Schema]??"public",c=a.table[bl.Symbol.OriginalName],d=`${b}.${c}.${a.name}`;return this.cache[d]||this.cacheTable(a.table),this.cache[d]}cacheTable(a){let b=a[bl.Symbol.Schema]??"public",c=a[bl.Symbol.OriginalName],d=`${b}.${c}`;if(!this.cachedTables[d]){for(let b of Object.values(a[bl.Symbol.Columns])){let a=`${d}.${b.name}`;this.cache[a]=this.convert(b.name)}this.cachedTables[d]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class d_ extends Error{static [aJ]="DrizzleError";constructor({message:a,cause:b}){super(a),this.name="DrizzleError",this.cause=b}}class d0 extends Error{constructor(a,b,c){super(`Failed query: ${a}
params: ${b}`),this.query=a,this.params=b,this.cause=c,Error.captureStackTrace(this,d0),c&&(this.cause=c)}}class d1 extends d_{static [aJ]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}function d2(a,b){return"object"!=typeof b||null===b||!("mapToDriverValue"in b)||"function"!=typeof b.mapToDriverValue||bo(a)||aK(a,bu)||aK(a,by)||aK(a,aP)||aK(a,bl)||aK(a,bB)?a:new bu(a,b)}let d3=(a,b)=>bv`${a} = ${d2(b,a)}`,d4=(a,b)=>bv`${a} <> ${d2(b,a)}`;function d5(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new bq(1===b.length?b:[new bp("("),bv.join(b,new bp(" and ")),new bp(")")])}function d6(...a){let b=a.filter(a=>void 0!==a);if(0!==b.length)return new bq(1===b.length?b:[new bp("("),bv.join(b,new bp(" or ")),new bp(")")])}function d7(a){return bv`not ${a}`}let d8=(a,b)=>bv`${a} > ${d2(b,a)}`,d9=(a,b)=>bv`${a} >= ${d2(b,a)}`,ea=(a,b)=>bv`${a} < ${d2(b,a)}`,eb=(a,b)=>bv`${a} <= ${d2(b,a)}`;function ec(a,b){return Array.isArray(b)?0===b.length?bv`false`:bv`${a} in ${b.map(b=>d2(b,a))}`:bv`${a} in ${d2(b,a)}`}function ed(a,b){return Array.isArray(b)?0===b.length?bv`true`:bv`${a} not in ${b.map(b=>d2(b,a))}`:bv`${a} not in ${d2(b,a)}`}function ee(a){return bv`${a} is null`}function ef(a){return bv`${a} is not null`}function eg(a){return bv`exists ${a}`}function eh(a){return bv`not exists ${a}`}function ei(a,b,c){return bv`${a} between ${d2(b,a)} and ${d2(c,a)}`}function ej(a,b,c){return bv`${a} not between ${d2(b,a)} and ${d2(c,a)}`}function ek(a,b){return bv`${a} like ${b}`}function el(a,b){return bv`${a} not like ${b}`}function em(a,b){return bv`${a} ilike ${b}`}function en(a,b){return bv`${a} not ilike ${b}`}function eo(a){return bv`${a} asc`}function ep(a){return bv`${a} desc`}class eq{constructor(a,b,c){this.sourceTable=a,this.referencedTable=b,this.relationName=c,this.referencedTableName=b[bl.Symbol.Name]}static [aJ]="Relation";referencedTableName;fieldName}class er{constructor(a,b){this.table=a,this.config=b}static [aJ]="Relations"}class es extends eq{constructor(a,b,c,d){super(a,b,c?.relationName),this.config=c,this.isNullable=d}static [aJ]="One";withFieldName(a){let b=new es(this.sourceTable,this.referencedTable,this.config,this.isNullable);return b.fieldName=a,b}}class et extends eq{constructor(a,b,c){super(a,b,c?.relationName),this.config=c}static [aJ]="Many";withFieldName(a){let b=new et(this.sourceTable,this.referencedTable,this.config);return b.fieldName=a,b}}function eu(){return{and:d5,between:ei,eq:d3,exists:eg,gt:d8,gte:d9,ilike:em,inArray:ec,isNull:ee,isNotNull:ef,like:ek,lt:ea,lte:eb,ne:d4,not:d7,notBetween:ej,notExists:eh,notLike:el,notIlike:en,notInArray:ed,or:d6,sql:bv}}function ev(){return{sql:bv,asc:eo,desc:ep}}function ew(a,b,c){if(aK(c,es)&&c.config)return{fields:c.config.fields,references:c.config.references};let d=b[bm(c.referencedTable)];if(!d)throw Error(`Table "${c.referencedTable[bl.Symbol.Name]}" not found in schema`);let e=a[d];if(!e)throw Error(`Table "${d}" not found in schema`);let f=c.sourceTable,g=b[bm(f)];if(!g)throw Error(`Table "${f[bl.Symbol.Name]}" not found in schema`);let h=[];for(let a of Object.values(e.relations))(c.relationName&&c!==a&&a.relationName===c.relationName||!c.relationName&&a.referencedTable===c.sourceTable)&&h.push(a);if(h.length>1)throw c.relationName?Error(`There are multiple relations with name "${c.relationName}" in table "${d}"`):Error(`There are multiple relations between "${d}" and "${c.sourceTable[bl.Symbol.Name]}". Please specify relation name`);if(h[0]&&aK(h[0],es)&&h[0].config)return{fields:h[0].config.references,references:h[0].config.fields};throw Error(`There is not enough information to infer relation "${g}.${c.fieldName}"`)}function ex(a){return{one:function(b,c){return new es(a,b,c,c?.fields.reduce((a,b)=>a&&b.notNull,!0)??!1)},many:function(b,c){return new et(a,b,c)}}}function ey(a,b,c,d,e=a=>a){let f={};for(let[g,h]of d.entries())if(h.isJson){let d=b.relations[h.tsKey],i=c[g],j="string"==typeof i?JSON.parse(i):i;f[h.tsKey]=aK(d,es)?j&&ey(a,a[h.relationTableTsKey],j,h.selection,e):j.map(b=>ey(a,a[h.relationTableTsKey],b,h.selection,e))}else{let a,b=e(c[g]),d=h.field;a=aK(d,aP)?d:aK(d,bq)?d.decoder:d.sql.decoder,f[h.tsKey]=null===b?null:a.mapFromDriverValue(b)}return f}class ez extends bB{static [aJ]="PgViewBase"}class eA{static [aJ]="PgDialect";casing;constructor(a){this.casing=new d$(a?.casing)}async migrate(a,b,c){let d="string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e="string"==typeof c?"drizzle":c.migrationsSchema??"drizzle",f=bv`
			CREATE TABLE IF NOT EXISTS ${bv.identifier(e)}.${bv.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await b.execute(bv`CREATE SCHEMA IF NOT EXISTS ${bv.identifier(e)}`),await b.execute(f);let g=(await b.all(bv`select id, hash, created_at from ${bv.identifier(e)}.${bv.identifier(d)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for await(let c of a)if(!g||Number(g.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(bv.raw(a));await b.execute(bv`insert into ${bv.identifier(e)}.${bv.identifier(d)} ("hash", "created_at") values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`"${a}"`}escapeParam(a){return`$${a+1}`}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[bv`with `];for(let[c,d]of a.entries())b.push(bv`${bv.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(bv`, `);return b.push(bv` `),bv.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d}){let e=this.buildWithCTE(d),f=c?bv` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,g=b?bv` where ${b}`:void 0;return bv`${e}delete from ${a}${g}${f}`}buildUpdateSet(a,b){let c=a[bl.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return bv.join(d.flatMap((a,d)=>{let f=c[a],g=f.onUpdateFn?.(),h=b[a]??(aK(g,bq)?g:bv.param(g,f)),i=bv`${bv.identifier(this.casing.getColumnCasing(f))} = ${h}`;return d<e-1?[i,bv.raw(", ")]:[i]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,from:f,joins:g}){let h=this.buildWithCTE(e),i=a[dL.Symbol.Name],j=a[dL.Symbol.Schema],k=a[dL.Symbol.OriginalName],l=i===k?void 0:i,m=bv`${j?bv`${bv.identifier(j)}.`:void 0}${bv.identifier(k)}${l&&bv` ${bv.identifier(l)}`}`,n=this.buildUpdateSet(a,b),o=f&&bv.join([bv.raw(" from "),this.buildFromTable(f)]),p=this.buildJoins(g),q=d?bv` returning ${this.buildSelection(d,{isSingleTable:!f})}`:void 0,r=c?bv` where ${c}`:void 0;return bv`${h}update ${m} set ${n}${o}${p}${r}${q}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,d=a.flatMap(({field:a},d)=>{let e=[];if(aK(a,bq.Aliased)&&a.isSelectionField)e.push(bv.identifier(a.fieldAlias));else if(aK(a,bq.Aliased)||aK(a,bq)){let c=aK(a,bq.Aliased)?a.sql:a;b?e.push(new bq(c.queryChunks.map(a=>aK(a,a_)?bv.identifier(this.casing.getColumnCasing(a)):a))):e.push(c),aK(a,bq.Aliased)&&e.push(bv` as ${bv.identifier(a.fieldAlias)}`)}else if(aK(a,aP))b?e.push(bv.identifier(this.casing.getColumnCasing(a))):e.push(a);else if(aK(a,a9)){let b=Object.entries(a._.selectedFields);if(1===b.length){let c=b[0][1],d=aK(c,bq)?c.decoder:aK(c,aP)?{mapFromDriverValue:a=>c.mapFromDriverValue(a)}:c.sql.decoder;d&&(a._.sql.decoder=d)}e.push(a)}return d<c-1&&e.push(bv`, `),e});return bv.join(d)}buildJoins(a){if(!a||0===a.length)return;let b=[];for(let[c,d]of a.entries()){0===c&&b.push(bv` `);let e=d.table,f=d.lateral?bv` lateral`:void 0,g=d.on?bv` on ${d.on}`:void 0;if(aK(e,dL)){let a=e[dL.Symbol.Name],c=e[dL.Symbol.Schema],h=e[dL.Symbol.OriginalName],i=a===h?void 0:d.alias;b.push(bv`${bv.raw(d.joinType)} join${f} ${c?bv`${bv.identifier(c)}.`:void 0}${bv.identifier(h)}${i&&bv` ${bv.identifier(i)}`}${g}`)}else if(aK(e,bB)){let a=e[bc].name,c=e[bc].schema,h=e[bc].originalName,i=a===h?void 0:d.alias;b.push(bv`${bv.raw(d.joinType)} join${f} ${c?bv`${bv.identifier(c)}.`:void 0}${bv.identifier(h)}${i&&bv` ${bv.identifier(i)}`}${g}`)}else b.push(bv`${bv.raw(d.joinType)} join${f} ${e}${g}`);c<a.length-1&&b.push(bv` `)}return bv.join(b)}buildFromTable(a){if(aK(a,bl)&&a[bl.Symbol.IsAlias]){let b=bv`${bv.identifier(a[bl.Symbol.OriginalName])}`;return a[bl.Symbol.Schema]&&(b=bv`${bv.identifier(a[bl.Symbol.Schema])}.${b}`),bv`${b} ${bv.identifier(a[bl.Symbol.Name])}`}return a}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:d,having:e,table:f,joins:g,orderBy:h,groupBy:i,limit:j,offset:k,lockingClause:l,distinct:m,setOperators:n}){let o,p,q,r=c??bK(b);for(let a of r){let b;if(aK(a.field,aP)&&a.field.table[aR]!==(aK(f,a9)?f._.alias:aK(f,ez)?f[bc].name:aK(f,bq)?void 0:f[aR])&&(b=a.field.table,!g?.some(({alias:a})=>a===(b[bl.Symbol.IsAlias]?b[aR]:b[bl.Symbol.BaseName])))){let b=a.field.table[aR];throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let s=!g||0===g.length,t=this.buildWithCTE(a);m&&(o=!0===m?bv` distinct`:bv` distinct on (${bv.join(m.on,bv`, `)})`);let u=this.buildSelection(r,{isSingleTable:s}),v=this.buildFromTable(f),w=this.buildJoins(g),x=d?bv` where ${d}`:void 0,y=e?bv` having ${e}`:void 0;h&&h.length>0&&(p=bv` order by ${bv.join(h,bv`, `)}`),i&&i.length>0&&(q=bv` group by ${bv.join(i,bv`, `)}`);let z="object"==typeof j||"number"==typeof j&&j>=0?bv` limit ${j}`:void 0,A=k?bv` offset ${k}`:void 0,B=bv.empty();if(l){let a=bv` for ${bv.raw(l.strength)}`;l.config.of&&a.append(bv` of ${bv.join(Array.isArray(l.config.of)?l.config.of:[l.config.of],bv`, `)}`),l.config.noWait?a.append(bv` nowait`):l.config.skipLocked&&a.append(bv` skip locked`),B.append(a)}let C=bv`${t}select${o} ${u} from ${v}${w}${x}${q}${y}${p}${z}${A}${B}`;return n.length>0?this.buildSetOperations(C,n):C}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:e,orderBy:f,offset:g}}){let h,i=bv`(${a.getSQL()}) `,j=bv`(${d.getSQL()})`;if(f&&f.length>0){let a=[];for(let b of f)if(aK(b,a_))a.push(bv.identifier(b.name));else if(aK(b,bq)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];aK(c,a_)&&(b.queryChunks[a]=bv.identifier(c.name))}a.push(bv`${b}`)}else a.push(bv`${b}`);h=bv` order by ${bv.join(a,bv`, `)} `}let k="object"==typeof e||"number"==typeof e&&e>=0?bv` limit ${e}`:void 0,l=bv.raw(`${b} ${c?"all ":""}`),m=g?bv` offset ${g}`:void 0;return bv`${i}${l}${j}${h}${k}${m}`}buildInsertQuery({table:a,values:b,onConflict:c,returning:d,withList:e,select:f,overridingSystemValue_:g}){let h=[],i=Object.entries(a[bl.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),j=i.map(([,a])=>bv.identifier(this.casing.getColumnCasing(a)));if(f)aK(b,bq)?h.push(b):h.push(b.getSQL());else for(let[a,c]of(h.push(bv.raw("values ")),b.entries())){let d=[];for(let[a,b]of i){let e=c[a];if(void 0===e||aK(e,bu)&&void 0===e.value)if(void 0!==b.defaultFn){let a=b.defaultFn(),c=aK(a,bq)?a:bv.param(a,b);d.push(c)}else if(b.default||void 0===b.onUpdateFn)d.push(bv`default`);else{let a=b.onUpdateFn(),c=aK(a,bq)?a:bv.param(a,b);d.push(c)}else d.push(e)}h.push(d),a<b.length-1&&h.push(bv`, `)}let k=this.buildWithCTE(e),l=bv.join(h),m=d?bv` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,n=c?bv` on conflict ${c}`:void 0,o=!0===g?bv`overriding system value `:void 0;return bv`${k}insert into ${a} ${j} ${o}${l}${n}${m}`}buildRefreshMaterializedViewQuery({view:a,concurrently:b,withNoData:c}){let d=b?bv` concurrently`:void 0,e=c?bv` with no data`:void 0;return bv`refresh materialized view${d} ${a}${e}`}prepareTyping(a){if(aK(a,cz)||aK(a,cw))return"json";if(aK(a,cN))return"decimal";if(aK(a,dj))return"time";if(aK(a,dm)||aK(a,dp))return"timestamp";if(aK(a,cf)||aK(a,ch))return"date";else if(aK(a,ds))return"uuid";else return"none"}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:b})}buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k=[],l,m,n=[],o,p=[];if(!0===f)k=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:bG(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,bG(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,eu()):f.where;o=a&&bI(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let j=[];if(f.with&&(j=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:bv}):f.extras))h.push({tsKey:a,value:bH(b,g)});for(let{tsKey:a,value:b}of h)k.push({dbKey:aK(b,bq.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:aK(b,aP)?bG(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let q="function"==typeof f.orderBy?f.orderBy(d,ev()):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(q)||(q=[q]),n=q.map(a=>aK(a,aP)?bG(a,g):bI(a,g)),l=f.limit,m=f.offset,j)){let f=ew(b,c,h),i=c[bm(h.referencedTable)],j=`${g}_${d}`,l=d5(...f.fields.map((a,b)=>d3(bG(f.references[b],j),bG(a,g)))),m=this.buildRelationalQueryWithoutPK({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:aK(h,es)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:l,nestedQueryRelation:h}),n=bv`${bv.identifier(j)}.${bv.identifier("data")}`.as(d);p.push({on:bv`true`,table:new a9(m.sql,{},j),alias:j,joinType:"left",lateral:!0}),k.push({dbKey:d,tsKey:d,field:n,relationTableTsKey:i,isJson:!0,selection:m.selection})}}if(0===k.length)throw new d_({message:`No fields selected for table "${e.tsName}" ("${g}")`});if(o=d5(i,o),h){let a=bv`json_build_array(${bv.join(k.map(({field:a,tsKey:b,isJson:c})=>c?bv`${bv.identifier(`${g}_${b}`)}.${bv.identifier("data")}`:aK(a,bq.Aliased)?a.sql:a),bv`, `)})`;aK(h,et)&&(a=bv`coalesce(json_agg(${a}${n.length>0?bv` order by ${bv.join(n,bv`, `)}`:void 0}), '[]'::json)`);let b=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:e.tsName,selection:k}];void 0!==l||void 0!==m||n.length>0?(j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:[{path:[],field:bv.raw("*")}],where:o,limit:l,offset:m,orderBy:n,setOperators:[]}),o=void 0,l=void 0,m=void 0,n=[]):j=bF(d,g),j=this.buildSelectQuery({table:aK(j,dL)?j:new a9(j,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]})}else j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:k.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]});return{tableTsKey:e.tsName,sql:j,selection:k}}}class eB{static [aJ]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class eC{static [aJ]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}authToken;setToken(a){return this.authToken=a,this}from(a){let b,c=!!this.fields;return b=this.fields?this.fields:aK(a,a9)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):aK(a,ez)?a[bc].selectedFields:aK(a,bq)?{}:bO(a),new eE({table:a,fields:b,isPartialSelect:c,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct}).setToken(this.authToken)}}class eD extends eB{static [aJ]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g}){for(const h of(super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=bP(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},eX(a)))this.usedTables.add(h)}getUsedTables(){return[...this.usedTables]}createJoin(a,b){return(c,d)=>{let e=this.tableName,f=bP(c);for(let a of eX(c))this.usedTables.add(a);if("string"==typeof f&&this.config.joins?.some(a=>a.alias===f))throw Error(`Alias "${f}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof e&&(this.config.fields={[e]:this.config.fields}),"string"==typeof f&&!aK(c,bq))){let a=aK(c,a9)?c._.selectedFields:aK(c,bB)?c[bc].selectedFields:c[bl.Symbol.Columns];this.config.fields[f]=a}if("function"==typeof d&&(d=d(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:d,table:c,joinType:a,alias:f,lateral:b}),"string"==typeof f)switch(a){case"left":this.joinsNotNullableMap[f]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[f]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[f]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[f]=!1}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);fullJoin=this.createJoin("full",!1);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(a,b){return c=>{let d="function"==typeof c?c(eG()):c;if(!bL(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...eX(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...eX(a.table));return new Proxy(new a9(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new bJ({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}}class eE extends eD{static [aJ]="PgSelect";_prepare(a){let{session:b,config:c,dialect:d,joinsNotNullableMap:e,authToken:f,cacheConfig:g,usedTables:h}=this;if(!b)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let{fields:i}=c;return bb("drizzle.prepareQuery",()=>{let c=bK(i),j=b.prepareQuery(d.sqlToQuery(this.getSQL()),c,a,!0,void 0,{type:"select",tables:[...h]},g);return j.joinsNotNullableMap=e,j.setToken(f)})}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bb("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}function eF(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!bL(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}bN(eE,[aO]);let eG=()=>({union:eH,unionAll:eI,intersect:eJ,intersectAll:eK,except:eL,exceptAll:eM}),eH=eF("union",!1),eI=eF("union",!0),eJ=eF("intersect",!1),eK=eF("intersect",!0),eL=eF("except",!1),eM=eF("except",!0);class eN{static [aJ]="PgQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=aK(a,eA)?a:void 0,this.dialectConfig=aK(a,eA)?void 0:a}$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(c)),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new eC({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(a){return new eC({fields:a??void 0,session:void 0,dialect:b.getDialect(),distinct:!0})},selectDistinctOn:function(a,c){return new eC({fields:c??void 0,session:void 0,dialect:b.getDialect(),distinct:{on:a}})}}}select(a){return new eC({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new eC({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(a,b){return new eC({fields:b??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:a}})}getDialect(){return this.dialect||(this.dialect=new eA(this.dialectConfig)),this.dialect}}class eO{constructor(a,b){this.name=a,this.schema=b}static [aJ]="PgDefaultViewBuilderCore";config={};with(a){return this.config.with=a,this}}class eP extends eO{static [aJ]="PgViewBuilder";as(a){"function"==typeof a&&(a=a(new eN));let b=new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),c=new Proxy(a.getSelectedFields(),b);return new Proxy(new eU({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:c,query:a.getSQL().inlineParams()}}),b)}}class eQ extends eO{static [aJ]="PgManualViewBuilder";columns;constructor(a,b,c){super(a,c),this.columns=bO(dM(a,b))}existing(){return new Proxy(new eU({pgConfig:void 0,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(a){return new Proxy(new eU({pgConfig:this.config,config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:a.inlineParams()}}),new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class eR{constructor(a,b){this.name=a,this.schema=b}static [aJ]="PgMaterializedViewBuilderCore";config={};using(a){return this.config.using=a,this}with(a){return this.config.with=a,this}tablespace(a){return this.config.tablespace=a,this}withNoData(){return this.config.withNoData=!0,this}}class eS extends eR{static [aJ]="PgMaterializedViewBuilder";as(a){"function"==typeof a&&(a=a(new eN));let b=new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}),c=new Proxy(a.getSelectedFields(),b);return new Proxy(new eW({pgConfig:{with:this.config.with,using:this.config.using,tablespace:this.config.tablespace,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:c,query:a.getSQL().inlineParams()}}),b)}}class eT extends eR{static [aJ]="PgManualMaterializedViewBuilder";columns;constructor(a,b,c){super(a,c),this.columns=bO(dM(a,b))}existing(){return new Proxy(new eW({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:void 0}}),new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}as(a){return new Proxy(new eW({pgConfig:{tablespace:this.config.tablespace,using:this.config.using,with:this.config.with,withNoData:this.config.withNoData},config:{name:this.name,schema:this.schema,selectedFields:this.columns,query:a.inlineParams()}}),new bJ({alias:this.name,sqlBehavior:"error",sqlAliasedBehavior:"alias",replaceOriginalName:!0}))}}class eU extends ez{static [aJ]="PgView";[dW];constructor({pgConfig:a,config:b}){super(b),a&&(this[dW]={with:a.with})}}let eV=Symbol.for("drizzle:PgMaterializedViewConfig");class eW extends ez{static [aJ]="PgMaterializedView";[eV];constructor({pgConfig:a,config:b}){super(b),this[eV]={with:a?.with,using:a?.using,tablespace:a?.tablespace,withNoData:a?.withNoData}}}function eX(a){return aK(a,dL)?[a[bd]?`${a[bd]}.${a[bl.Symbol.BaseName]}`:a[bl.Symbol.BaseName]]:aK(a,a9)?a._.usedTables??[]:aK(a,bq)?a.usedTables??[]:[]}class eY extends aO{constructor(a,b,c,d){super(),this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [aJ]="PgDelete";config;cacheConfig;where(a){return this.config.where=a,this}returning(a=this.config.table[bl.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=bK(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bb("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"delete",tables:eX(this.config.table)},this.cacheConfig))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bb("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bJ({alias:this.config.table[aR],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class eZ{constructor(a,b,c,d,e){this.table=a,this.session=b,this.dialect=c,this.withList=d,this.overridingSystemValue_=e}static [aJ]="PgInsertBuilder";authToken;setToken(a){return this.authToken=a,this}overridingSystemValue(){return this.overridingSystemValue_=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let b=a.map(a=>{let b={},c=this.table[bl.Symbol.Columns];for(let d of Object.keys(a)){let e=a[d];b[d]=aK(e,bq)?e:new bu(e,c[d])}return b});return new e$(this.table,b,this.session,this.dialect,this.withList,!1,this.overridingSystemValue_).setToken(this.authToken)}select(a){let b="function"==typeof a?a(new eN):a;if(!aK(b,bq)&&!bL(this.table[be],b._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new e$(this.table,b,this.session,this.dialect,this.withList,!0)}}class e$ extends aO{constructor(a,b,c,d,e,f,g){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f,overridingSystemValue_:g}}static [aJ]="PgInsert";config;cacheConfig;returning(a=this.config.table[bl.Symbol.Columns]){return this.config.returningFields=a,this.config.returning=bK(a),this}onConflictDoNothing(a={}){if(void 0===a.target)this.config.onConflict=bv`do nothing`;else{let b="";b=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target));let c=a.where?bv` where ${a.where}`:void 0;this.config.onConflict=bv`(${bv.raw(b)})${c} do nothing`}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');let b=a.where?bv` where ${a.where}`:void 0,c=a.targetWhere?bv` where ${a.targetWhere}`:void 0,d=a.setWhere?bv` where ${a.setWhere}`:void 0,e=this.dialect.buildUpdateSet(this.config.table,bM(this.config.table,a.set)),f="";return f=Array.isArray(a.target)?a.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(a.target)),this.config.onConflict=bv`(${bv.raw(f)})${c} do update set ${e}${b}${d}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bb("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"insert",tables:eX(this.config.table)},this.cacheConfig))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bb("drizzle.operation",()=>this._prepare().execute(a,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bJ({alias:this.config.table[aR],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class e_{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [aJ]="PgUpdateBuilder";authToken;setToken(a){return this.authToken=a,this}set(a){return new e0(this.table,bM(this.table,a),this.session,this.dialect,this.withList).setToken(this.authToken)}}class e0 extends aO{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]},this.tableName=bP(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{}}static [aJ]="PgUpdate";config;tableName;joinsNotNullableMap;cacheConfig;from(a){let b=bP(a);return"string"==typeof b&&(this.joinsNotNullableMap[b]=!0),this.config.from=a,this}getTableLikeFields(a){return aK(a,dL)?a[bl.Symbol.Columns]:aK(a,a9)?a._.selectedFields:a[bc].selectedFields}createJoin(a){return(b,c)=>{let d=bP(b);if("string"==typeof d&&this.config.joins.some(a=>a.alias===d))throw Error(`Alias "${d}" is already used in this query`);if("function"==typeof c){let a=this.config.from&&!aK(this.config.from,bq)?this.getTableLikeFields(this.config.from):void 0;c=c(new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}if(this.config.joins.push({on:c,table:b,joinType:a,alias:d}),"string"==typeof d)switch(a){case"left":this.joinsNotNullableMap[d]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!0;break;case"inner":this.joinsNotNullableMap[d]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[d]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}returning(a){if(!a&&(a=Object.assign({},this.config.table[bl.Symbol.Columns]),this.config.from)){let b=bP(this.config.from);if("string"==typeof b&&this.config.from&&!aK(this.config.from,bq)){let c=this.getTableLikeFields(this.config.from);a[b]=c}for(let b of this.config.joins){let c=bP(b.table);if("string"==typeof c&&!aK(b.table,bq)){let d=this.getTableLikeFields(b.table);a[c]=d}}}return this.config.returningFields=a,this.config.returning=bK(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){let b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,a,!0,void 0,{type:"insert",tables:eX(this.config.table)},this.cacheConfig);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>this._prepare().execute(a,this.authToken);getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new bJ({alias:this.config.table[aR],sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}class e1 extends bq{constructor(a){super(e1.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=e1.buildCount(a.source,a.filters)}sql;token;static [aJ]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(a,b){return bv`(select count(*) from ${a}${bv.raw(" where ").if(b)}${b})`}static buildCount(a,b){return bv`select count(*) as count from ${a}${bv.raw(" where ").if(b)}${b};`}setToken(a){return this.token=a,this}then(a,b){return Promise.resolve(this.session.count(this.sql,this.token)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}class e2{constructor(a,b,c,d,e,f,g){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g}static [aJ]="PgRelationalQueryBuilder";findMany(a){return new e3(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return new e3(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class e3 extends aO{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [aJ]="PgRelationalQuery";_prepare(a){return bb("drizzle.prepareQuery",()=>{let{query:b,builtQuery:c}=this._toSQL();return this.session.prepareQuery(c,void 0,a,!0,(a,c)=>{let d=a.map(a=>ey(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})})}prepare(a){return this._prepare(a)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){let a=this._getQuery(),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}authToken;setToken(a){return this.authToken=a,this}execute(){return bb("drizzle.operation",()=>this._prepare().execute(void 0,this.authToken))}}class e4 extends aO{constructor(a,b,c,d){super(),this.execute=a,this.sql=b,this.query=c,this.mapBatchResult=d}static [aJ]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}class e5 extends aO{constructor(a,b,c){super(),this.session=b,this.dialect=c,this.config={view:a}}static [aJ]="PgRefreshMaterializedView";config;concurrently(){if(void 0!==this.config.withNoData)throw Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(void 0!==this.config.concurrently)throw Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a){return bb("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,a,!0))}prepare(a){return this._prepare(a)}authToken;setToken(a){return this.authToken=a,this}execute=a=>bb("drizzle.operation",()=>this._prepare().execute(a,this.authToken))}class e6{constructor(a,b,c){if(this.dialect=a,this.session=b,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap,session:b}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:b},this.query={},this._.schema)for(const[d,e]of Object.entries(this._.schema))this.query[d]=new e2(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b);this.$cache={invalidate:async a=>{}}}static [aJ]="PgDatabase";query;$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(new eN(c.dialect))),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new e1({source:a,filters:b,session:this.session})}$cache;with(...a){let b=this;return{select:function(c){return new eC({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new eC({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},selectDistinctOn:function(c,d){return new eC({fields:d??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:{on:c}})},update:function(c){return new e_(c,b.session,b.dialect,a)},insert:function(c){return new eZ(c,b.session,b.dialect,a)},delete:function(c){return new eY(c,b.session,b.dialect,a)}}}select(a){return new eC({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new eC({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(a,b){return new eC({fields:b??void 0,session:this.session,dialect:this.dialect,distinct:{on:a}})}update(a){return new e_(a,this.session,this.dialect)}insert(a){return new eZ(a,this.session,this.dialect)}delete(a){return new eY(a,this.session,this.dialect)}refreshMaterializedView(a){return new e5(a,this.session,this.dialect)}authToken;execute(a){let b="string"==typeof a?bv.raw(a):a.getSQL(),c=this.dialect.sqlToQuery(b),d=this.session.prepareQuery(c,void 0,void 0,!1);return new e4(()=>d.execute(void 0,this.authToken),b,c,a=>d.mapResult(a,!0))}transaction(a,b){return this.session.transaction(a,b)}}class e7{static [aJ]="Cache"}class e8 extends e7{strategy(){return"all"}static [aJ]="NoopCache";async get(a){}async put(a,b,c,d){}async onMutate(a){}}async function e9(a,b){let c=`${a}-${JSON.stringify(b)}`,d=new TextEncoder().encode(c);return[...new Uint8Array(await crypto.subtle.digest("SHA-256",d))].map(a=>a.toString(16).padStart(2,"0")).join("")}class fa{constructor(a,b,c,d){this.query=a,this.cache=b,this.queryMetadata=c,this.cacheConfig=d,b&&"all"===b.strategy()&&void 0===d&&(this.cacheConfig={enable:!0,autoInvalidate:!0}),this.cacheConfig?.enable||(this.cacheConfig=void 0)}authToken;getQuery(){return this.query}mapResult(a,b){return a}setToken(a){return this.authToken=a,this}static [aJ]="PgPreparedQuery";joinsNotNullableMap;async queryWithCache(a,b,c){if(void 0===this.cache||aK(this.cache,e8)||void 0===this.queryMetadata||this.cacheConfig&&!this.cacheConfig.enable)try{return await c()}catch(c){throw new d0(a,b,c)}if(("insert"===this.queryMetadata.type||"update"===this.queryMetadata.type||"delete"===this.queryMetadata.type)&&this.queryMetadata.tables.length>0)try{let[a]=await Promise.all([c(),this.cache.onMutate({tables:this.queryMetadata.tables})]);return a}catch(c){throw new d0(a,b,c)}if(!this.cacheConfig)try{return await c()}catch(c){throw new d0(a,b,c)}if("select"===this.queryMetadata.type){let d=await this.cache.get(this.cacheConfig.tag??await e9(a,b),this.queryMetadata.tables,void 0!==this.cacheConfig.tag,this.cacheConfig.autoInvalidate);if(void 0===d){let d;try{d=await c()}catch(c){throw new d0(a,b,c)}return await this.cache.put(this.cacheConfig.tag??await e9(a,b),d,this.cacheConfig.autoInvalidate?this.queryMetadata.tables:[],void 0!==this.cacheConfig.tag,this.cacheConfig.config),d}return d}try{return await c()}catch(c){throw new d0(a,b,c)}}}class fb{constructor(a){this.dialect=a}static [aJ]="PgSession";execute(a,b){return bb("drizzle.operation",()=>bb("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1)).setToken(b).execute(void 0,b))}all(a){return this.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,!1).all()}async count(a,b){return Number((await this.execute(a,b))[0].count)}}class fc extends e6{constructor(a,b,c,d=0){super(a,b,c),this.schema=c,this.nestedIndex=d}static [aJ]="PgTransaction";rollback(){throw new d1}getTransactionConfigSQL(a){let b=[];return a.isolationLevel&&b.push(`isolation level ${a.isolationLevel}`),a.accessMode&&b.push(a.accessMode),"boolean"==typeof a.deferrable&&b.push(a.deferrable?"deferrable":"not deferrable"),bv.raw(b.join(" "))}setTransaction(a){return this.session.execute(bv`set transaction ${this.getTransactionConfigSQL(a)}`)}}class fd extends fa{constructor(a,b,c,d,e,f,g,h,i,j){super({sql:b,params:c},e,f,g),this.client=a,this.queryString=b,this.params=c,this.logger=d,this.fields=h,this._isResponseInArrayMode=i,this.customResultMapper=j}static [aJ]="PostgresJsPreparedQuery";async execute(a={}){return bb("drizzle.execute",async b=>{let c=bz(this.params,a);b?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(c)}),this.logger.logQuery(this.queryString,c);let{fields:d,queryString:e,client:f,joinsNotNullableMap:g,customResultMapper:h}=this;if(!d&&!h)return bb("drizzle.driver.execute",()=>this.queryWithCache(e,c,async()=>await f.unsafe(e,c)));let i=await bb("drizzle.driver.execute",()=>(b?.setAttributes({"drizzle.query.text":e,"drizzle.query.params":JSON.stringify(c)}),this.queryWithCache(e,c,async()=>await f.unsafe(e,c).values())));return bb("drizzle.mapResponse",()=>h?h(i):i.map(a=>(function(a,b,c){let d={},e=a.reduce((a,{path:e,field:f},g)=>{let h;h=aK(f,aP)?f:aK(f,bq)?f.decoder:aK(f,a9)?f._.sql.decoder:f.sql.decoder;let i=a;for(let[a,j]of e.entries())if(a<e.length-1)j in i||(i[j]={}),i=i[j];else{let a=b[g],k=i[j]=null===a?null:h.mapFromDriverValue(a);if(c&&aK(f,aP)&&2===e.length){let a=e[0];a in d?"string"==typeof d[a]&&d[a]!==f.table[aR]&&(d[a]=!1):d[a]=null===k&&f.table[aR]}}return a},{});if(c&&Object.keys(d).length>0)for(let[a,b]of Object.entries(d))"string"!=typeof b||c[b]||(e[a]=null);return e})(d,a,g)))})}all(a={}){return bb("drizzle.execute",async b=>{let c=bz(this.params,a);return b?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(c)}),this.logger.logQuery(this.queryString,c),bb("drizzle.driver.execute",()=>(b?.setAttributes({"drizzle.query.text":this.queryString,"drizzle.query.params":JSON.stringify(c)}),this.queryWithCache(this.queryString,c,async()=>this.client.unsafe(this.queryString,c))))})}isResponseInArrayMode(){return this._isResponseInArrayMode}}class fe extends fb{constructor(a,b,c,d={}){super(b),this.client=a,this.schema=c,this.options=d,this.logger=d.logger??new aN,this.cache=d.cache??new e8}static [aJ]="PostgresJsSession";logger;cache;prepareQuery(a,b,c,d,e,f,g){return new fd(this.client,a.sql,a.params,this.logger,this.cache,f,g,b,d,e)}query(a,b){return this.logger.logQuery(a,b),this.client.unsafe(a,b).values()}queryObjects(a,b){return this.client.unsafe(a,b)}transaction(a,b){return this.client.begin(async c=>{let d=new fe(c,this.dialect,this.schema,this.options),e=new ff(this.dialect,d,this.schema);return b&&await e.setTransaction(b),a(e)})}}class ff extends fc{constructor(a,b,c,d=0){super(a,b,c,d),this.session=b}static [aJ]="PostgresJsTransaction";transaction(a){return this.session.client.savepoint(b=>{let c=new fe(b,this.dialect,this.schema,this.session.options);return a(new ff(this.dialect,c,this.schema))})}}class fg extends e6{static [aJ]="PostgresJsDatabase"}function fh(a,b={}){let c,d,e=a=>a;for(let b of["1184","1082","1083","1114","1182","1185","1115","1231"])a.options.parsers[b]=e,a.options.serializers[b]=e;a.options.serializers["114"]=e,a.options.serializers["3802"]=e;let f=new eA({casing:b.casing});if(!0===b.logger?c=new aM:!1!==b.logger&&(c=b.logger),b.schema){let a=function(a,b){1===Object.keys(a).length&&"default"in a&&!aK(a.default,bl)&&(a=a.default);let c={},d={},e={};for(let[f,g]of Object.entries(a))if(aK(g,bl)){let a=bm(g),b=d[a];for(let d of(c[a]=f,e[f]={tsName:f,dbName:g[bl.Symbol.Name],schema:g[bl.Symbol.Schema],columns:g[bl.Symbol.Columns],relations:b?.relations??{},primaryKey:b?.primaryKey??[]},Object.values(g[bl.Symbol.Columns])))d.primary&&e[f].primaryKey.push(d);let h=g[bl.Symbol.ExtraConfigBuilder]?.(g[bl.Symbol.ExtraConfigColumns]);if(h)for(let a of Object.values(h))aK(a,dU)&&e[f].primaryKey.push(...a.columns)}else if(aK(g,er)){let a,f=bm(g.table),h=c[f];for(let[c,i]of Object.entries(g.config(b(g.table))))if(h){let b=e[h];b.relations[c]=i,a&&b.primaryKey.push(...a)}else f in d||(d[f]={relations:{},primaryKey:a}),d[f].relations[c]=i}return{tables:e,tableNamesMap:c}}(b.schema,ex);d={fullSchema:b.schema,schema:a.tables,tableNamesMap:a.tableNamesMap}}let g=new fe(a,f,d,{logger:c,cache:b.cache}),h=new fg(f,g,d);return h.$client=a,h.$cache=b.cache,h.$cache&&(h.$cache.invalidate=b.cache?.onMutate),h}function fi(...a){if("string"==typeof a[0])return fh(aF(a[0]),a[1]);if(function(a){if("object"!=typeof a||null===a||"Object"!==a.constructor.name)return!1;if("logger"in a){let b=typeof a.logger;return"boolean"===b||"object"===b&&"function"==typeof a.logger.logQuery||"undefined"===b}if("schema"in a){let b=typeof a.schema;return"object"===b||"undefined"===b}if("casing"in a){let b=typeof a.casing;return"string"===b||"undefined"===b}if("mode"in a)return"default"===a.mode&&"planetscale"===a.mode&&void 0===a.mode;if("connection"in a){let b=typeof a.connection;return"string"===b||"object"===b||"undefined"===b}if("client"in a){let b=typeof a.client;return"object"===b||"function"===b||"undefined"===b}return 0===Object.keys(a).length}(a[0])){let{connection:b,client:c,...d}=a[0];if(c)return fh(c,d);if("object"==typeof b&&void 0!==b.url){let{url:a,...c}=b;return fh(aF(a,c),d)}return fh(aF(b),d)}return fh(a[0],a[1])}(fi||(fi={})).mock=function(a){return fh({options:{parsers:{},serializers:{}}},a)};let fj=(lK="user_role",Array.isArray(lL=["USER","ADMIN","SUPER_ADMIN"])?j=Object.assign(a=>new a7(a??"",j),{enumName:lK,enumValues:[...lL],schema:void 0,[a6]:!0}):(lI=void 0,k=Object.assign(a=>new a4(a??"",k),{enumName:lK,enumValues:Object.values(lL),schema:lI,[a6]:!0}))),fk=dM("user",{id:dt("id").primaryKey().defaultRandom(),name:dh("name"),email:dh("email").unique(),emailVerified:dq("emailVerified",{mode:"date"}),image:dh("image"),role:fj("role").default("USER").notNull(),createdAt:dq("created_at",{mode:"date"}).defaultNow().notNull(),updatedAt:dq("updated_at",{mode:"date"}).defaultNow().notNull()}),fl=dM("account",{userId:dt("userId").notNull().references(()=>fk.id,{onDelete:"cascade"}),type:dh("type").notNull(),provider:dh("provider").notNull(),providerAccountId:dh("providerAccountId").notNull(),refresh_token:dh("refresh_token"),access_token:dh("access_token"),expires_at:cr("expires_at"),token_type:dh("token_type"),scope:dh("scope"),id_token:dh("id_token"),session_state:dh("session_state")},a=>[dT({columns:[a.provider,a.providerAccountId]})]),fm=dM("session",{sessionToken:dh("sessionToken").primaryKey(),userId:dt("userId").notNull().references(()=>fk.id,{onDelete:"cascade"}),expires:dq("expires",{mode:"date"}).notNull()}),fn=dM("verificationToken",{identifier:dh("identifier").notNull(),token:dh("token").notNull(),expires:dq("expires",{mode:"date"}).notNull()},a=>[dT({columns:[a.identifier,a.token]})]),fo=dM("authenticator",{credentialID:dh("credentialID").notNull().unique(),userId:dt("userId").notNull().references(()=>fk.id,{onDelete:"cascade"}),providerAccountId:dh("providerAccountId").notNull(),credentialPublicKey:dh("credentialPublicKey").notNull(),counter:cr("counter").notNull(),credentialDeviceType:dh("credentialDeviceType").notNull(),credentialBackedUp:b3("credentialBackedUp").notNull(),transports:dh("transports")},a=>[dT({columns:[a.userId,a.credentialID]})]);a.s(["UserRole",0,{USER:"USER",ADMIN:"ADMIN",SUPER_ADMIN:"SUPER_ADMIN"},"accounts",0,fl,"authenticators",0,fo,"sessions",0,fm,"userRoleEnum",0,fj,"users",0,fk,"verificationTokens",0,fn],32641);var fp=a.i(32641);let fq=fi(aF(process.env.DATABASE_URL),{schema:fp});class fr extends bq{constructor(a){super(fr.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.mapWith(Number),this.session=a.session,this.sql=fr.buildCount(a.source,a.filters)}sql;static [aJ]="MySqlCountBuilder";[Symbol.toStringTag]="MySqlCountBuilder";session;static buildEmbeddedCount(a,b){return bv`(select count(*) from ${a}${bv.raw(" where ").if(b)}${b})`}static buildCount(a,b){return bv`select count(*) as count from ${a}${bv.raw(" where ").if(b)}${b}`}then(a,b){return Promise.resolve(this.session.count(this.sql)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}class fs{constructor(a,b){this.name=a,this.value=b}static [aJ]="MySqlCheckBuilder";brand;build(a){return new ft(a,this)}}class ft{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [aJ]="MySqlCheck";name;value}class fu{static [aJ]="MySqlForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=a,this}onDelete(a){return this._onDelete=a,this}build(a){return new fv(a,this)}}class fv{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [aJ]="MySqlForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[aR],...d,c[0].table[aR],...e];return a??`${f.join("_")}_fk`}}class fw{constructor(a,b){this.name=a,this.unique=b}static [aJ]="MySqlIndexBuilderOn";on(...a){return new fx(this.name,a,this.unique)}}class fx{static [aJ]="MySqlIndexBuilder";config;constructor(a,b,c){this.config={name:a,columns:b,unique:c}}using(a){return this.config.using=a,this}algorithm(a){return this.config.algorithm=a,this}lock(a){return this.config.lock=a,this}build(a){return new fy(this.config,a)}}class fy{static [aJ]="MySqlIndex";config;constructor(a,b){this.config={...a,table:b}}}function fz(a,b){return`${a[aR]}_${b.join("_")}_unique`}class fA{constructor(a,b){this.name=b,this.columns=a}static [aJ]="MySqlUniqueConstraintBuilder";columns;build(a){return new fC(a,this.columns,this.name)}}class fB{static [aJ]="MySqlUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new fA(a,this.name)}}class fC{constructor(a,b,c){this.table=a,this.columns=b,this.name=c??fz(this.table,this.columns.map(a=>a.name))}static [aJ]="MySqlUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}class fD extends aQ{static [aJ]="MySqlColumnBuilder";foreignKeyConfigs=[];references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a){return this.config.isUnique=!0,this.config.uniqueName=a,this}generatedAlwaysAs(a,b){return this.config.generated={as:a,type:"always",mode:b?.mode??"virtual"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>{let e;return e=new fu(()=>({columns:[a],foreignColumns:[c()]})),d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)})}}class fE extends aP{constructor(a,b){b.uniqueName||(b.uniqueName=fz(a,[b.name])),super(a,b),this.table=a}static [aJ]="MySqlColumn"}class fF extends fD{static [aJ]="MySqlColumnBuilderWithAutoIncrement";constructor(a,b,c){super(a,b,c),this.config.autoIncrement=!1}autoincrement(){return this.config.autoIncrement=!0,this.config.hasDefault=!0,this}}class fG extends fE{static [aJ]="MySqlColumnWithAutoIncrement";autoIncrement=this.config.autoIncrement}class fH extends fF{static [aJ]="MySqlBigInt53Builder";constructor(a,b=!1){super(a,"number","MySqlBigInt53"),this.config.unsigned=b}build(a){return new fI(a,this.config)}}class fI extends fG{static [aJ]="MySqlBigInt53";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}}class fJ extends fF{static [aJ]="MySqlBigInt64Builder";constructor(a,b=!1){super(a,"bigint","MySqlBigInt64"),this.config.unsigned=b}build(a){return new fK(a,this.config)}}class fK extends fG{static [aJ]="MySqlBigInt64";getSQLType(){return`bigint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return BigInt(a)}}function fL(a,b){let{name:c,config:d}=bQ(a,b);return"number"===d.mode?new fH(c,d.unsigned):new fJ(c,d.unsigned)}class fM extends fD{static [aJ]="MySqlBinaryBuilder";constructor(a,b){super(a,"string","MySqlBinary"),this.config.length=b}build(a){return new fN(a,this.config)}}class fN extends fE{static [aJ]="MySqlBinary";length=this.config.length;mapFromDriverValue(a){if("string"==typeof a)return a;if(Buffer.isBuffer(a))return a.toString();let b=[];for(let c of a)b.push(49===c?"1":"0");return b.join("")}getSQLType(){return void 0===this.length?"binary":`binary(${this.length})`}}function fO(a,b={}){let{name:c,config:d}=bQ(a,b);return new fM(c,d.length)}class fP extends fD{static [aJ]="MySqlBooleanBuilder";constructor(a){super(a,"boolean","MySqlBoolean")}build(a){return new fQ(a,this.config)}}class fQ extends fE{static [aJ]="MySqlBoolean";getSQLType(){return"boolean"}mapFromDriverValue(a){return"boolean"==typeof a?a:1===a}}function fR(a){return new fP(a??"")}class fS extends fD{static [aJ]="MySqlCharBuilder";constructor(a,b){super(a,"string","MySqlChar"),this.config.length=b.length,this.config.enum=b.enum}build(a){return new fT(a,this.config)}}class fT extends fE{static [aJ]="MySqlChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"char":`char(${this.length})`}}function fU(a,b={}){let{name:c,config:d}=bQ(a,b);return new fS(c,d)}class fV extends fD{static [aJ]="MySqlCustomColumnBuilder";constructor(a,b,c){super(a,"custom","MySqlCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new fW(a,this.config)}}class fW extends fE{static [aJ]="MySqlCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function fX(a){return(b,c)=>{let{name:d,config:e}=bQ(b,c);return new fV(d,e,a)}}class fY extends fD{static [aJ]="MySqlDateBuilder";constructor(a){super(a,"date","MySqlDate")}build(a){return new fZ(a,this.config)}}class fZ extends fE{static [aJ]="MySqlDate";constructor(a,b){super(a,b)}getSQLType(){return"date"}mapFromDriverValue(a){return new Date(a)}}class f$ extends fD{static [aJ]="MySqlDateStringBuilder";constructor(a){super(a,"string","MySqlDateString")}build(a){return new f_(a,this.config)}}class f_ extends fE{static [aJ]="MySqlDateString";constructor(a,b){super(a,b)}getSQLType(){return"date"}}function f0(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode==="string"?new f$(c):new fY(c)}class f1 extends fD{static [aJ]="MySqlDateTimeBuilder";constructor(a,b){super(a,"date","MySqlDateTime"),this.config.fsp=b?.fsp}build(a){return new f2(a,this.config)}}class f2 extends fE{static [aJ]="MySqlDateTime";fsp;constructor(a,b){super(a,b),this.fsp=b.fsp}getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${a}`}mapToDriverValue(a){return a.toISOString().replace("T"," ").replace("Z","")}mapFromDriverValue(a){return new Date(a.replace(" ","T")+"Z")}}class f3 extends fD{static [aJ]="MySqlDateTimeStringBuilder";constructor(a,b){super(a,"string","MySqlDateTimeString"),this.config.fsp=b?.fsp}build(a){return new f4(a,this.config)}}class f4 extends fE{static [aJ]="MySqlDateTimeString";fsp;constructor(a,b){super(a,b),this.fsp=b.fsp}getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`datetime${a}`}}function f5(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode==="string"?new f3(c,d):new f1(c,d)}class f6 extends fF{static [aJ]="MySqlDecimalBuilder";constructor(a,b){super(a,"string","MySqlDecimal"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new f7(a,this.config)}}class f7 extends fG{static [aJ]="MySqlDecimal";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}class f8 extends fF{static [aJ]="MySqlDecimalNumberBuilder";constructor(a,b){super(a,"number","MySqlDecimalNumber"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new f9(a,this.config)}}class f9 extends fG{static [aJ]="MySqlDecimalNumber";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}class ga extends fF{static [aJ]="MySqlDecimalBigIntBuilder";constructor(a,b){super(a,"bigint","MySqlDecimalBigInt"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new gb(a,this.config)}}class gb extends fG{static [aJ]="MySqlDecimalBigInt";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`decimal(${this.precision},${this.scale})`:void 0===this.precision?a+="decimal":a+=`decimal(${this.precision})`,a="decimal(10,0)"===a||"decimal(10)"===a?"decimal":a,this.unsigned?`${a} unsigned`:a}}function gc(a,b={}){let{name:c,config:d}=bQ(a,b),e=d?.mode;return"number"===e?new f8(c,d):"bigint"===e?new ga(c,d):new f6(c,d)}class gd extends fF{static [aJ]="MySqlDoubleBuilder";constructor(a,b){super(a,"number","MySqlDouble"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new ge(a,this.config)}}class ge extends fG{static [aJ]="MySqlDouble";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`double(${this.precision},${this.scale})`:void 0===this.precision?a+="double":a+=`double(${this.precision})`,this.unsigned?`${a} unsigned`:a}}function gf(a,b){let{name:c,config:d}=bQ(a,b);return new gd(c,d)}class gg extends fD{static [aJ]="MySqlEnumColumnBuilder";constructor(a,b){super(a,"string","MySqlEnumColumn"),this.config.enumValues=b}build(a){return new gh(a,this.config)}}class gh extends fE{static [aJ]="MySqlEnumColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(a=>`'${a}'`).join(",")})`}}class gi extends fD{static [aJ]="MySqlEnumObjectColumnBuilder";constructor(a,b){super(a,"string","MySqlEnumObjectColumn"),this.config.enumValues=b}build(a){return new gj(a,this.config)}}class gj extends fE{static [aJ]="MySqlEnumObjectColumn";enumValues=this.config.enumValues;getSQLType(){return`enum(${this.enumValues.map(a=>`'${a}'`).join(",")})`}}function gk(a,b){if("string"==typeof a&&Array.isArray(b)||Array.isArray(a)){let c="string"==typeof a&&a.length>0?a:"",d=("string"==typeof a?b:a)??[];if(0===d.length)throw Error(`You have an empty array for "${c}" enum values`);return new gg(c,d)}if("string"==typeof a&&"object"==typeof b||"object"==typeof a){let c="object"==typeof a?"":a,d="object"==typeof a?Object.values(a):"object"==typeof b?Object.values(b):[];if(0===d.length)throw Error(`You have an empty array for "${c}" enum values`);return new gi(c,d)}}class gl extends fF{static [aJ]="MySqlFloatBuilder";constructor(a,b){super(a,"number","MySqlFloat"),this.config.precision=b?.precision,this.config.scale=b?.scale,this.config.unsigned=b?.unsigned}build(a){return new gm(a,this.config)}}class gm extends fG{static [aJ]="MySqlFloat";precision=this.config.precision;scale=this.config.scale;unsigned=this.config.unsigned;getSQLType(){let a="";return void 0!==this.precision&&void 0!==this.scale?a+=`float(${this.precision},${this.scale})`:void 0===this.precision?a+="float":a+=`float(${this.precision})`,this.unsigned?`${a} unsigned`:a}}function gn(a,b){let{name:c,config:d}=bQ(a,b);return new gl(c,d)}class go extends fF{static [aJ]="MySqlIntBuilder";constructor(a,b){super(a,"number","MySqlInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new gp(a,this.config)}}class gp extends fG{static [aJ]="MySqlInt";getSQLType(){return`int${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function gq(a,b){let{name:c,config:d}=bQ(a,b);return new go(c,d)}class gr extends fD{static [aJ]="MySqlJsonBuilder";constructor(a){super(a,"json","MySqlJson")}build(a){return new gs(a,this.config)}}class gs extends fE{static [aJ]="MySqlJson";getSQLType(){return"json"}mapToDriverValue(a){return JSON.stringify(a)}}function gt(a){return new gr(a??"")}class gu extends fF{static [aJ]="MySqlMediumIntBuilder";constructor(a,b){super(a,"number","MySqlMediumInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new gv(a,this.config)}}class gv extends fG{static [aJ]="MySqlMediumInt";getSQLType(){return`mediumint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function gw(a,b){let{name:c,config:d}=bQ(a,b);return new gu(c,d)}class gx extends fF{static [aJ]="MySqlRealBuilder";constructor(a,b){super(a,"number","MySqlReal"),this.config.precision=b?.precision,this.config.scale=b?.scale}build(a){return new gy(a,this.config)}}class gy extends fG{static [aJ]="MySqlReal";precision=this.config.precision;scale=this.config.scale;getSQLType(){return void 0!==this.precision&&void 0!==this.scale?`real(${this.precision}, ${this.scale})`:void 0===this.precision?"real":`real(${this.precision})`}}function gz(a,b={}){let{name:c,config:d}=bQ(a,b);return new gx(c,d)}class gA extends fF{static [aJ]="MySqlSerialBuilder";constructor(a){super(a,"number","MySqlSerial"),this.config.hasDefault=!0,this.config.autoIncrement=!0}build(a){return new gB(a,this.config)}}class gB extends fG{static [aJ]="MySqlSerial";getSQLType(){return"serial"}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function gC(a){return new gA(a??"")}class gD extends fF{static [aJ]="MySqlSmallIntBuilder";constructor(a,b){super(a,"number","MySqlSmallInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new gE(a,this.config)}}class gE extends fG{static [aJ]="MySqlSmallInt";getSQLType(){return`smallint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function gF(a,b){let{name:c,config:d}=bQ(a,b);return new gD(c,d)}class gG extends fD{static [aJ]="MySqlTextBuilder";constructor(a,b,c){super(a,"string","MySqlText"),this.config.textType=b,this.config.enumValues=c.enum}build(a){return new gH(a,this.config)}}class gH extends fE{static [aJ]="MySqlText";textType=this.config.textType;enumValues=this.config.enumValues;getSQLType(){return this.textType}}function gI(a,b={}){let{name:c,config:d}=bQ(a,b);return new gG(c,"text",d)}function gJ(a,b={}){let{name:c,config:d}=bQ(a,b);return new gG(c,"tinytext",d)}function gK(a,b={}){let{name:c,config:d}=bQ(a,b);return new gG(c,"mediumtext",d)}function gL(a,b={}){let{name:c,config:d}=bQ(a,b);return new gG(c,"longtext",d)}class gM extends fD{static [aJ]="MySqlTimeBuilder";constructor(a,b){super(a,"string","MySqlTime"),this.config.fsp=b?.fsp}build(a){return new gN(a,this.config)}}class gN extends fE{static [aJ]="MySqlTime";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`time${a}`}}function gO(a,b){let{name:c,config:d}=bQ(a,b);return new gM(c,d)}class gP extends fD{static [aJ]="MySqlDateColumnBuilder";defaultNow(){return this.default(bv`(now())`)}onUpdateNow(){return this.config.hasOnUpdateNow=!0,this.config.hasDefault=!0,this}}class gQ extends fE{static [aJ]="MySqlDateColumn";hasOnUpdateNow=this.config.hasOnUpdateNow}class gR extends gP{static [aJ]="MySqlTimestampBuilder";constructor(a,b){super(a,"date","MySqlTimestamp"),this.config.fsp=b?.fsp}build(a){return new gS(a,this.config)}}class gS extends gQ{static [aJ]="MySqlTimestamp";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${a}`}mapFromDriverValue(a){return new Date(a+"+0000")}mapToDriverValue(a){return a.toISOString().slice(0,-1).replace("T"," ")}}class gT extends gP{static [aJ]="MySqlTimestampStringBuilder";constructor(a,b){super(a,"string","MySqlTimestampString"),this.config.fsp=b?.fsp}build(a){return new gU(a,this.config)}}class gU extends gQ{static [aJ]="MySqlTimestampString";fsp=this.config.fsp;getSQLType(){let a=void 0===this.fsp?"":`(${this.fsp})`;return`timestamp${a}`}}function gV(a,b={}){let{name:c,config:d}=bQ(a,b);return d?.mode==="string"?new gT(c,d):new gR(c,d)}class gW extends fF{static [aJ]="MySqlTinyIntBuilder";constructor(a,b){super(a,"number","MySqlTinyInt"),this.config.unsigned=!!b&&b.unsigned}build(a){return new gX(a,this.config)}}class gX extends fG{static [aJ]="MySqlTinyInt";getSQLType(){return`tinyint${this.config.unsigned?" unsigned":""}`}mapFromDriverValue(a){return"string"==typeof a?Number(a):a}}function gY(a,b){let{name:c,config:d}=bQ(a,b);return new gW(c,d)}class gZ extends fD{static [aJ]="MySqlVarBinaryBuilder";constructor(a,b){super(a,"string","MySqlVarBinary"),this.config.length=b?.length}build(a){return new g$(a,this.config)}}class g$ extends fE{static [aJ]="MySqlVarBinary";length=this.config.length;mapFromDriverValue(a){if("string"==typeof a)return a;if(Buffer.isBuffer(a))return a.toString();let b=[];for(let c of a)b.push(49===c?"1":"0");return b.join("")}getSQLType(){return void 0===this.length?"varbinary":`varbinary(${this.length})`}}function g_(a,b){let{name:c,config:d}=bQ(a,b);return new gZ(c,d)}class g0 extends fD{static [aJ]="MySqlVarCharBuilder";constructor(a,b){super(a,"string","MySqlVarChar"),this.config.length=b.length,this.config.enum=b.enum}build(a){return new g1(a,this.config)}}class g1 extends fE{static [aJ]="MySqlVarChar";length=this.config.length;enumValues=this.config.enum;getSQLType(){return void 0===this.length?"varchar":`varchar(${this.length})`}}function g2(a,b){let{name:c,config:d}=bQ(a,b);return new g0(c,d)}class g3 extends fD{static [aJ]="MySqlYearBuilder";constructor(a){super(a,"number","MySqlYear")}build(a){return new g4(a,this.config)}}class g4 extends fE{static [aJ]="MySqlYear";getSQLType(){return"year"}}function g5(a){return new g3(a??"")}let g6=Symbol.for("drizzle:MySqlInlineForeignKeys");class g7 extends bl{static [aJ]="MySqlTable";static Symbol=Object.assign({},bl.Symbol,{InlineForeignKeys:g6});[bl.Symbol.Columns];[g6]=[];[bl.Symbol.ExtraConfigBuilder]=void 0}let g8=(a,b,c)=>(function(a,b,c,d,e=a){let f=new g7(a,d,e),g=Object.fromEntries(Object.entries("function"==typeof b?b({bigint:fL,binary:fO,boolean:fR,char:fU,customType:fX,date:f0,datetime:f5,decimal:gc,double:gf,mysqlEnum:gk,float:gn,int:gq,json:gt,mediumint:gw,real:gz,serial:gC,smallint:gF,text:gI,time:gO,timestamp:gV,tinyint:gY,varbinary:g_,varchar:g2,year:g5,longtext:gL,mediumtext:gK,tinytext:gJ}):b).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[g6].push(...b.buildForeignKeys(c,f)),[a,c]})),h=Object.assign(f,g);return h[bl.Symbol.Columns]=g,h[bl.Symbol.ExtraConfigColumns]=g,c&&(h[g7.Symbol.ExtraConfigBuilder]=c),h})(a,b,c,void 0,a);function g9(...a){return a[0].columns?new ha(a[0].columns,a[0].name):new ha(a)}class ha{static [aJ]="MySqlPrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new hb(a,this.columns,this.name)}}class hb{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [aJ]="MySqlPrimaryKey";columns;name;getName(){return this.name??`${this.table[g7.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}function hc(a){return aK(a,g7)?[`${a[bl.Symbol.BaseName]}`]:aK(a,a9)?a._.usedTables??[]:aK(a,bq)?a.usedTables??[]:[]}function hd(a){return a.map(a=>"object"==typeof a?a.config.name:a)}function he(a){return Array.isArray(a)?a:[a]}Symbol.for("drizzle:MySqlViewConfig");class hf extends aO{constructor(a,b,c,d){super(),this.table=a,this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [aJ]="MySqlDelete";config;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.orderBy=c}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,void 0,void 0,void 0,{type:"delete",tables:hc(this.config.table)})}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}class hg extends bB{static [aJ]="MySqlViewBase"}class hh{static [aJ]="MySqlDialect";casing;constructor(a){this.casing=new d$(a?.casing)}async migrate(a,b,c){let d=c.migrationsTable??"__drizzle_migrations",e=bv`
			create table if not exists ${bv.identifier(d)} (
				id serial primary key,
				hash text not null,
				created_at bigint
			)
		`;await b.execute(e);let f=(await b.all(bv`select id, hash, created_at from ${bv.identifier(d)} order by created_at desc limit 1`))[0];await b.transaction(async b=>{for(let c of a)if(!f||Number(f.created_at)<c.folderMillis){for(let a of c.sql)await b.execute(bv.raw(a));await b.execute(bv`insert into ${bv.identifier(d)} (\`hash\`, \`created_at\`) values(${c.hash}, ${c.folderMillis})`)}})}escapeName(a){return`\`${a}\``}escapeParam(a){return"?"}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[bv`with `];for(let[c,d]of a.entries())b.push(bv`${bv.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(bv`, `);return b.push(bv` `),bv.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d,limit:e,orderBy:f}){let g=this.buildWithCTE(d),h=c?bv` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,i=b?bv` where ${b}`:void 0,j=this.buildOrderBy(f),k=this.buildLimit(e);return bv`${g}delete from ${a}${i}${j}${k}${h}`}buildUpdateSet(a,b){let c=a[bl.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return bv.join(d.flatMap((a,d)=>{let f=c[a],g=f.onUpdateFn?.(),h=b[a]??(aK(g,bq)?g:bv.param(g,f)),i=bv`${bv.identifier(this.casing.getColumnCasing(f))} = ${h}`;return d<e-1?[i,bv.raw(", ")]:[i]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,limit:f,orderBy:g}){let h=this.buildWithCTE(e),i=this.buildUpdateSet(a,b),j=d?bv` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,k=c?bv` where ${c}`:void 0,l=this.buildOrderBy(g),m=this.buildLimit(f);return bv`${h}update ${a} set ${i}${k}${l}${m}${j}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,d=a.flatMap(({field:a},d)=>{let e=[];if(aK(a,bq.Aliased)&&a.isSelectionField)e.push(bv.identifier(a.fieldAlias));else if(aK(a,bq.Aliased)||aK(a,bq)){let c=aK(a,bq.Aliased)?a.sql:a;b?e.push(new bq(c.queryChunks.map(a=>aK(a,fE)?bv.identifier(this.casing.getColumnCasing(a)):a))):e.push(c),aK(a,bq.Aliased)&&e.push(bv` as ${bv.identifier(a.fieldAlias)}`)}else if(aK(a,aP))b?e.push(bv.identifier(this.casing.getColumnCasing(a))):e.push(a);else if(aK(a,a9)){let b=Object.entries(a._.selectedFields);if(1===b.length){let c=b[0][1],d=aK(c,bq)?c.decoder:aK(c,aP)?{mapFromDriverValue:a=>c.mapFromDriverValue(a)}:c.sql.decoder;d&&(a._.sql.decoder=d)}e.push(a)}return d<c-1&&e.push(bv`, `),e});return bv.join(d)}buildLimit(a){return"object"==typeof a||"number"==typeof a&&a>=0?bv` limit ${a}`:void 0}buildOrderBy(a){return a&&a.length>0?bv` order by ${bv.join(a,bv`, `)}`:void 0}buildIndex({indexes:a,indexFor:b}){return a&&a.length>0?bv` ${bv.raw(b)} INDEX (${bv.raw(a.join(", "))})`:void 0}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:d,having:e,table:f,joins:g,orderBy:h,groupBy:i,limit:j,offset:k,lockingClause:l,distinct:m,setOperators:n,useIndex:o,forceIndex:p,ignoreIndex:q}){let r,s=c??bK(b);for(let a of s){let b;if(aK(a.field,aP)&&a.field.table[aR]!==(aK(f,a9)?f._.alias:aK(f,hg)?f[bc].name:aK(f,bq)?void 0:f[aR])&&(b=a.field.table,!g?.some(({alias:a})=>a===(b[bl.Symbol.IsAlias]?b[aR]:b[bl.Symbol.BaseName])))){let b=a.field.table[aR];throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let t=!g||0===g.length,u=this.buildWithCTE(a),v=m?bv` distinct`:void 0,w=this.buildSelection(s,{isSingleTable:t}),x=aK(f,bl)&&f[bl.Symbol.IsAlias]?bv`${bv`${bv.identifier(f[bl.Symbol.Schema]??"")}.`.if(f[bl.Symbol.Schema])}${bv.identifier(f[bl.Symbol.OriginalName])} ${bv.identifier(f[bl.Symbol.Name])}`:f,y=[];if(g)for(let[a,b]of g.entries()){0===a&&y.push(bv` `);let c=b.table,d=b.lateral?bv` lateral`:void 0,e=b.on?bv` on ${b.on}`:void 0;if(aK(c,g7)){let a=c[g7.Symbol.Name],f=c[g7.Symbol.Schema],g=c[g7.Symbol.OriginalName],h=a===g?void 0:b.alias,i=this.buildIndex({indexes:b.useIndex,indexFor:"USE"}),j=this.buildIndex({indexes:b.forceIndex,indexFor:"FORCE"}),k=this.buildIndex({indexes:b.ignoreIndex,indexFor:"IGNORE"});y.push(bv`${bv.raw(b.joinType)} join${d} ${f?bv`${bv.identifier(f)}.`:void 0}${bv.identifier(g)}${i}${j}${k}${h&&bv` ${bv.identifier(h)}`}${e}`)}else if(aK(c,bB)){let a=c[bc].name,f=c[bc].schema,g=c[bc].originalName,h=a===g?void 0:b.alias;y.push(bv`${bv.raw(b.joinType)} join${d} ${f?bv`${bv.identifier(f)}.`:void 0}${bv.identifier(g)}${h&&bv` ${bv.identifier(h)}`}${e}`)}else y.push(bv`${bv.raw(b.joinType)} join${d} ${c}${e}`);a<g.length-1&&y.push(bv` `)}let z=bv.join(y),A=d?bv` where ${d}`:void 0,B=e?bv` having ${e}`:void 0,C=this.buildOrderBy(h),D=i&&i.length>0?bv` group by ${bv.join(i,bv`, `)}`:void 0,E=this.buildLimit(j),F=k?bv` offset ${k}`:void 0,G=this.buildIndex({indexes:o,indexFor:"USE"}),H=this.buildIndex({indexes:p,indexFor:"FORCE"}),I=this.buildIndex({indexes:q,indexFor:"IGNORE"});if(l){let{config:a,strength:b}=l;r=bv` for ${bv.raw(b)}`,a.noWait?r.append(bv` nowait`):a.skipLocked&&r.append(bv` skip locked`)}let J=bv`${u}select${v} ${w} from ${x}${G}${H}${I}${z}${A}${D}${B}${C}${E}${F}${r}`;return n.length>0?this.buildSetOperations(J,n):J}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:e,orderBy:f,offset:g}}){let h,i=bv`(${a.getSQL()}) `,j=bv`(${d.getSQL()})`;if(f&&f.length>0){let a=[];for(let b of f)if(aK(b,fE))a.push(bv.identifier(this.casing.getColumnCasing(b)));else if(aK(b,bq)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];aK(c,fE)&&(b.queryChunks[a]=bv.identifier(this.casing.getColumnCasing(c)))}a.push(bv`${b}`)}else a.push(bv`${b}`);h=bv` order by ${bv.join(a,bv`, `)} `}let k="object"==typeof e||"number"==typeof e&&e>=0?bv` limit ${e}`:void 0,l=bv.raw(`${b} ${c?"all ":""}`),m=g?bv` offset ${g}`:void 0;return bv`${i}${l}${j}${h}${k}${m}`}buildInsertQuery({table:a,values:b,ignore:c,onConflict:d,select:e}){let f=[],g=Object.entries(a[bl.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),h=g.map(([,a])=>bv.identifier(this.casing.getColumnCasing(a))),i=[];if(e)aK(b,bq)?f.push(b):f.push(b.getSQL());else for(let[a,c]of(f.push(bv.raw("values ")),b.entries())){let d={},e=[];for(let[a,b]of g){let f=c[a];if(void 0===f||aK(f,bu)&&void 0===f.value)if(void 0!==b.defaultFn){let c=b.defaultFn();d[a]=c;let f=aK(c,bq)?c:bv.param(c,b);e.push(f)}else if(b.default||void 0===b.onUpdateFn)e.push(bv`default`);else{let a=b.onUpdateFn(),c=aK(a,bq)?a:bv.param(a,b);e.push(c)}else b.defaultFn&&aK(f,bu)&&(d[a]=f.value),e.push(f)}i.push(d),f.push(e),a<b.length-1&&f.push(bv`, `)}let j=bv.join(f),k=c?bv` ignore`:void 0,l=d?bv` on duplicate key ${d}`:void 0;return{sql:bv`insert${k} into ${a} ${h} ${j}${l}`,generatedIds:i}}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:b})}buildRelationalQuery({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k,l,m,n,o=[],p=[];if(!0===f)o=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:bG(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,bG(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,eu()):f.where;m=a&&bI(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let n=[];if(f.with&&(n=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:bv}):f.extras))h.push({tsKey:a,value:bH(b,g)});for(let{tsKey:a,value:b}of h)o.push({dbKey:aK(b,bq.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:aK(b,aP)?bG(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let q="function"==typeof f.orderBy?f.orderBy(d,ev()):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(q)||(q=[q]),l=q.map(a=>aK(a,aP)?bG(a,g):bI(a,g)),j=f.limit,k=f.offset,n)){let f=ew(b,c,h),i=c[bm(h.referencedTable)],j=`${g}_${d}`,k=d5(...f.fields.map((a,b)=>d3(bG(f.references[b],j),bG(a,g)))),l=this.buildRelationalQuery({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:aK(h,es)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:k,nestedQueryRelation:h}),m=bv`${bv.identifier(j)}.${bv.identifier("data")}`.as(d);p.push({on:bv`true`,table:new a9(l.sql,{},j),alias:j,joinType:"left",lateral:!0}),o.push({dbKey:d,tsKey:d,field:m,relationTableTsKey:i,isJson:!0,selection:l.selection})}}if(0===o.length)throw new d_({message:`No fields selected for table "${e.tsName}" ("${g}")`});if(m=d5(i,m),h){let a=bv`json_array(${bv.join(o.map(({field:a,tsKey:b,isJson:c})=>c?bv`${bv.identifier(`${g}_${b}`)}.${bv.identifier("data")}`:aK(a,bq.Aliased)?a.sql:a),bv`, `)})`;aK(h,et)&&(a=bv`coalesce(json_arrayagg(${a}), json_array())`);let b=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:e.tsName,selection:o}];void 0!==j||void 0!==k||(l?.length??0)>0?(n=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:[{path:[],field:bv.raw("*")},...(l?.length??0)>0?[{path:[],field:bv`row_number() over (order by ${bv.join(l,bv`, `)})`}]:[]],where:m,limit:j,offset:k,setOperators:[]}),m=void 0,j=void 0,k=void 0,l=void 0):n=bF(d,g),n=this.buildSelectQuery({table:aK(n,g7)?n:new a9(n,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:m,limit:j,offset:k,orderBy:l,setOperators:[]})}else n=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:o.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:m,limit:j,offset:k,orderBy:l,setOperators:[]});return{tableTsKey:e.tsName,sql:n,selection:o}}buildRelationalQueryWithoutLateralSubqueries({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k=[],l,m,n=[],o;if(!0===f)k=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:bG(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,bG(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,eu()):f.where;o=a&&bI(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let j=[];if(f.with&&(j=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:bv}):f.extras))h.push({tsKey:a,value:bH(b,g)});for(let{tsKey:a,value:b}of h)k.push({dbKey:aK(b,bq.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:aK(b,aP)?bG(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let p="function"==typeof f.orderBy?f.orderBy(d,ev()):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(p)||(p=[p]),n=p.map(a=>aK(a,aP)?bG(a,g):bI(a,g)),l=f.limit,m=f.offset,j)){let f=ew(b,c,h),i=c[bm(h.referencedTable)],j=`${g}_${d}`,l=d5(...f.fields.map((a,b)=>d3(bG(f.references[b],j),bG(a,g)))),m=this.buildRelationalQueryWithoutLateralSubqueries({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:aK(h,es)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:l,nestedQueryRelation:h}),n=bv`(${m.sql})`;aK(h,et)&&(n=bv`coalesce(${n}, json_array())`);let o=n.as(d);k.push({dbKey:d,tsKey:d,field:o,relationTableTsKey:i,isJson:!0,selection:m.selection})}}if(0===k.length)throw new d_({message:`No fields selected for table "${e.tsName}" ("${g}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(o=d5(i,o),h){let a=bv`json_array(${bv.join(k.map(({field:a})=>aK(a,fE)?bv.identifier(this.casing.getColumnCasing(a)):aK(a,bq.Aliased)?a.sql:a),bv`, `)})`;aK(h,et)&&(a=bv`json_arrayagg(${a})`);let b=[{dbKey:"data",tsKey:"data",field:a,isJson:!0,relationTableTsKey:e.tsName,selection:k}];void 0!==l||void 0!==m||n.length>0?(j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:[{path:[],field:bv.raw("*")},...n.length>0?[{path:[],field:bv`row_number() over (order by ${bv.join(n,bv`, `)})`}]:[]],where:o,limit:l,offset:m,setOperators:[]}),o=void 0,l=void 0,m=void 0,n=void 0):j=bF(d,g),j=this.buildSelectQuery({table:aK(j,g7)?j:new a9(j,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),where:o,limit:l,offset:m,orderBy:n,setOperators:[]})}else j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:k.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),where:o,limit:l,offset:m,orderBy:n,setOperators:[]});return{tableTsKey:e.tsName,sql:j,selection:k}}}class hi{static [aJ]="MySqlSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,a.withList&&(this.withList=a.withList),this.distinct=a.distinct}from(a,b){let c,d=!!this.fields;c=this.fields?this.fields:aK(a,a9)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):aK(a,hg)?a[bc].selectedFields:aK(a,bq)?{}:bO(a);let e=[],f=[],g=[];return aK(a,g7)&&b&&"string"!=typeof b&&(b.useIndex&&(e=hd(he(b.useIndex))),b.forceIndex&&(f=hd(he(b.forceIndex))),b.ignoreIndex&&(g=hd(he(b.ignoreIndex)))),new hk({table:a,fields:c,isPartialSelect:d,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct,useIndex:e,forceIndex:f,ignoreIndex:g})}}class hj extends eB{static [aJ]="MySqlSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g,useIndex:h,forceIndex:i,ignoreIndex:j}){for(const k of(super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[],useIndex:h,forceIndex:i,ignoreIndex:j},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=bP(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},hc(a)))this.usedTables.add(k)}getUsedTables(){return[...this.usedTables]}createJoin(a,b){return(c,d,e)=>{let f="cross"===a,g=f?void 0:d,h=f?d:e,i=this.tableName,j=bP(c);for(let a of hc(c))this.usedTables.add(a);if("string"==typeof j&&this.config.joins?.some(a=>a.alias===j))throw Error(`Alias "${j}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof i&&(this.config.fields={[i]:this.config.fields}),"string"==typeof j&&!aK(c,bq))){let a=aK(c,a9)?c._.selectedFields:aK(c,bB)?c[bc].selectedFields:c[bl.Symbol.Columns];this.config.fields[j]=a}"function"==typeof g&&(g=g(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]);let k=[],l=[],m=[];if(aK(c,g7)&&h&&"string"!=typeof h&&(h.useIndex&&(k=hd(he(h.useIndex))),h.forceIndex&&(l=hd(he(h.forceIndex))),h.ignoreIndex&&(m=hd(he(h.ignoreIndex)))),this.config.joins.push({on:g,table:c,joinType:a,alias:j,useIndex:k,forceIndex:l,ignoreIndex:m,lateral:b}),"string"==typeof j)switch(a){case"left":this.joinsNotNullableMap[j]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[j]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[j]=!0}return this}}leftJoin=this.createJoin("left",!1);leftJoinLateral=this.createJoin("left",!0);rightJoin=this.createJoin("right",!1);innerJoin=this.createJoin("inner",!1);innerJoinLateral=this.createJoin("inner",!0);crossJoin=this.createJoin("cross",!1);crossJoinLateral=this.createJoin("cross",!0);createSetOperator(a,b){return c=>{let d="function"==typeof c?c(hm()):c;if(!bL(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}for(a,b={}){return this.config.lockingClause={strength:a,config:b},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...hc(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...hc(a.table));return new Proxy(new a9(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new bJ({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}}class hk extends hj{static [aJ]="MySqlSelect";prepare(){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let a=bK(this.config.fields),b=this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),a,void 0,void 0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return b.joinsNotNullableMap=this.joinsNotNullableMap,b}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator()}function hl(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!bL(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}bN(hk,[aO]);let hm=()=>({union:hn,unionAll:ho,intersect:hp,intersectAll:hq,except:hr,exceptAll:hs}),hn=hl("union",!1),ho=hl("union",!0),hp=hl("intersect",!1),hq=hl("intersect",!0),hr=hl("except",!1),hs=hl("except",!0);class ht{static [aJ]="MySqlQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=aK(a,hh)?a:void 0,this.dialectConfig=aK(a,hh)?void 0:a}$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(c)),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new hi({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(c){return new hi({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a,distinct:!0})}}}select(a){return new hi({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new hi({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new hh(this.dialectConfig)),this.dialect}}class hu{constructor(a,b,c){this.table=a,this.session=b,this.dialect=c}static [aJ]="MySqlInsertBuilder";shouldIgnore=!1;ignore(){return this.shouldIgnore=!0,this}values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let b=a.map(a=>{let b={},c=this.table[bl.Symbol.Columns];for(let d of Object.keys(a)){let e=a[d];b[d]=aK(e,bq)?e:new bu(e,c[d])}return b});return new hv(this.table,b,this.shouldIgnore,this.session,this.dialect)}select(a){let b="function"==typeof a?a(new ht):a;if(!aK(b,bq)&&!bL(this.table[be],b._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new hv(this.table,b,this.shouldIgnore,this.session,this.dialect,!0)}}class hv extends aO{constructor(a,b,c,d,e,f){super(),this.session=d,this.dialect=e,this.config={table:a,values:b,select:f,ignore:c}}static [aJ]="MySqlInsert";config;cacheConfig;onDuplicateKeyUpdate(a){let b=this.dialect.buildUpdateSet(this.config.table,bM(this.config.table,a.set));return this.config.onConflict=bv`update ${b}`,this}$returningId(){let a=[];for(let[b,c]of Object.entries(this.config.table[bl.Symbol.Columns]))c.primary&&a.push({field:c,path:[b]});return this.config.returning=a,this}getSQL(){return this.dialect.buildInsertQuery(this.config).sql}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){let{sql:a,generatedIds:b}=this.dialect.buildInsertQuery(this.config);return this.session.prepareQuery(this.dialect.sqlToQuery(a),void 0,void 0,b,this.config.returning,{type:"insert",tables:hc(this.config.table)},this.cacheConfig)}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}class hw{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [aJ]="MySqlUpdateBuilder";set(a){return new hx(this.table,bM(this.table,a),this.session,this.dialect,this.withList)}}class hx extends aO{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e}}static [aJ]="MySqlUpdate";config;cacheConfig;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.orderBy=c}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}prepare(){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,void 0,void 0,this.config.returning,{type:"insert",tables:hc(this.config.table)},this.cacheConfig)}execute=a=>this.prepare().execute(a);createIterator=()=>{let a=this;return async function*(b){yield*a.prepare().iterator(b)}};iterator=this.createIterator();$dynamic(){return this}}class hy{constructor(a,b,c,d,e,f,g,h){this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.mode=h}static [aJ]="MySqlRelationalQueryBuilder";findMany(a){return new hz(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many",this.mode)}findFirst(a){return new hz(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first",this.mode)}}class hz extends aO{constructor(a,b,c,d,e,f,g,h,i,j){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.queryMode=i,this.mode=j}static [aJ]="MySqlRelationalQuery";prepare(){let{query:a,builtQuery:b}=this._toSQL();return this.session.prepareQuery(b,void 0,b=>{let c=b.map(b=>ey(this.schema,this.tableConfig,b,a.selection));return"first"===this.queryMode?c[0]:c})}_getQuery(){return"planetscale"===this.mode?this.dialect.buildRelationalQueryWithoutLateralSubqueries({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}):this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}_toSQL(){let a=this._getQuery();return{builtQuery:this.dialect.sqlToQuery(a.sql),query:a}}getSQL(){return this._getQuery().sql}toSQL(){return this._toSQL().builtQuery}execute(){return this.prepare().execute()}}class hA{constructor(a,b,c,d){if(this.dialect=a,this.session=b,this.mode=d,this._=c?{schema:c.schema,fullSchema:c.fullSchema,tableNamesMap:c.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={},this._.schema)for(const[d,e]of Object.entries(this._.schema))this.query[d]=new hy(c.fullSchema,this._.schema,this._.tableNamesMap,c.fullSchema[d],e,a,b,this.mode);this.$cache={invalidate:async a=>{}}}static [aJ]="MySqlDatabase";query;$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(new ht(c.dialect))),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new fr({source:a,filters:b,session:this.session})}$cache;with(...a){let b=this;return{select:function(c){return new hi({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new hi({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},update:function(c){return new hw(c,b.session,b.dialect,a)},delete:function(c){return new hf(c,b.session,b.dialect,a)}}}select(a){return new hi({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new hi({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(a){return new hw(a,this.session,this.dialect)}insert(a){return new hu(a,this.session,this.dialect)}delete(a){return new hf(a,this.session,this.dialect)}execute(a){return this.session.execute("string"==typeof a?bv.raw(a):a.getSQL())}transaction(a,b){return this.session.transaction(a,b)}}class hB{static [aJ]="SQLiteForeignKeyBuilder";reference;_onUpdate;_onDelete;constructor(a,b){this.reference=()=>{let{name:b,columns:c,foreignColumns:d}=a();return{name:b,columns:c,foreignTable:d[0].table,foreignColumns:d}},b&&(this._onUpdate=b.onUpdate,this._onDelete=b.onDelete)}onUpdate(a){return this._onUpdate=a,this}onDelete(a){return this._onDelete=a,this}build(a){return new hC(a,this)}}class hC{constructor(a,b){this.table=a,this.reference=b.reference,this.onUpdate=b._onUpdate,this.onDelete=b._onDelete}static [aJ]="SQLiteForeignKey";reference;onUpdate;onDelete;getName(){let{name:a,columns:b,foreignColumns:c}=this.reference(),d=b.map(a=>a.name),e=c.map(a=>a.name),f=[this.table[aR],...d,c[0].table[aR],...e];return a??`${f.join("_")}_fk`}}function hD(a,b){return`${a[aR]}_${b.join("_")}_unique`}class hE{constructor(a,b){this.name=b,this.columns=a}static [aJ]="SQLiteUniqueConstraintBuilder";columns;build(a){return new hG(a,this.columns,this.name)}}class hF{static [aJ]="SQLiteUniqueOnConstraintBuilder";name;constructor(a){this.name=a}on(...a){return new hE(a,this.name)}}class hG{constructor(a,b,c){this.table=a,this.columns=b,this.name=c??hD(this.table,this.columns.map(a=>a.name))}static [aJ]="SQLiteUniqueConstraint";columns;name;getName(){return this.name}}class hH extends aQ{static [aJ]="SQLiteColumnBuilder";foreignKeyConfigs=[];references(a,b={}){return this.foreignKeyConfigs.push({ref:a,actions:b}),this}unique(a){return this.config.isUnique=!0,this.config.uniqueName=a,this}generatedAlwaysAs(a,b){return this.config.generated={as:a,type:"always",mode:b?.mode??"virtual"},this}buildForeignKeys(a,b){return this.foreignKeyConfigs.map(({ref:c,actions:d})=>{let e;return e=new hB(()=>({columns:[a],foreignColumns:[c()]})),d.onUpdate&&e.onUpdate(d.onUpdate),d.onDelete&&e.onDelete(d.onDelete),e.build(b)})}}class hI extends aP{constructor(a,b){b.uniqueName||(b.uniqueName=hD(a,[b.name])),super(a,b),this.table=a}static [aJ]="SQLiteColumn"}class hJ extends hH{static [aJ]="SQLiteBigIntBuilder";constructor(a){super(a,"bigint","SQLiteBigInt")}build(a){return new hK(a,this.config)}}class hK extends hI{static [aJ]="SQLiteBigInt";getSQLType(){return"blob"}mapFromDriverValue(a){return"u">typeof Buffer&&Buffer.from?BigInt((Buffer.isBuffer(a)?a:a instanceof ArrayBuffer?Buffer.from(a):a.buffer?Buffer.from(a.buffer,a.byteOffset,a.byteLength):Buffer.from(a)).toString("utf8")):BigInt(bR.decode(a))}mapToDriverValue(a){return Buffer.from(a.toString())}}class hL extends hH{static [aJ]="SQLiteBlobJsonBuilder";constructor(a){super(a,"json","SQLiteBlobJson")}build(a){return new hM(a,this.config)}}class hM extends hI{static [aJ]="SQLiteBlobJson";getSQLType(){return"blob"}mapFromDriverValue(a){return"u">typeof Buffer&&Buffer.from?JSON.parse((Buffer.isBuffer(a)?a:a instanceof ArrayBuffer?Buffer.from(a):a.buffer?Buffer.from(a.buffer,a.byteOffset,a.byteLength):Buffer.from(a)).toString("utf8")):JSON.parse(bR.decode(a))}mapToDriverValue(a){return Buffer.from(JSON.stringify(a))}}class hN extends hH{static [aJ]="SQLiteBlobBufferBuilder";constructor(a){super(a,"buffer","SQLiteBlobBuffer")}build(a){return new hO(a,this.config)}}class hO extends hI{static [aJ]="SQLiteBlobBuffer";mapFromDriverValue(a){return Buffer.isBuffer(a)?a:Buffer.from(a)}getSQLType(){return"blob"}}function hP(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode==="json"?new hL(c):d?.mode==="bigint"?new hJ(c):new hN(c)}class hQ extends hH{static [aJ]="SQLiteCustomColumnBuilder";constructor(a,b,c){super(a,"custom","SQLiteCustomColumn"),this.config.fieldConfig=b,this.config.customTypeParams=c}build(a){return new hR(a,this.config)}}class hR extends hI{static [aJ]="SQLiteCustomColumn";sqlName;mapTo;mapFrom;constructor(a,b){super(a,b),this.sqlName=b.customTypeParams.dataType(b.fieldConfig),this.mapTo=b.customTypeParams.toDriver,this.mapFrom=b.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(a){return"function"==typeof this.mapFrom?this.mapFrom(a):a}mapToDriverValue(a){return"function"==typeof this.mapTo?this.mapTo(a):a}}function hS(a){return(b,c)=>{let{name:d,config:e}=bQ(b,c);return new hQ(d,e,a)}}class hT extends hH{static [aJ]="SQLiteBaseIntegerBuilder";constructor(a,b,c){super(a,b,c),this.config.autoIncrement=!1}primaryKey(a){return a?.autoIncrement&&(this.config.autoIncrement=!0),this.config.hasDefault=!0,super.primaryKey()}}class hU extends hI{static [aJ]="SQLiteBaseInteger";autoIncrement=this.config.autoIncrement;getSQLType(){return"integer"}}class hV extends hT{static [aJ]="SQLiteIntegerBuilder";constructor(a){super(a,"number","SQLiteInteger")}build(a){return new hW(a,this.config)}}class hW extends hU{static [aJ]="SQLiteInteger"}class hX extends hT{static [aJ]="SQLiteTimestampBuilder";constructor(a,b){super(a,"date","SQLiteTimestamp"),this.config.mode=b}defaultNow(){return this.default(bv`(cast((julianday('now') - 2440587.5)*86400000 as integer))`)}build(a){return new hY(a,this.config)}}class hY extends hU{static [aJ]="SQLiteTimestamp";mode=this.config.mode;mapFromDriverValue(a){return new Date("timestamp"===this.config.mode?1e3*a:a)}mapToDriverValue(a){let b=a.getTime();return"timestamp"===this.config.mode?Math.floor(b/1e3):b}}class hZ extends hT{static [aJ]="SQLiteBooleanBuilder";constructor(a,b){super(a,"boolean","SQLiteBoolean"),this.config.mode=b}build(a){return new h$(a,this.config)}}class h$ extends hU{static [aJ]="SQLiteBoolean";mode=this.config.mode;mapFromDriverValue(a){return 1===Number(a)}mapToDriverValue(a){return+!!a}}function h_(a,b){let{name:c,config:d}=bQ(a,b);return d?.mode==="timestamp"||d?.mode==="timestamp_ms"?new hX(c,d.mode):d?.mode==="boolean"?new hZ(c,d.mode):new hV(c)}class h0 extends hH{static [aJ]="SQLiteNumericBuilder";constructor(a){super(a,"string","SQLiteNumeric")}build(a){return new h1(a,this.config)}}class h1 extends hI{static [aJ]="SQLiteNumeric";mapFromDriverValue(a){return"string"==typeof a?a:String(a)}getSQLType(){return"numeric"}}class h2 extends hH{static [aJ]="SQLiteNumericNumberBuilder";constructor(a){super(a,"number","SQLiteNumericNumber")}build(a){return new h3(a,this.config)}}class h3 extends hI{static [aJ]="SQLiteNumericNumber";mapFromDriverValue(a){return"number"==typeof a?a:Number(a)}mapToDriverValue=String;getSQLType(){return"numeric"}}class h4 extends hH{static [aJ]="SQLiteNumericBigIntBuilder";constructor(a){super(a,"bigint","SQLiteNumericBigInt")}build(a){return new h5(a,this.config)}}class h5 extends hI{static [aJ]="SQLiteNumericBigInt";mapFromDriverValue=BigInt;mapToDriverValue=String;getSQLType(){return"numeric"}}function h6(a,b){let{name:c,config:d}=bQ(a,b),e=d?.mode;return"number"===e?new h2(c):"bigint"===e?new h4(c):new h0(c)}class h7 extends hH{static [aJ]="SQLiteRealBuilder";constructor(a){super(a,"number","SQLiteReal")}build(a){return new h8(a,this.config)}}class h8 extends hI{static [aJ]="SQLiteReal";getSQLType(){return"real"}}function h9(a){return new h7(a??"")}class ia extends hH{static [aJ]="SQLiteTextBuilder";constructor(a,b){super(a,"string","SQLiteText"),this.config.enumValues=b.enum,this.config.length=b.length}build(a){return new ib(a,this.config)}}class ib extends hI{static [aJ]="SQLiteText";enumValues=this.config.enumValues;length=this.config.length;constructor(a,b){super(a,b)}getSQLType(){return`text${this.config.length?`(${this.config.length})`:""}`}}class ic extends hH{static [aJ]="SQLiteTextJsonBuilder";constructor(a){super(a,"json","SQLiteTextJson")}build(a){return new id(a,this.config)}}class id extends hI{static [aJ]="SQLiteTextJson";getSQLType(){return"text"}mapFromDriverValue(a){return JSON.parse(a)}mapToDriverValue(a){return JSON.stringify(a)}}function ie(a,b={}){let{name:c,config:d}=bQ(a,b);return"json"===d.mode?new ic(c):new ia(c,d)}let ig=Symbol.for("drizzle:SQLiteInlineForeignKeys");class ih extends bl{static [aJ]="SQLiteTable";static Symbol=Object.assign({},bl.Symbol,{InlineForeignKeys:ig});[bl.Symbol.Columns];[ig]=[];[bl.Symbol.ExtraConfigBuilder]=void 0}let ii=(a,b,c)=>(function(a,b,c,d,e=a){let f=new ih(a,void 0,e),g=Object.fromEntries(Object.entries("function"==typeof b?b({blob:hP,customType:hS,integer:h_,numeric:h6,real:h9,text:ie}):b).map(([a,b])=>{b.setName(a);let c=b.build(f);return f[ig].push(...b.buildForeignKeys(c,f)),[a,c]})),h=Object.assign(f,g);return h[bl.Symbol.Columns]=g,h[bl.Symbol.ExtraConfigColumns]=g,c&&(h[ih.Symbol.ExtraConfigBuilder]=c),h})(a,b,c);class ij extends bB{static [aJ]="SQLiteViewBase"}class ik{static [aJ]="SQLiteDialect";casing;constructor(a){this.casing=new d$(a?.casing)}escapeName(a){return`"${a}"`}escapeParam(a){return"?"}escapeString(a){return`'${a.replace(/'/g,"''")}'`}buildWithCTE(a){if(!a?.length)return;let b=[bv`with `];for(let[c,d]of a.entries())b.push(bv`${bv.identifier(d._.alias)} as (${d._.sql})`),c<a.length-1&&b.push(bv`, `);return b.push(bv` `),bv.join(b)}buildDeleteQuery({table:a,where:b,returning:c,withList:d,limit:e,orderBy:f}){let g=this.buildWithCTE(d),h=c?bv` returning ${this.buildSelection(c,{isSingleTable:!0})}`:void 0,i=b?bv` where ${b}`:void 0,j=this.buildOrderBy(f),k=this.buildLimit(e);return bv`${g}delete from ${a}${i}${h}${j}${k}`}buildUpdateSet(a,b){let c=a[bl.Symbol.Columns],d=Object.keys(c).filter(a=>void 0!==b[a]||c[a]?.onUpdateFn!==void 0),e=d.length;return bv.join(d.flatMap((a,d)=>{let f=c[a],g=f.onUpdateFn?.(),h=b[a]??(aK(g,bq)?g:bv.param(g,f)),i=bv`${bv.identifier(this.casing.getColumnCasing(f))} = ${h}`;return d<e-1?[i,bv.raw(", ")]:[i]}))}buildUpdateQuery({table:a,set:b,where:c,returning:d,withList:e,joins:f,from:g,limit:h,orderBy:i}){let j=this.buildWithCTE(e),k=this.buildUpdateSet(a,b),l=g&&bv.join([bv.raw(" from "),this.buildFromTable(g)]),m=this.buildJoins(f),n=d?bv` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,o=c?bv` where ${c}`:void 0,p=this.buildOrderBy(i),q=this.buildLimit(h);return bv`${j}update ${a} set ${k}${l}${m}${o}${n}${p}${q}`}buildSelection(a,{isSingleTable:b=!1}={}){let c=a.length,d=a.flatMap(({field:a},d)=>{let e=[];if(aK(a,bq.Aliased)&&a.isSelectionField)e.push(bv.identifier(a.fieldAlias));else if(aK(a,bq.Aliased)||aK(a,bq)){let c=aK(a,bq.Aliased)?a.sql:a;b?e.push(new bq(c.queryChunks.map(a=>aK(a,aP)?bv.identifier(this.casing.getColumnCasing(a)):a))):e.push(c),aK(a,bq.Aliased)&&e.push(bv` as ${bv.identifier(a.fieldAlias)}`)}else if(aK(a,aP)){let c=a.table[bl.Symbol.Name];"SQLiteNumericBigInt"===a.columnType?b?e.push(bv`cast(${bv.identifier(this.casing.getColumnCasing(a))} as text)`):e.push(bv`cast(${bv.identifier(c)}.${bv.identifier(this.casing.getColumnCasing(a))} as text)`):b?e.push(bv.identifier(this.casing.getColumnCasing(a))):e.push(bv`${bv.identifier(c)}.${bv.identifier(this.casing.getColumnCasing(a))}`)}else if(aK(a,a9)){let b=Object.entries(a._.selectedFields);if(1===b.length){let c=b[0][1],d=aK(c,bq)?c.decoder:aK(c,aP)?{mapFromDriverValue:a=>c.mapFromDriverValue(a)}:c.sql.decoder;d&&(a._.sql.decoder=d)}e.push(a)}return d<c-1&&e.push(bv`, `),e});return bv.join(d)}buildJoins(a){if(!a||0===a.length)return;let b=[];if(a)for(let[c,d]of a.entries()){0===c&&b.push(bv` `);let e=d.table,f=d.on?bv` on ${d.on}`:void 0;if(aK(e,ih)){let a=e[ih.Symbol.Name],c=e[ih.Symbol.Schema],g=e[ih.Symbol.OriginalName],h=a===g?void 0:d.alias;b.push(bv`${bv.raw(d.joinType)} join ${c?bv`${bv.identifier(c)}.`:void 0}${bv.identifier(g)}${h&&bv` ${bv.identifier(h)}`}${f}`)}else b.push(bv`${bv.raw(d.joinType)} join ${e}${f}`);c<a.length-1&&b.push(bv` `)}return bv.join(b)}buildLimit(a){return"object"==typeof a||"number"==typeof a&&a>=0?bv` limit ${a}`:void 0}buildOrderBy(a){let b=[];if(a)for(let[c,d]of a.entries())b.push(d),c<a.length-1&&b.push(bv`, `);return b.length>0?bv` order by ${bv.join(b)}`:void 0}buildFromTable(a){return aK(a,bl)&&a[bl.Symbol.IsAlias]?bv`${bv`${bv.identifier(a[bl.Symbol.Schema]??"")}.`.if(a[bl.Symbol.Schema])}${bv.identifier(a[bl.Symbol.OriginalName])} ${bv.identifier(a[bl.Symbol.Name])}`:a}buildSelectQuery({withList:a,fields:b,fieldsFlat:c,where:d,having:e,table:f,joins:g,orderBy:h,groupBy:i,limit:j,offset:k,distinct:l,setOperators:m}){let n=c??bK(b);for(let a of n){let b;if(aK(a.field,aP)&&a.field.table[aR]!==(aK(f,a9)?f._.alias:aK(f,ij)?f[bc].name:aK(f,bq)?void 0:f[aR])&&(b=a.field.table,!g?.some(({alias:a})=>a===(b[bl.Symbol.IsAlias]?b[aR]:b[bl.Symbol.BaseName])))){let b=a.field.table[aR];throw Error(`Your "${a.path.join("->")}" field references a column "${b}"."${a.field.name}", but the table "${b}" is not part of the query! Did you forget to join it?`)}}let o=!g||0===g.length,p=this.buildWithCTE(a),q=l?bv` distinct`:void 0,r=this.buildSelection(n,{isSingleTable:o}),s=this.buildFromTable(f),t=this.buildJoins(g),u=d?bv` where ${d}`:void 0,v=e?bv` having ${e}`:void 0,w=[];if(i)for(let[a,b]of i.entries())w.push(b),a<i.length-1&&w.push(bv`, `);let x=w.length>0?bv` group by ${bv.join(w)}`:void 0,y=this.buildOrderBy(h),z=this.buildLimit(j),A=k?bv` offset ${k}`:void 0,B=bv`${p}select${q} ${r} from ${s}${t}${u}${x}${v}${y}${z}${A}`;return m.length>0?this.buildSetOperations(B,m):B}buildSetOperations(a,b){let[c,...d]=b;if(!c)throw Error("Cannot pass undefined values to any set operator");return 0===d.length?this.buildSetOperationQuery({leftSelect:a,setOperator:c}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:a,setOperator:c}),d)}buildSetOperationQuery({leftSelect:a,setOperator:{type:b,isAll:c,rightSelect:d,limit:e,orderBy:f,offset:g}}){let h,i=bv`${a.getSQL()} `,j=bv`${d.getSQL()}`;if(f&&f.length>0){let a=[];for(let b of f)if(aK(b,hI))a.push(bv.identifier(b.name));else if(aK(b,bq)){for(let a=0;a<b.queryChunks.length;a++){let c=b.queryChunks[a];aK(c,hI)&&(b.queryChunks[a]=bv.identifier(this.casing.getColumnCasing(c)))}a.push(bv`${b}`)}else a.push(bv`${b}`);h=bv` order by ${bv.join(a,bv`, `)}`}let k="object"==typeof e||"number"==typeof e&&e>=0?bv` limit ${e}`:void 0,l=bv.raw(`${b} ${c?"all ":""}`),m=g?bv` offset ${g}`:void 0;return bv`${i}${l}${j}${h}${k}${m}`}buildInsertQuery({table:a,values:b,onConflict:c,returning:d,withList:e,select:f}){let g=[],h=Object.entries(a[bl.Symbol.Columns]).filter(([a,b])=>!b.shouldDisableInsert()),i=h.map(([,a])=>bv.identifier(this.casing.getColumnCasing(a)));if(f)aK(b,bq)?g.push(b):g.push(b.getSQL());else for(let[a,c]of(g.push(bv.raw("values ")),b.entries())){let d=[];for(let[a,b]of h){let e=c[a];if(void 0===e||aK(e,bu)&&void 0===e.value){let a;if(null!==b.default&&void 0!==b.default)a=aK(b.default,bq)?b.default:bv.param(b.default,b);else if(void 0!==b.defaultFn){let c=b.defaultFn();a=aK(c,bq)?c:bv.param(c,b)}else if(b.default||void 0===b.onUpdateFn)a=bv`null`;else{let c=b.onUpdateFn();a=aK(c,bq)?c:bv.param(c,b)}d.push(a)}else d.push(e)}g.push(d),a<b.length-1&&g.push(bv`, `)}let j=this.buildWithCTE(e),k=bv.join(g),l=d?bv` returning ${this.buildSelection(d,{isSingleTable:!0})}`:void 0,m=c?.length?bv.join(c):void 0;return bv`${j}insert into ${a} ${i} ${k}${m}${l}`}sqlToQuery(a,b){return a.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,invokeSource:b})}buildRelationalQuery({fullSchema:a,schema:b,tableNamesMap:c,table:d,tableConfig:e,queryConfig:f,tableAlias:g,nestedQueryRelation:h,joinOn:i}){let j,k=[],l,m,n=[],o,p=[];if(!0===f)k=Object.entries(e.columns).map(([a,b])=>({dbKey:b.name,tsKey:a,field:bG(b,g),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{let d=Object.fromEntries(Object.entries(e.columns).map(([a,b])=>[a,bG(b,g)]));if(f.where){let a="function"==typeof f.where?f.where(d,eu()):f.where;o=a&&bI(a,g)}let h=[],i=[];if(f.columns){let a=!1;for(let[b,c]of Object.entries(f.columns))void 0!==c&&b in e.columns&&(a||!0!==c||(a=!0),i.push(b));i.length>0&&(i=a?i.filter(a=>f.columns?.[a]===!0):Object.keys(e.columns).filter(a=>!i.includes(a)))}else i=Object.keys(e.columns);for(let a of i){let b=e.columns[a];h.push({tsKey:a,value:b})}let j=[];if(f.with&&(j=Object.entries(f.with).filter(a=>!!a[1]).map(([a,b])=>({tsKey:a,queryConfig:b,relation:e.relations[a]}))),f.extras)for(let[a,b]of Object.entries("function"==typeof f.extras?f.extras(d,{sql:bv}):f.extras))h.push({tsKey:a,value:bH(b,g)});for(let{tsKey:a,value:b}of h)k.push({dbKey:aK(b,bq.Aliased)?b.fieldAlias:e.columns[a].name,tsKey:a,field:aK(b,aP)?bG(b,g):b,relationTableTsKey:void 0,isJson:!1,selection:[]});let p="function"==typeof f.orderBy?f.orderBy(d,ev()):f.orderBy??[];for(let{tsKey:d,queryConfig:e,relation:h}of(Array.isArray(p)||(p=[p]),n=p.map(a=>aK(a,aP)?bG(a,g):bI(a,g)),l=f.limit,m=f.offset,j)){let f=ew(b,c,h),i=c[bm(h.referencedTable)],j=`${g}_${d}`,l=d5(...f.fields.map((a,b)=>d3(bG(f.references[b],j),bG(a,g)))),m=this.buildRelationalQuery({fullSchema:a,schema:b,tableNamesMap:c,table:a[i],tableConfig:b[i],queryConfig:aK(h,es)?!0===e?{limit:1}:{...e,limit:1}:e,tableAlias:j,joinOn:l,nestedQueryRelation:h}),n=bv`(${m.sql})`.as(d);k.push({dbKey:d,tsKey:d,field:n,relationTableTsKey:i,isJson:!0,selection:m.selection})}}if(0===k.length)throw new d_({message:`No fields selected for table "${e.tsName}" ("${g}"). You need to have at least one item in "columns", "with" or "extras". If you need to select all columns, omit the "columns" key or set it to undefined.`});if(o=d5(i,o),h){let a=bv`json_array(${bv.join(k.map(({field:a})=>aK(a,hI)?bv.identifier(this.casing.getColumnCasing(a)):aK(a,bq.Aliased)?a.sql:a),bv`, `)})`;aK(h,et)&&(a=bv`coalesce(json_group_array(${a}), json_array())`);let b=[{dbKey:"data",tsKey:"data",field:a.as("data"),isJson:!0,relationTableTsKey:e.tsName,selection:k}];void 0!==l||void 0!==m||n.length>0?(j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:[{path:[],field:bv.raw("*")}],where:o,limit:l,offset:m,orderBy:n,setOperators:[]}),o=void 0,l=void 0,m=void 0,n=void 0):j=bF(d,g),j=this.buildSelectQuery({table:aK(j,ih)?j:new a9(j,{},g),fields:{},fieldsFlat:b.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]})}else j=this.buildSelectQuery({table:bF(d,g),fields:{},fieldsFlat:k.map(({field:a})=>({path:[],field:aK(a,aP)?bG(a,g):a})),joins:p,where:o,limit:l,offset:m,orderBy:n,setOperators:[]});return{tableTsKey:e.tsName,sql:j,selection:k}}}class il extends ik{static [aJ]="SQLiteSyncDialect";migrate(a,b,c){let d=void 0===c||"string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e=bv`
			CREATE TABLE IF NOT EXISTS ${bv.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;b.run(e);let f=b.values(bv`SELECT id, hash, created_at FROM ${bv.identifier(d)} ORDER BY created_at DESC LIMIT 1`)[0]??void 0;b.run(bv`BEGIN`);try{for(let c of a)if(!f||Number(f[2])<c.folderMillis){for(let a of c.sql)b.run(bv.raw(a));b.run(bv`INSERT INTO ${bv.identifier(d)} ("hash", "created_at") VALUES(${c.hash}, ${c.folderMillis})`)}b.run(bv`COMMIT`)}catch(a){throw b.run(bv`ROLLBACK`),a}}}class im extends ik{static [aJ]="SQLiteAsyncDialect";async migrate(a,b,c){let d=void 0===c||"string"==typeof c?"__drizzle_migrations":c.migrationsTable??"__drizzle_migrations",e=bv`
			CREATE TABLE IF NOT EXISTS ${bv.identifier(d)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at numeric
			)
		`;await b.run(e);let f=(await b.values(bv`SELECT id, hash, created_at FROM ${bv.identifier(d)} ORDER BY created_at DESC LIMIT 1`))[0]??void 0;await b.transaction(async b=>{for(let c of a)if(!f||Number(f[2])<c.folderMillis){for(let a of c.sql)await b.run(bv.raw(a));await b.run(bv`INSERT INTO ${bv.identifier(d)} ("hash", "created_at") VALUES(${c.hash}, ${c.folderMillis})`)}})}}class io{constructor(a,b){this.name=a,this.value=b}static [aJ]="SQLiteCheckBuilder";brand;build(a){return new ip(a,this)}}class ip{constructor(a,b){this.table=a,this.name=b.name,this.value=b.value}static [aJ]="SQLiteCheck";name;value}class iq{constructor(a,b){this.name=a,this.unique=b}static [aJ]="SQLiteIndexBuilderOn";on(...a){return new ir(this.name,a,this.unique)}}class ir{static [aJ]="SQLiteIndexBuilder";config;constructor(a,b,c){this.config={name:a,columns:b,unique:c,where:void 0}}where(a){return this.config.where=a,this}build(a){return new is(this.config,a)}}class is{static [aJ]="SQLiteIndex";config;constructor(a,b){this.config={...a,table:b}}}function it(...a){return a[0].columns?new iu(a[0].columns,a[0].name):new iu(a)}class iu{static [aJ]="SQLitePrimaryKeyBuilder";columns;name;constructor(a,b){this.columns=a,this.name=b}build(a){return new iv(a,this.columns,this.name)}}class iv{constructor(a,b,c){this.table=a,this.columns=b,this.name=c}static [aJ]="SQLitePrimaryKey";columns;name;getName(){return this.name??`${this.table[ih.Symbol.Name]}_${this.columns.map(a=>a.name).join("_")}_pk`}}function iw(a){return aK(a,ih)?[`${a[bl.Symbol.BaseName]}`]:aK(a,a9)?a._.usedTables??[]:aK(a,bq)?a.usedTables??[]:[]}class ix{static [aJ]="SQLiteSelectBuilder";fields;session;dialect;withList;distinct;constructor(a){this.fields=a.fields,this.session=a.session,this.dialect=a.dialect,this.withList=a.withList,this.distinct=a.distinct}from(a){let b,c=!!this.fields;return b=this.fields?this.fields:aK(a,a9)?Object.fromEntries(Object.keys(a._.selectedFields).map(b=>[b,a[b]])):aK(a,ij)?a[bc].selectedFields:aK(a,bq)?{}:bO(a),new iz({table:a,fields:b,isPartialSelect:c,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class iy extends eB{static [aJ]="SQLiteSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;cacheConfig=void 0;usedTables=new Set;constructor({table:a,fields:b,isPartialSelect:c,session:d,dialect:e,withList:f,distinct:g}){for(const h of(super(),this.config={withList:f,table:a,fields:{...b},distinct:g,setOperators:[]},this.isPartialSelect=c,this.session=d,this.dialect=e,this._={selectedFields:b,config:this.config},this.tableName=bP(a),this.joinsNotNullableMap="string"==typeof this.tableName?{[this.tableName]:!0}:{},iw(a)))this.usedTables.add(h)}getUsedTables(){return[...this.usedTables]}createJoin(a){return(b,c)=>{let d=this.tableName,e=bP(b);for(let a of iw(b))this.usedTables.add(a);if("string"==typeof e&&this.config.joins?.some(a=>a.alias===e))throw Error(`Alias "${e}" is already used in this query`);if(!this.isPartialSelect&&(1===Object.keys(this.joinsNotNullableMap).length&&"string"==typeof d&&(this.config.fields={[d]:this.config.fields}),"string"==typeof e&&!aK(b,bq))){let a=aK(b,a9)?b._.selectedFields:aK(b,bB)?b[bc].selectedFields:b[bl.Symbol.Columns];this.config.fields[e]=a}if("function"==typeof c&&(c=c(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:c,table:b,joinType:a,alias:e}),"string"==typeof e)switch(a){case"left":this.joinsNotNullableMap[e]=!1;break;case"right":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!0;break;case"cross":case"inner":this.joinsNotNullableMap[e]=!0;break;case"full":this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([a])=>[a,!1])),this.joinsNotNullableMap[e]=!1}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");crossJoin=this.createJoin("cross");createSetOperator(a,b){return c=>{let d="function"==typeof c?c(iB()):c;if(!bL(this.getSelectedFields(),d.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:a,isAll:b,rightSelect:d}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);except=this.createSetOperator("except",!1);addSetOperators(a){return this.config.setOperators.push(...a),this}where(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=a,this}having(a){return"function"==typeof a&&(a=a(new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=a,this}groupBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(b)?b:[b]}else this.config.groupBy=a;return this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.fields,new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=c:this.config.orderBy=c}else this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=a:this.config.orderBy=a;return this}limit(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=a:this.config.limit=a,this}offset(a){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=a:this.config.offset=a,this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}as(a){let b=[];if(b.push(...iw(this.config.table)),this.config.joins)for(let a of this.config.joins)b.push(...iw(a.table));return new Proxy(new a9(this.getSQL(),this.config.fields,a,!1,[...new Set(b)]),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new bJ({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class iz extends iy{static [aJ]="SQLiteSelect";_prepare(a=!0){if(!this.session)throw Error("Cannot execute a query on a query builder. Please use a database instance instead.");let b=bK(this.config.fields),c=this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),b,"all",!0,void 0,{type:"select",tables:[...this.usedTables]},this.cacheConfig);return c.joinsNotNullableMap=this.joinsNotNullableMap,c}$withCache(a){return this.cacheConfig=void 0===a?{config:{},enable:!0,autoInvalidate:!0}:!1===a?{enable:!1}:{enable:!0,autoInvalidate:!0,...a},this}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.all()}}function iA(a,b){return(c,d,...e)=>{let f=[d,...e].map(c=>({type:a,isAll:b,rightSelect:c}));for(let a of f)if(!bL(c.getSelectedFields(),a.rightSelect.getSelectedFields()))throw Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return c.addSetOperators(f)}}bN(iz,[aO]);let iB=()=>({union:iC,unionAll:iD,intersect:iE,except:iF}),iC=iA("union",!1),iD=iA("union",!0),iE=iA("intersect",!1),iF=iA("except",!1);class iG{static [aJ]="SQLiteQueryBuilder";dialect;dialectConfig;constructor(a){this.dialect=aK(a,ik)?a:void 0,this.dialectConfig=aK(a,ik)?void 0:a}$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(c)),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};with(...a){let b=this;return{select:function(c){return new ix({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a})},selectDistinct:function(c){return new ix({fields:c??void 0,session:void 0,dialect:b.getDialect(),withList:a,distinct:!0})}}}select(a){return new ix({fields:a??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(a){return new ix({fields:a??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}getDialect(){return this.dialect||(this.dialect=new il(this.dialectConfig)),this.dialect}}class iH extends aO{constructor(a,b,c,d){super(),this.table=a,this.session=b,this.dialect=c,this.config={table:a,withList:d}}static [aJ]="SQLiteDelete";config;where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.orderBy=c}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}returning(a=this.table[ih.Symbol.Columns]){return this.config.returning=bK(a),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"delete",tables:iw(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(a){return this._prepare().execute(a)}$dynamic(){return this}}class iI{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [aJ]="SQLiteInsertBuilder";values(a){if(0===(a=Array.isArray(a)?a:[a]).length)throw Error("values() must be called with at least one value");let b=a.map(a=>{let b={},c=this.table[bl.Symbol.Columns];for(let d of Object.keys(a)){let e=a[d];b[d]=aK(e,bq)?e:new bu(e,c[d])}return b});return new iJ(this.table,b,this.session,this.dialect,this.withList)}select(a){let b="function"==typeof a?a(new iG):a;if(!aK(b,bq)&&!bL(this.table[be],b._.selectedFields))throw Error("Insert select error: selected fields are not the same or are in a different order compared to the table definition");return new iJ(this.table,b,this.session,this.dialect,this.withList,!0)}}class iJ extends aO{constructor(a,b,c,d,e,f){super(),this.session=c,this.dialect=d,this.config={table:a,values:b,withList:e,select:f}}static [aJ]="SQLiteInsert";config;returning(a=this.config.table[ih.Symbol.Columns]){return this.config.returning=bK(a),this}onConflictDoNothing(a={}){if(this.config.onConflict||(this.config.onConflict=[]),void 0===a.target)this.config.onConflict.push(bv` on conflict do nothing`);else{let b=Array.isArray(a.target)?bv`${a.target}`:bv`${[a.target]}`,c=a.where?bv` where ${a.where}`:bv``;this.config.onConflict.push(bv` on conflict ${b} do nothing${c}`)}return this}onConflictDoUpdate(a){if(a.where&&(a.targetWhere||a.setWhere))throw Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');this.config.onConflict||(this.config.onConflict=[]);let b=a.where?bv` where ${a.where}`:void 0,c=a.targetWhere?bv` where ${a.targetWhere}`:void 0,d=a.setWhere?bv` where ${a.setWhere}`:void 0,e=Array.isArray(a.target)?bv`${a.target}`:bv`${[a.target]}`,f=this.dialect.buildUpdateSet(this.config.table,bM(this.config.table,a.set));return this.config.onConflict.push(bv` on conflict ${e}${c} do update set ${f}${b}${d}`),this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:iw(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class iK{constructor(a,b,c,d){this.table=a,this.session=b,this.dialect=c,this.withList=d}static [aJ]="SQLiteUpdateBuilder";set(a){return new iL(this.table,bM(this.table,a),this.session,this.dialect,this.withList)}}class iL extends aO{constructor(a,b,c,d,e){super(),this.session=c,this.dialect=d,this.config={set:b,table:a,withList:e,joins:[]}}static [aJ]="SQLiteUpdate";config;from(a){return this.config.from=a,this}createJoin(a){return(b,c)=>{let d=bP(b);if("string"==typeof d&&this.config.joins.some(a=>a.alias===d))throw Error(`Alias "${d}" is already used in this query`);if("function"==typeof c){let a=this.config.from?aK(b,ih)?b[bl.Symbol.Columns]:aK(b,a9)?b._.selectedFields:aK(b,ij)?b[bc].selectedFields:void 0:void 0;c=c(new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})),a&&new Proxy(a,new bJ({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))}return this.config.joins.push({on:c,table:b,joinType:a,alias:d}),this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");where(a){return this.config.where=a,this}orderBy(...a){if("function"==typeof a[0]){let b=a[0](new Proxy(this.config.table[bl.Symbol.Columns],new bJ({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),c=Array.isArray(b)?b:[b];this.config.orderBy=c}else this.config.orderBy=a;return this}limit(a){return this.config.limit=a,this}returning(a=this.config.table[ih.Symbol.Columns]){return this.config.returning=bK(a),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){let{typings:a,...b}=this.dialect.sqlToQuery(this.getSQL());return b}_prepare(a=!0){return this.session[a?"prepareOneTimeQuery":"prepareQuery"](this.dialect.sqlToQuery(this.getSQL()),this.config.returning,this.config.returning?"all":"run",!0,void 0,{type:"insert",tables:iw(this.config.table)})}prepare(){return this._prepare(!1)}run=a=>this._prepare().run(a);all=a=>this._prepare().all(a);get=a=>this._prepare().get(a);values=a=>this._prepare().values(a);async execute(){return this.config.returning?this.all():this.run()}$dynamic(){return this}}class iM extends bq{constructor(a){super(iM.buildEmbeddedCount(a.source,a.filters).queryChunks),this.params=a,this.session=a.session,this.sql=iM.buildCount(a.source,a.filters)}sql;static [aJ]="SQLiteCountBuilderAsync";[Symbol.toStringTag]="SQLiteCountBuilderAsync";session;static buildEmbeddedCount(a,b){return bv`(select count(*) from ${a}${bv.raw(" where ").if(b)}${b})`}static buildCount(a,b){return bv`select count(*) from ${a}${bv.raw(" where ").if(b)}${b}`}then(a,b){return Promise.resolve(this.session.count(this.sql)).then(a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>(a?.(),b),b=>{throw a?.(),b})}}class iN{constructor(a,b,c,d,e,f,g,h){this.mode=a,this.fullSchema=b,this.schema=c,this.tableNamesMap=d,this.table=e,this.tableConfig=f,this.dialect=g,this.session=h}static [aJ]="SQLiteAsyncRelationalQueryBuilder";findMany(a){return"sync"===this.mode?new iP(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many"):new iO(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a||{},"many")}findFirst(a){return"sync"===this.mode?new iP(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first"):new iO(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,a?{...a,limit:1}:{limit:1},"first")}}class iO extends aO{constructor(a,b,c,d,e,f,g,h,i){super(),this.fullSchema=a,this.schema=b,this.tableNamesMap=c,this.table=d,this.tableConfig=e,this.dialect=f,this.session=g,this.config=h,this.mode=i}static [aJ]="SQLiteAsyncRelationalQuery";mode;getSQL(){return this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}).sql}_prepare(a=!1){let{query:b,builtQuery:c}=this._toSQL();return this.session[a?"prepareOneTimeQuery":"prepareQuery"](c,void 0,"first"===this.mode?"get":"all",!0,(a,c)=>{let d=a.map(a=>ey(this.schema,this.tableConfig,a,b.selection,c));return"first"===this.mode?d[0]:d})}prepare(){return this._prepare(!1)}_toSQL(){let a=this.dialect.buildRelationalQuery({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName}),b=this.dialect.sqlToQuery(a.sql);return{query:a,builtQuery:b}}toSQL(){return this._toSQL().builtQuery}executeRaw(){return"first"===this.mode?this._prepare(!1).get():this._prepare(!1).all()}async execute(){return this.executeRaw()}}class iP extends iO{static [aJ]="SQLiteSyncRelationalQuery";sync(){return this.executeRaw()}}class iQ extends aO{constructor(a,b,c,d,e){super(),this.execute=a,this.getSQL=b,this.dialect=d,this.mapBatchResult=e,this.config={action:c}}static [aJ]="SQLiteRaw";config;getQuery(){return{...this.dialect.sqlToQuery(this.getSQL()),method:this.config.action}}mapResult(a,b){return b?this.mapBatchResult(a):a}_prepare(){return this}isResponseInArrayMode(){return!1}}class iR{constructor(a,b,c,d){this.resultKind=a,this.dialect=b,this.session=c,this._=d?{schema:d.schema,fullSchema:d.fullSchema,tableNamesMap:d.tableNamesMap}:{schema:void 0,fullSchema:{},tableNamesMap:{}},this.query={};const e=this.query;if(this._.schema)for(const[f,g]of Object.entries(this._.schema))e[f]=new iN(a,d.fullSchema,this._.schema,this._.tableNamesMap,d.fullSchema[f],g,b,c);this.$cache={invalidate:async a=>{}}}static [aJ]="BaseSQLiteDatabase";query;$with=(a,b)=>{let c=this;return{as:d=>("function"==typeof d&&(d=d(new iG(c.dialect))),new Proxy(new ba(d.getSQL(),b??("getSelectedFields"in d?d.getSelectedFields()??{}:{}),a,!0),new bJ({alias:a,sqlAliasedBehavior:"alias",sqlBehavior:"error"})))}};$count(a,b){return new iM({source:a,filters:b,session:this.session})}with(...a){let b=this;return{select:function(c){return new ix({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a})},selectDistinct:function(c){return new ix({fields:c??void 0,session:b.session,dialect:b.dialect,withList:a,distinct:!0})},update:function(c){return new iK(c,b.session,b.dialect,a)},insert:function(c){return new iI(c,b.session,b.dialect,a)},delete:function(c){return new iH(c,b.session,b.dialect,a)}}}select(a){return new ix({fields:a??void 0,session:this.session,dialect:this.dialect})}selectDistinct(a){return new ix({fields:a??void 0,session:this.session,dialect:this.dialect,distinct:!0})}update(a){return new iK(a,this.session,this.dialect)}$cache;insert(a){return new iI(a,this.session,this.dialect)}delete(a){return new iH(a,this.session,this.dialect)}run(a){let b="string"==typeof a?bv.raw(a):a.getSQL();return"async"===this.resultKind?new iQ(async()=>this.session.run(b),()=>b,"run",this.dialect,this.session.extractRawRunValueFromBatchResult.bind(this.session)):this.session.run(b)}all(a){let b="string"==typeof a?bv.raw(a):a.getSQL();return"async"===this.resultKind?new iQ(async()=>this.session.all(b),()=>b,"all",this.dialect,this.session.extractRawAllValueFromBatchResult.bind(this.session)):this.session.all(b)}get(a){let b="string"==typeof a?bv.raw(a):a.getSQL();return"async"===this.resultKind?new iQ(async()=>this.session.get(b),()=>b,"get",this.dialect,this.session.extractRawGetValueFromBatchResult.bind(this.session)):this.session.get(b)}values(a){let b="string"==typeof a?bv.raw(a):a.getSQL();return"async"===this.resultKind?new iQ(async()=>this.session.values(b),()=>b,"values",this.dialect,this.session.extractRawValuesValueFromBatchResult.bind(this.session)):this.session.values(b)}transaction(a,b){return this.session.transaction(a,b)}}var iS=function(a,b,c,d,e){if("m"===d)throw TypeError("Private method is not writable");if("a"===d&&!e)throw TypeError("Private accessor was defined without a setter");if("function"==typeof b?a!==b||!e:!b.has(a))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===d?e.call(a,c):e?e.value=c:b.set(a,c),c},iT=function(a,b,c,d){if("a"===c&&!d)throw TypeError("Private accessor was defined without a getter");if("function"==typeof b?a!==b||!d:!b.has(a))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===c?d:"a"===c?d.call(a):d?d.value:b.get(a)};function iU(a){let b=a?"__Secure-":"";return{sessionToken:{name:`${b}authjs.session-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},callbackUrl:{name:`${b}authjs.callback-url`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},csrfToken:{name:`${a?"__Host-":""}authjs.csrf-token`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},pkceCodeVerifier:{name:`${b}authjs.pkce.code_verifier`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a,maxAge:900}},state:{name:`${b}authjs.state`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a,maxAge:900}},nonce:{name:`${b}authjs.nonce`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a}},webauthnChallenge:{name:`${b}authjs.challenge`,options:{httpOnly:!0,sameSite:"lax",path:"/",secure:a,maxAge:900}}}}class iV{constructor(a,b,c){if(lM.add(this),lN.set(this,{}),lO.set(this,void 0),lP.set(this,void 0),iS(this,lP,c,"f"),iS(this,lO,a,"f"),!b)return;const{name:d}=a;for(const[a,c]of Object.entries(b))a.startsWith(d)&&c&&(iT(this,lN,"f")[a]=c)}get value(){return Object.keys(iT(this,lN,"f")).sort((a,b)=>parseInt(a.split(".").pop()||"0")-parseInt(b.split(".").pop()||"0")).map(a=>iT(this,lN,"f")[a]).join("")}chunk(a,b){let c=iT(this,lM,"m",lR).call(this);for(let d of iT(this,lM,"m",lQ).call(this,{name:iT(this,lO,"f").name,value:a,options:{...iT(this,lO,"f").options,...b}}))c[d.name]=d;return Object.values(c)}clean(){return Object.values(iT(this,lM,"m",lR).call(this))}}lN=new WeakMap,lO=new WeakMap,lP=new WeakMap,lM=new WeakSet,lQ=function(a){let b=Math.ceil(a.value.length/3936);if(1===b)return iT(this,lN,"f")[a.name]=a.value,[a];let c=[];for(let d=0;d<b;d++){let b=`${a.name}.${d}`,e=a.value.substr(3936*d,3936);c.push({...a,name:b,value:e}),iT(this,lN,"f")[b]=e}return iT(this,lP,"f").debug("CHUNKING_SESSION_COOKIE",{message:"Session cookie exceeds allowed 4096 bytes.",emptyCookieSize:160,valueSize:a.value.length,chunks:c.map(a=>a.value.length+160)}),c},lR=function(){let a={};for(let b in iT(this,lN,"f"))delete iT(this,lN,"f")?.[b],a[b]={name:b,value:"",options:{...iT(this,lO,"f").options,maxAge:0}};return a};class iW extends Error{constructor(a,b){a instanceof Error?super(void 0,{cause:{err:a,...a.cause,...b}}):"string"==typeof a?(b instanceof Error&&(b={err:b,...b.cause}),super(a,b)):super(void 0,a),this.name=this.constructor.name,this.type=this.constructor.type??"AuthError",this.kind=this.constructor.kind??"error",Error.captureStackTrace?.(this,this.constructor);const c=`https://errors.authjs.dev#${this.type.toLowerCase()}`;this.message+=`${this.message?". ":""}Read more at ${c}`}}class iX extends iW{}iX.kind="signIn";class iY extends iW{}iY.type="AdapterError";class iZ extends iW{}iZ.type="AccessDenied";class i$ extends iW{}i$.type="CallbackRouteError";class i_ extends iW{}i_.type="ErrorPageLoop";class i0 extends iW{}i0.type="EventError";class i1 extends iW{}i1.type="InvalidCallbackUrl";class i2 extends iX{constructor(){super(...arguments),this.code="credentials"}}i2.type="CredentialsSignin";class i3 extends iW{}i3.type="InvalidEndpoints";class i4 extends iW{}i4.type="InvalidCheck";class i5 extends iW{}i5.type="JWTSessionError";class i6 extends iW{}i6.type="MissingAdapter";class i7 extends iW{}i7.type="MissingAdapterMethods";class i8 extends iW{}i8.type="MissingAuthorize";class i9 extends iW{}i9.type="MissingSecret";class ja extends iX{}ja.type="OAuthAccountNotLinked";class jb extends iX{}jb.type="OAuthCallbackError";class jc extends iW{}jc.type="OAuthProfileParseError";class jd extends iW{}jd.type="SessionTokenError";class je extends iW{}je.type="SignOutError";class jf extends iW{}jf.type="UnknownAction";class jg extends iW{}jg.type="UnsupportedStrategy";class jh extends iW{}jh.type="InvalidProvider";class ji extends iW{}ji.type="UntrustedHost";class jj extends iW{}jj.type="Verification";class jk extends iX{}jk.type="MissingCSRF";let jl=new Set(["CredentialsSignin","OAuthAccountNotLinked","OAuthCallbackError","AccessDenied","Verification","MissingCSRF","AccountNotLinked","WebAuthnVerificationError"]);class jm extends iW{}jm.type="DuplicateConditionalUI";class jn extends iW{}jn.type="MissingWebAuthnAutocomplete";class jo extends iW{}jo.type="WebAuthnVerificationError";class jp extends iX{}jp.type="AccountNotLinked";class jq extends iW{}jq.type="ExperimentalFeatureNotEnabled";let jr=!1;function js(a,b){try{return/^https?:/.test(new URL(a,a.startsWith("/")?b:void 0).protocol)}catch{return!1}}let jt=!1,ju=!1,jv=!1,jw=["createVerificationToken","useVerificationToken","getUserByEmail"],jx=["createUser","getUser","getUserByEmail","getUserByAccount","updateUser","linkAccount","createSession","getSessionAndUser","updateSession","deleteSession"],jy=["createUser","getUser","linkAccount","getAccount","getAuthenticator","createAuthenticator","listAuthenticatorsByUserId","updateAuthenticatorCounter"];"function"!=typeof ag.hkdf||process.versions.electron||(d=async(...a)=>new Promise((b,c)=>{ag.hkdf(...a,(a,d)=>{a?c(a):b(new Uint8Array(d))})}));let jz=async(a,b,c,e,f)=>(d||((a,b,c,d,e)=>{let f=parseInt(a.substr(3),10)>>3||20,g=(0,ag.createHmac)(a,c.byteLength?c:new Uint8Array(f)).update(b).digest(),h=Math.ceil(e/f),i=new Uint8Array(f*h+d.byteLength+1),j=0,k=0;for(let b=1;b<=h;b++)i.set(d,k),i[k+d.byteLength]=b,i.set((0,ag.createHmac)(a,g).update(i.subarray(j,k+d.byteLength+1)).digest(),k),j=k,k+=f;return i.slice(0,e)}))(a,b,c,e,f);function jA(a,b){if("string"==typeof a)return new TextEncoder().encode(a);if(!(a instanceof Uint8Array))throw TypeError(`"${b}"" must be an instance of Uint8Array or a string`);return a}async function jB(a,b,c,d,e){return jz(function(a){switch(a){case"sha256":case"sha384":case"sha512":case"sha1":return a;default:throw TypeError('unsupported "digest" value')}}(a),function(a){let b=jA(a,"ikm");if(!b.byteLength)throw TypeError('"ikm" must be at least one byte in length');return b}(b),jA(c,"salt"),function(a){let b=jA(a,"info");if(b.byteLength>1024)throw TypeError('"info" must not contain more than 1024 bytes');return b}(d),function(a,b){if("number"!=typeof a||!Number.isInteger(a)||a<1)throw TypeError('"keylen" must be a positive integer');if(a>255*(parseInt(b.substr(3),10)>>3||20))throw TypeError('"keylen" too large');return a}(e,a))}let jC=new TextEncoder,jD=new TextDecoder;function jE(...a){let b=new Uint8Array(a.reduce((a,{length:b})=>a+b,0)),c=0;for(let d of a)b.set(d,c),c+=d.length;return b}function jF(a,b,c){if(b<0||b>=0x100000000)throw RangeError(`value must be >= 0 and <= ${0x100000000-1}. Received ${b}`);a.set([b>>>24,b>>>16,b>>>8,255&b],c)}function jG(a){let b=Math.floor(a/0x100000000),c=new Uint8Array(8);return jF(c,b,0),jF(c,a%0x100000000,4),c}function jH(a){let b=new Uint8Array(4);return jF(b,a),b}function jI(a){let b=new Uint8Array(a.length);for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);if(d>127)throw TypeError("non-ASCII string encountered in encode()");b[c]=d}return b}function jJ(a){if(Uint8Array.fromBase64)return Uint8Array.fromBase64("string"==typeof a?a:jD.decode(a),{alphabet:"base64url"});let b=a;b instanceof Uint8Array&&(b=jD.decode(b)),b=b.replace(/-/g,"+").replace(/_/g,"/");try{var c=b;if(Uint8Array.fromBase64)return Uint8Array.fromBase64(c);let a=atob(c),d=new Uint8Array(a.length);for(let b=0;b<a.length;b++)d[b]=a.charCodeAt(b);return d}catch{throw TypeError("The input to be decoded is not correctly encoded.")}}function jK(a){let b=a;return("string"==typeof b&&(b=jC.encode(b)),Uint8Array.prototype.toBase64)?b.toBase64({alphabet:"base64url",omitPadding:!0}):(function(a){if(Uint8Array.prototype.toBase64)return a.toBase64();let b=[];for(let c=0;c<a.length;c+=32768)b.push(String.fromCharCode.apply(null,a.subarray(c,c+32768)));return btoa(b.join(""))})(b).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}a.s(["decode",()=>jJ,"encode",()=>jK],76340);let jL=Symbol();class jM extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(a,b){super(a,b),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class jN extends jM{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class jO extends jM{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(a,b,c="unspecified",d="unspecified"){super(a,{cause:{claim:c,reason:d,payload:b}}),this.claim=c,this.reason=d,this.payload=b}}class jP extends jM{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class jQ extends jM{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class jR extends jM{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(a="decryption operation failed",b){super(a,b)}}class jS extends jM{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class jT extends jM{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class jU extends jM{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class jV extends jM{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(a="multiple matching keys found in the JSON Web Key Set",b){super(a,b)}}function jW(a){switch(a){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new jQ(`Unsupported JWE Algorithm: ${a}`)}}function jX(a,b){if(b.length<<3!==jW(a))throw new jS("Invalid Initialization Vector length")}function jY(a,b){let c=a.byteLength<<3;if(c!==b)throw new jS(`Invalid Content Encryption Key length. Expected ${b} bits, got ${c} bits`)}let jZ=(a,b="algorithm.name")=>TypeError(`CryptoKey does not support this operation, its ${b} must be ${a}`);function j$(a,b,c){switch(b){case"A128GCM":case"A192GCM":case"A256GCM":{if("AES-GCM"!==a.algorithm.name)throw jZ("AES-GCM");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw jZ(c,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if("AES-KW"!==a.algorithm.name)throw jZ("AES-KW");let c=parseInt(b.slice(1,4),10);if(a.algorithm.length!==c)throw jZ(c,"algorithm.length");break}case"ECDH":switch(a.algorithm.name){case"ECDH":case"X25519":break;default:throw jZ("ECDH or X25519")}break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if("PBKDF2"!==a.algorithm.name)throw jZ("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if("RSA-OAEP"!==a.algorithm.name)throw jZ("RSA-OAEP");let c=parseInt(b.slice(9),10)||1;if(parseInt(a.algorithm.hash.name.slice(4),10)!==c)throw jZ(`SHA-${c}`,"algorithm.hash");break}default:throw TypeError("CryptoKey does not support this operation")}if(c&&!a.usages.includes(c))throw TypeError(`CryptoKey does not support this operation, its usages must include ${c}.`)}function j_(a,b,...c){if((c=c.filter(Boolean)).length>2){let b=c.pop();a+=`one of type ${c.join(", ")}, or ${b}.`}else 2===c.length?a+=`one of type ${c[0]} or ${c[1]}.`:a+=`of type ${c[0]}.`;return null==b?a+=` Received ${b}`:"function"==typeof b&&b.name?a+=` Received function ${b.name}`:"object"==typeof b&&null!=b&&b.constructor?.name&&(a+=` Received an instance of ${b.constructor.name}`),a}let j0=(a,...b)=>j_("Key must be ",a,...b),j1=(a,b,...c)=>j_(`Key for the ${a} algorithm must be `,b,...c);function j2(a){if(!j3(a))throw Error("CryptoKey instance expected")}let j3=a=>{if(a?.[Symbol.toStringTag]==="CryptoKey")return!0;try{return a instanceof CryptoKey}catch{return!1}},j4=a=>a?.[Symbol.toStringTag]==="KeyObject",j5=a=>j3(a)||j4(a);async function j6(a,b,c,d,e){if(!(c instanceof Uint8Array))throw TypeError(j0(c,"Uint8Array"));let f=parseInt(a.slice(1,4),10),g=await crypto.subtle.importKey("raw",c.subarray(f>>3),"AES-CBC",!1,["encrypt"]),h=await crypto.subtle.importKey("raw",c.subarray(0,f>>3),{hash:`SHA-${f<<1}`,name:"HMAC"},!1,["sign"]),i=new Uint8Array(await crypto.subtle.encrypt({iv:d,name:"AES-CBC"},g,b)),j=jE(e,d,i,jG(e.length<<3));return{ciphertext:i,tag:new Uint8Array((await crypto.subtle.sign("HMAC",h,j)).slice(0,f>>3)),iv:d}}async function j7(a,b,c,d,e){let f;c instanceof Uint8Array?f=await crypto.subtle.importKey("raw",c,"AES-GCM",!1,["encrypt"]):(j$(c,a,"encrypt"),f=c);let g=new Uint8Array(await crypto.subtle.encrypt({additionalData:e,iv:d,name:"AES-GCM",tagLength:128},f,b)),h=g.slice(-16);return{ciphertext:g.slice(0,-16),tag:h,iv:d}}async function j8(a,b,c,d,e){if(!j3(c)&&!(c instanceof Uint8Array))throw TypeError(j0(c,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(d)jX(a,d);else d=crypto.getRandomValues(new Uint8Array(jW(a)>>3));switch(a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return c instanceof Uint8Array&&jY(c,parseInt(a.slice(-3),10)),j6(a,b,c,d,e);case"A128GCM":case"A192GCM":case"A256GCM":return c instanceof Uint8Array&&jY(c,parseInt(a.slice(1,4),10)),j7(a,b,c,d,e);default:throw new jQ("Unsupported JWE Content Encryption Algorithm")}}function j9(a,b){if(a.algorithm.length!==parseInt(b.slice(1,4),10))throw TypeError(`Invalid key size for alg: ${b}`)}function ka(a,b,c){return a instanceof Uint8Array?crypto.subtle.importKey("raw",a,"AES-KW",!0,[c]):(j$(a,b,c),a)}async function kb(a,b,c){let d=await ka(b,a,"wrapKey");j9(d,a);let e=await crypto.subtle.importKey("raw",c,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",e,d,"AES-KW"))}async function kc(a,b,c){let d=await ka(b,a,"unwrapKey");j9(d,a);let e=await crypto.subtle.unwrapKey("raw",c,d,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",e))}async function kd(a,b){let c=`SHA-${a.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(c,b))}function ke(a){return jE(jH(a.length),a)}async function kf(a,b,c){let d=b>>3,e=Math.ceil(d/32),f=new Uint8Array(32*e);for(let b=1;b<=e;b++){let d=new Uint8Array(4+a.length+c.length);d.set(jH(b),0),d.set(a,4),d.set(c,4+a.length);let e=await kd("sha256",d);f.set(e,(b-1)*32)}return f.slice(0,d)}async function kg(a,b,c,d,e=new Uint8Array,f=new Uint8Array){var g;j$(a,"ECDH"),j$(b,"ECDH","deriveBits");let h=jE(ke(jI(c)),ke(e),ke(f),jH(d),new Uint8Array);return kf(new Uint8Array(await crypto.subtle.deriveBits({name:a.algorithm.name,public:a},b,"X25519"===(g=a).algorithm.name?256:Math.ceil(parseInt(g.algorithm.namedCurve.slice(-3),10)/8)<<3)),d,h)}function kh(a){switch(a.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return"X25519"===a.algorithm.name}}async function ki(a,b,c,d){if(!(a instanceof Uint8Array)||a.length<8)throw new jS("PBES2 Salt Input must be 8 or more octets");let e=jE(jI(b),Uint8Array.of(0),a),f=parseInt(b.slice(13,16),10),g={hash:`SHA-${b.slice(8,11)}`,iterations:c,name:"PBKDF2",salt:e},h=await (d instanceof Uint8Array?crypto.subtle.importKey("raw",d,"PBKDF2",!1,["deriveBits"]):(j$(d,b,"deriveBits"),d));return new Uint8Array(await crypto.subtle.deriveBits(g,h,f))}async function kj(a,b,c,d=2048,e=crypto.getRandomValues(new Uint8Array(16))){let f=await ki(e,a,d,b);return{encryptedKey:await kb(a.slice(-6),f,c),p2c:d,p2s:jK(e)}}async function kk(a,b,c,d,e){let f=await ki(e,a,d,b);return kc(a.slice(-6),f,c)}function kl(a,b){if(a.startsWith("RS")||a.startsWith("PS")){let{modulusLength:c}=b.algorithm;if("number"!=typeof c||c<2048)throw TypeError(`${a} requires key modulusLength to be 2048 bits or larger`)}}let km=a=>{switch(a){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new jQ(`alg ${a} is not supported either by JOSE or your javascript runtime`)}};async function kn(a,b,c){return j$(b,a,"encrypt"),kl(a,b),new Uint8Array(await crypto.subtle.encrypt(km(a),b,c))}async function ko(a,b,c){return j$(b,a,"decrypt"),kl(a,b),new Uint8Array(await crypto.subtle.decrypt(km(a),b,c))}function kp(a){if("object"!=typeof a||null===a||"[object Object]"!==Object.prototype.toString.call(a))return!1;if(null===Object.getPrototypeOf(a))return!0;let b=a;for(;null!==Object.getPrototypeOf(b);)b=Object.getPrototypeOf(b);return Object.getPrototypeOf(a)===b}let kq=a=>kp(a)&&"string"==typeof a.kty;async function kr(a){if(!a.alg)throw TypeError('"alg" argument is required when "jwk.alg" is not present');let{algorithm:b,keyUsages:c}=function(a){let b,c;switch(a.kty){case"AKP":switch(a.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":b={name:a.alg},c=a.priv?["sign"]:["verify"];break;default:throw new jQ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"RSA":switch(a.alg){case"PS256":case"PS384":case"PS512":b={name:"RSA-PSS",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":b={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${a.alg.slice(-3)}`},c=a.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":b={name:"RSA-OAEP",hash:`SHA-${parseInt(a.alg.slice(-3),10)||1}`},c=a.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new jQ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"EC":switch(a.alg){case"ES256":b={name:"ECDSA",namedCurve:"P-256"},c=a.d?["sign"]:["verify"];break;case"ES384":b={name:"ECDSA",namedCurve:"P-384"},c=a.d?["sign"]:["verify"];break;case"ES512":b={name:"ECDSA",namedCurve:"P-521"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:"ECDH",namedCurve:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new jQ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;case"OKP":switch(a.alg){case"Ed25519":case"EdDSA":b={name:"Ed25519"},c=a.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":b={name:a.crv},c=a.d?["deriveBits"]:[];break;default:throw new jQ('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break;default:throw new jQ('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:b,keyUsages:c}}(a),d={...a};return"AKP"!==d.kty&&delete d.alg,delete d.use,crypto.subtle.importKey("jwk",d,b,a.ext??(!a.d&&!a.priv),a.key_ops??c)}let ks=async(a,b,c,d=!1)=>{let f=(e||=new WeakMap).get(a);if(f?.[c])return f[c];let g=await kr({...b,alg:c});return d&&Object.freeze(a),f?f[c]=g:e.set(a,{[c]:g}),g};async function kt(a,b){if(a instanceof Uint8Array||j3(a))return a;if(j4(a)){if("secret"===a.type)return a.export();if("toCryptoKey"in a&&"function"==typeof a.toCryptoKey)try{return((a,b)=>{let c,d=(e||=new WeakMap).get(a);if(d?.[b])return d[b];let f="public"===a.type,g=!!f;if("x25519"===a.asymmetricKeyType){switch(b){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}c=a.toCryptoKey(a.asymmetricKeyType,g,f?[]:["deriveBits"])}if("ed25519"===a.asymmetricKeyType){if("EdDSA"!==b&&"Ed25519"!==b)throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,g,[f?"verify":"sign"])}switch(a.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":if(b!==a.asymmetricKeyType.toUpperCase())throw TypeError("given KeyObject instance cannot be used for this algorithm");c=a.toCryptoKey(a.asymmetricKeyType,g,[f?"verify":"sign"])}if("rsa"===a.asymmetricKeyType){let d;switch(b){case"RSA-OAEP":d="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":d="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":d="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":d="SHA-512";break;default:throw TypeError("given KeyObject instance cannot be used for this algorithm")}if(b.startsWith("RSA-OAEP"))return a.toCryptoKey({name:"RSA-OAEP",hash:d},g,f?["encrypt"]:["decrypt"]);c=a.toCryptoKey({name:b.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:d},g,[f?"verify":"sign"])}if("ec"===a.asymmetricKeyType){let d=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(a.asymmetricKeyDetails?.namedCurve);if(!d)throw TypeError("given KeyObject instance cannot be used for this algorithm");"ES256"===b&&"P-256"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),"ES384"===b&&"P-384"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),"ES512"===b&&"P-521"===d&&(c=a.toCryptoKey({name:"ECDSA",namedCurve:d},g,[f?"verify":"sign"])),b.startsWith("ECDH-ES")&&(c=a.toCryptoKey({name:"ECDH",namedCurve:d},g,f?[]:["deriveBits"]))}if(!c)throw TypeError("given KeyObject instance cannot be used for this algorithm");return d?d[b]=c:e.set(a,{[b]:c}),c})(a,b)}catch(a){if(a instanceof TypeError)throw a}let c=a.export({format:"jwk"});return ks(a,c,b)}if(kq(a))return a.k?jJ(a.k):ks(a,a,b,!0);throw Error("unreachable")}function ku(a){switch(a){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new jQ(`Unsupported JWE Algorithm: ${a}`)}}let kv=a=>crypto.getRandomValues(new Uint8Array(ku(a)>>3));async function kw(a){if(j4(a))if("secret"!==a.type)return a.export({format:"jwk"});else a=a.export();if(a instanceof Uint8Array)return{kty:"oct",k:jK(a)};if(!j3(a))throw TypeError(j0(a,"CryptoKey","KeyObject","Uint8Array"));if(!a.extractable)throw TypeError("non-extractable CryptoKey cannot be exported as a JWK");let{ext:b,key_ops:c,alg:d,use:e,...f}=await crypto.subtle.exportKey("jwk",a);return"AKP"===f.kty&&(f.alg=d),f}async function kx(a){return kw(a)}async function ky(a,b){if(!(a instanceof Uint8Array))throw TypeError("First argument must be a buffer");if(!(b instanceof Uint8Array))throw TypeError("Second argument must be a buffer");let c={name:"HMAC",hash:"SHA-256"},d=await crypto.subtle.generateKey(c,!1,["sign"]),e=new Uint8Array(await crypto.subtle.sign(c,d,a)),f=new Uint8Array(await crypto.subtle.sign(c,d,b)),g=0,h=-1;for(;++h<32;)g|=e[h]^f[h];return 0===g}async function kz(a,b,c,d,e,f){let g,h;if(!(b instanceof Uint8Array))throw TypeError(j0(b,"Uint8Array"));let i=parseInt(a.slice(1,4),10),j=await crypto.subtle.importKey("raw",b.subarray(i>>3),"AES-CBC",!1,["decrypt"]),k=await crypto.subtle.importKey("raw",b.subarray(0,i>>3),{hash:`SHA-${i<<1}`,name:"HMAC"},!1,["sign"]),l=jE(f,d,c,jG(f.length<<3)),m=new Uint8Array((await crypto.subtle.sign("HMAC",k,l)).slice(0,i>>3));try{g=await ky(e,m)}catch{}if(!g)throw new jR;try{h=new Uint8Array(await crypto.subtle.decrypt({iv:d,name:"AES-CBC"},j,c))}catch{}if(!h)throw new jR;return h}async function kA(a,b,c,d,e,f){let g;b instanceof Uint8Array?g=await crypto.subtle.importKey("raw",b,"AES-GCM",!1,["decrypt"]):(j$(b,a,"decrypt"),g=b);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:f,iv:d,name:"AES-GCM",tagLength:128},g,jE(c,e)))}catch{throw new jR}}async function kB(a,b,c,d,e,f){if(!j3(b)&&!(b instanceof Uint8Array))throw TypeError(j0(b,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!d)throw new jS("JWE Initialization Vector missing");if(!e)throw new jS("JWE Authentication Tag missing");switch(jX(a,d),a){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return b instanceof Uint8Array&&jY(b,parseInt(a.slice(-3),10)),kz(a,b,c,d,e,f);case"A128GCM":case"A192GCM":case"A256GCM":return b instanceof Uint8Array&&jY(b,parseInt(a.slice(1,4),10)),kA(a,b,c,d,e,f);default:throw new jQ("Unsupported JWE Content Encryption Algorithm")}}async function kC(a,b,c,d){let e=a.slice(0,7),f=await j8(e,c,b,d,new Uint8Array);return{encryptedKey:f.ciphertext,iv:jK(f.iv),tag:jK(f.tag)}}async function kD(a,b,c,d,e){return kB(a.slice(0,7),b,c,d,e,new Uint8Array)}async function kE(a,b,c,d,e={}){let f,g,h;switch(a){case"dir":h=c;break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let i;if(j2(c),!kh(c))throw new jQ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let{apu:j,apv:k}=e;i=e.epk?await kt(e.epk,a):(await crypto.subtle.generateKey(c.algorithm,!0,["deriveBits"])).privateKey;let{x:l,y:m,crv:n,kty:o}=await kx(i),p=await kg(c,i,"ECDH-ES"===a?b:a,"ECDH-ES"===a?ku(b):parseInt(a.slice(-5,-2),10),j,k);if(g={epk:{x:l,crv:n,kty:o}},"EC"===o&&(g.epk.y=m),j&&(g.apu=jK(j)),k&&(g.apv=jK(k)),"ECDH-ES"===a){h=p;break}h=d||kv(b);let q=a.slice(-6);f=await kb(q,p,h);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":h=d||kv(b),j2(c),f=await kn(a,c,h);break;case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{h=d||kv(b);let{p2c:i,p2s:j}=e;({encryptedKey:f,...g}=await kj(a,c,h,i,j));break}case"A128KW":case"A192KW":case"A256KW":h=d||kv(b),f=await kb(a,c,h);break;case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{h=d||kv(b);let{iv:i}=e;({encryptedKey:f,...g}=await kC(a,c,h,i));break}default:throw new jQ('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:h,encryptedKey:f,parameters:g}}function kF(...a){let b,c=a.filter(Boolean);if(0===c.length||1===c.length)return!0;for(let a of c){let c=Object.keys(a);if(!b||0===b.size){b=new Set(c);continue}for(let a of c){if(b.has(a))return!1;b.add(a)}}return!0}function kG(a,b,c,d,e){let f;if(void 0!==e.crit&&d?.crit===void 0)throw new a('"crit" (Critical) Header Parameter MUST be integrity protected');if(!d||void 0===d.crit)return new Set;if(!Array.isArray(d.crit)||0===d.crit.length||d.crit.some(a=>"string"!=typeof a||0===a.length))throw new a('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');for(let g of(f=void 0!==c?new Map([...Object.entries(c),...b.entries()]):b,d.crit)){if(!f.has(g))throw new jQ(`Extension Header Parameter "${g}" is not recognized`);if(void 0===e[g])throw new a(`Extension Header Parameter "${g}" is missing`);if(f.get(g)&&void 0===d[g])throw new a(`Extension Header Parameter "${g}" MUST be integrity protected`)}return new Set(d.crit)}let kH=a=>a?.[Symbol.toStringTag],kI=(a,b,c)=>{if(void 0!==b.use){let a;switch(c){case"sign":case"verify":a="sig";break;case"encrypt":case"decrypt":a="enc"}if(b.use!==a)throw TypeError(`Invalid key for this operation, its "use" must be "${a}" when present`)}if(void 0!==b.alg&&b.alg!==a)throw TypeError(`Invalid key for this operation, its "alg" must be "${a}" when present`);if(Array.isArray(b.key_ops)){let d;switch(!0){case"sign"===c||"verify"===c:case"dir"===a:case a.includes("CBC-HS"):d=c;break;case a.startsWith("PBES2"):d="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(a):d=!a.includes("GCM")&&a.endsWith("KW")?"encrypt"===c?"wrapKey":"unwrapKey":c;break;case"encrypt"===c&&a.startsWith("RSA"):d="wrapKey";break;case"decrypt"===c:d=a.startsWith("RSA")?"unwrapKey":"deriveBits"}if(d&&b.key_ops?.includes?.(d)===!1)throw TypeError(`Invalid key for this operation, its "key_ops" must include "${d}" when present`)}return!0};function kJ(a,b,c){switch(a.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":((a,b,c)=>{if(!(b instanceof Uint8Array)){if(kq(b)){if("oct"===b.kty&&"string"==typeof b.k&&kI(a,b,c))return;throw TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!j5(b))throw TypeError(j1(a,b,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if("secret"!==b.type)throw TypeError(`${kH(b)} instances for symmetric algorithms must be of type "secret"`)}})(a,b,c);break;default:((a,b,c)=>{if(kq(b))switch(c){case"decrypt":case"sign":if("oct"!==b.kty&&("AKP"===b.kty&&"string"==typeof b.priv||"string"==typeof b.d)&&kI(a,b,c))return;throw TypeError("JSON Web Key for this operation must be a private JWK");case"encrypt":case"verify":if("oct"!==b.kty&&void 0===b.d&&void 0===b.priv&&kI(a,b,c))return;throw TypeError("JSON Web Key for this operation must be a public JWK")}if(!j5(b))throw TypeError(j1(a,b,"CryptoKey","KeyObject","JSON Web Key"));if("secret"===b.type)throw TypeError(`${kH(b)} instances for asymmetric algorithms must not be of type "secret"`);if("public"===b.type)switch(c){case"sign":throw TypeError(`${kH(b)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw TypeError(`${kH(b)} instances for asymmetric algorithm decryption must be of type "private"`)}if("private"===b.type)switch(c){case"verify":throw TypeError(`${kH(b)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw TypeError(`${kH(b)} instances for asymmetric algorithm encryption must be of type "public"`)}})(a,b,c)}}class kK{#a;#b;#c;#d;#e;#f;#g;#h;constructor(a){if(!(a instanceof Uint8Array))throw TypeError("plaintext must be an instance of Uint8Array");this.#a=a}setKeyManagementParameters(a){if(this.#h)throw TypeError("setKeyManagementParameters can only be called once");return this.#h=a,this}setProtectedHeader(a){if(this.#b)throw TypeError("setProtectedHeader can only be called once");return this.#b=a,this}setSharedUnprotectedHeader(a){if(this.#c)throw TypeError("setSharedUnprotectedHeader can only be called once");return this.#c=a,this}setUnprotectedHeader(a){if(this.#d)throw TypeError("setUnprotectedHeader can only be called once");return this.#d=a,this}setAdditionalAuthenticatedData(a){return this.#e=a,this}setContentEncryptionKey(a){if(this.#f)throw TypeError("setContentEncryptionKey can only be called once");return this.#f=a,this}setInitializationVector(a){if(this.#g)throw TypeError("setInitializationVector can only be called once");return this.#g=a,this}async encrypt(a,b){let c,d,e,f,g,h;if(!this.#b&&!this.#d&&!this.#c)throw new jS("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!kF(this.#b,this.#d,this.#c))throw new jS("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");let i={...this.#b,...this.#d,...this.#c};if(kG(jS,new Map,b?.crit,this.#b,i),void 0!==i.zip)throw new jQ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:j,enc:k}=i;if("string"!=typeof j||!j)throw new jS('JWE "alg" (Algorithm) Header Parameter missing or invalid');if("string"!=typeof k||!k)throw new jS('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');if(this.#f&&("dir"===j||"ECDH-ES"===j))throw TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${j}`);kJ("dir"===j?k:j,a,"encrypt");{let e,f=await kt(a,j);({cek:d,encryptedKey:c,parameters:e}=await kE(j,k,f,this.#f,this.#h)),e&&(b&&jL in b?this.#d?this.#d={...this.#d,...e}:this.setUnprotectedHeader(e):this.#b?this.#b={...this.#b,...e}:this.setProtectedHeader(e))}if(this.#b?g=jI(f=jK(JSON.stringify(this.#b))):(f="",g=new Uint8Array),this.#e){let a=jI(h=jK(this.#e));e=jE(g,jI("."),a)}else e=g;let{ciphertext:l,tag:m,iv:n}=await j8(k,this.#a,d,this.#g,e),o={ciphertext:jK(l)};return n&&(o.iv=jK(n)),m&&(o.tag=jK(m)),c&&(o.encrypted_key=jK(c)),h&&(o.aad=h),this.#b&&(o.protected=f),this.#c&&(o.unprotected=this.#c),this.#d&&(o.header=this.#d),o}}class kL{#i;constructor(a){this.#i=new kK(a)}setContentEncryptionKey(a){return this.#i.setContentEncryptionKey(a),this}setInitializationVector(a){return this.#i.setInitializationVector(a),this}setProtectedHeader(a){return this.#i.setProtectedHeader(a),this}setKeyManagementParameters(a){return this.#i.setKeyManagementParameters(a),this}async encrypt(a,b){let c=await this.#i.encrypt(a,b);return[c.protected,c.encrypted_key,c.iv,c.ciphertext,c.tag].join(".")}}let kM=a=>Math.floor(a.getTime()/1e3),kN=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function kO(a){let b,c=kN.exec(a);if(!c||c[4]&&c[1])throw TypeError("Invalid time period format");let d=parseFloat(c[2]);switch(c[3].toLowerCase()){case"sec":case"secs":case"second":case"seconds":case"s":b=Math.round(d);break;case"minute":case"minutes":case"min":case"mins":case"m":b=Math.round(60*d);break;case"hour":case"hours":case"hr":case"hrs":case"h":b=Math.round(3600*d);break;case"day":case"days":case"d":b=Math.round(86400*d);break;case"week":case"weeks":case"w":b=Math.round(604800*d);break;default:b=Math.round(0x1e187e0*d)}return"-"===c[1]||"ago"===c[4]?-b:b}function kP(a,b){if(!Number.isFinite(b))throw TypeError(`Invalid ${a} input`);return b}let kQ=a=>a.includes("/")?a.toLowerCase():`application/${a.toLowerCase()}`;class kR{#j;constructor(a){if(!kp(a))throw TypeError("JWT Claims Set MUST be an object");this.#j=structuredClone(a)}data(){return jC.encode(JSON.stringify(this.#j))}get iss(){return this.#j.iss}set iss(a){this.#j.iss=a}get sub(){return this.#j.sub}set sub(a){this.#j.sub=a}get aud(){return this.#j.aud}set aud(a){this.#j.aud=a}set jti(a){this.#j.jti=a}set nbf(a){"number"==typeof a?this.#j.nbf=kP("setNotBefore",a):a instanceof Date?this.#j.nbf=kP("setNotBefore",kM(a)):this.#j.nbf=kM(new Date)+kO(a)}set exp(a){"number"==typeof a?this.#j.exp=kP("setExpirationTime",a):a instanceof Date?this.#j.exp=kP("setExpirationTime",kM(a)):this.#j.exp=kM(new Date)+kO(a)}set iat(a){void 0===a?this.#j.iat=kM(new Date):a instanceof Date?this.#j.iat=kP("setIssuedAt",kM(a)):"string"==typeof a?this.#j.iat=kP("setIssuedAt",kM(new Date)+kO(a)):this.#j.iat=kP("setIssuedAt",a)}}class kS{#f;#g;#h;#b;#k;#l;#m;#n;constructor(a={}){this.#n=new kR(a)}setIssuer(a){return this.#n.iss=a,this}setSubject(a){return this.#n.sub=a,this}setAudience(a){return this.#n.aud=a,this}setJti(a){return this.#n.jti=a,this}setNotBefore(a){return this.#n.nbf=a,this}setExpirationTime(a){return this.#n.exp=a,this}setIssuedAt(a){return this.#n.iat=a,this}setProtectedHeader(a){if(this.#b)throw TypeError("setProtectedHeader can only be called once");return this.#b=a,this}setKeyManagementParameters(a){if(this.#h)throw TypeError("setKeyManagementParameters can only be called once");return this.#h=a,this}setContentEncryptionKey(a){if(this.#f)throw TypeError("setContentEncryptionKey can only be called once");return this.#f=a,this}setInitializationVector(a){if(this.#g)throw TypeError("setInitializationVector can only be called once");return this.#g=a,this}replicateIssuerAsHeader(){return this.#k=!0,this}replicateSubjectAsHeader(){return this.#l=!0,this}replicateAudienceAsHeader(){return this.#m=!0,this}async encrypt(a,b){let c=new kL(this.#n.data());return this.#b&&(this.#k||this.#l||this.#m)&&(this.#b={...this.#b,iss:this.#k?this.#n.iss:void 0,sub:this.#l?this.#n.sub:void 0,aud:this.#m?this.#n.aud:void 0}),c.setProtectedHeader(this.#b),this.#g&&c.setInitializationVector(this.#g),this.#f&&c.setContentEncryptionKey(this.#f),this.#h&&c.setKeyManagementParameters(this.#h),c.encrypt(a,b)}}var kT=a.i(76340),kT=kT;let kU=(a,b)=>{if("string"!=typeof a||!a)throw new jU(`${b} missing or invalid`)};async function kV(a,b){let c,d;if(kq(a))c=a;else if(j5(a))c=await kx(a);else throw TypeError(j0(a,"CryptoKey","KeyObject","JSON Web Key"));if("sha256"!==(b??="sha256")&&"sha384"!==b&&"sha512"!==b)throw TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');switch(c.kty){case"AKP":kU(c.alg,'"alg" (Algorithm) Parameter'),kU(c.pub,'"pub" (Public key) Parameter'),d={alg:c.alg,kty:c.kty,pub:c.pub};break;case"EC":kU(c.crv,'"crv" (Curve) Parameter'),kU(c.x,'"x" (X Coordinate) Parameter'),kU(c.y,'"y" (Y Coordinate) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x,y:c.y};break;case"OKP":kU(c.crv,'"crv" (Subtype of Key Pair) Parameter'),kU(c.x,'"x" (Public Key) Parameter'),d={crv:c.crv,kty:c.kty,x:c.x};break;case"RSA":kU(c.e,'"e" (Exponent) Parameter'),kU(c.n,'"n" (Modulus) Parameter'),d={e:c.e,kty:c.kty,n:c.n};break;case"oct":kU(c.k,'"k" (Key Value) Parameter'),d={k:c.k,kty:c.kty};break;default:throw new jQ('"kty" (Key Type) Parameter missing or unsupported')}let e=jI(JSON.stringify(d));return jK(await kd(b,e))}async function kW(a,b,c){let d;if(!kp(a))throw TypeError("JWK must be an object");switch(b??=a.alg,d??=c?.extractable??a.ext,a.kty){case"oct":if("string"!=typeof a.k||!a.k)throw TypeError('missing "k" (Key Value) Parameter value');return jJ(a.k);case"RSA":if("oth"in a&&void 0!==a.oth)throw new jQ('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return kr({...a,alg:b,ext:d});case"AKP":if("string"!=typeof a.alg||!a.alg)throw TypeError('missing "alg" (Algorithm) Parameter value');if(void 0!==b&&b!==a.alg)throw TypeError("JWK alg and alg option value mismatch");return kr({...a,ext:d});case"EC":case"OKP":return kr({...a,alg:b,ext:d});default:throw new jQ('Unsupported "kty" (Key Type) Parameter value')}}async function kX(a,b,c,d,e){switch(a){case"dir":if(void 0!==c)throw new jS("Encountered unexpected JWE Encrypted Key");return b;case"ECDH-ES":if(void 0!==c)throw new jS("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{let e,f;if(!kp(d.epk))throw new jS('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(j2(b),!kh(b))throw new jQ("ECDH with the provided key is not allowed or not supported by your javascript runtime");let g=await kW(d.epk,a);if(j2(g),void 0!==d.apu){if("string"!=typeof d.apu)throw new jS('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{e=jJ(d.apu)}catch{throw new jS("Failed to base64url decode the apu")}}if(void 0!==d.apv){if("string"!=typeof d.apv)throw new jS('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{f=jJ(d.apv)}catch{throw new jS("Failed to base64url decode the apv")}}let h=await kg(g,b,"ECDH-ES"===a?d.enc:a,"ECDH-ES"===a?ku(d.enc):parseInt(a.slice(-5,-2),10),e,f);if("ECDH-ES"===a)return h;if(void 0===c)throw new jS("JWE Encrypted Key missing");return kc(a.slice(-6),h,c)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":if(void 0===c)throw new jS("JWE Encrypted Key missing");return j2(b),ko(a,b,c);case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{let f;if(void 0===c)throw new jS("JWE Encrypted Key missing");if("number"!=typeof d.p2c)throw new jS('JOSE Header "p2c" (PBES2 Count) missing or invalid');let g=e?.maxPBES2Count||1e4;if(d.p2c>g)throw new jS('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if("string"!=typeof d.p2s)throw new jS('JOSE Header "p2s" (PBES2 Salt) missing or invalid');try{f=jJ(d.p2s)}catch{throw new jS("Failed to base64url decode the p2s")}return kk(a,b,c,d.p2c,f)}case"A128KW":case"A192KW":case"A256KW":if(void 0===c)throw new jS("JWE Encrypted Key missing");return kc(a,b,c);case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{let e,f;if(void 0===c)throw new jS("JWE Encrypted Key missing");if("string"!=typeof d.iv)throw new jS('JOSE Header "iv" (Initialization Vector) missing or invalid');if("string"!=typeof d.tag)throw new jS('JOSE Header "tag" (Authentication Tag) missing or invalid');try{e=jJ(d.iv)}catch{throw new jS("Failed to base64url decode the iv")}try{f=jJ(d.tag)}catch{throw new jS("Failed to base64url decode the tag")}return kD(a,b,c,e,f)}default:throw new jQ('Invalid or unsupported "alg" (JWE Algorithm) header value')}}function kY(a,b){if(void 0!==b&&(!Array.isArray(b)||b.some(a=>"string"!=typeof a)))throw TypeError(`"${a}" option must be an array of strings`);if(b)return new Set(b)}async function kZ(a,b,c){let d,e,f,g,h,i,j;if(!kp(a))throw new jS("Flattened JWE must be an object");if(void 0===a.protected&&void 0===a.header&&void 0===a.unprotected)throw new jS("JOSE Header missing");if(void 0!==a.iv&&"string"!=typeof a.iv)throw new jS("JWE Initialization Vector incorrect type");if("string"!=typeof a.ciphertext)throw new jS("JWE Ciphertext missing or incorrect type");if(void 0!==a.tag&&"string"!=typeof a.tag)throw new jS("JWE Authentication Tag incorrect type");if(void 0!==a.protected&&"string"!=typeof a.protected)throw new jS("JWE Protected Header incorrect type");if(void 0!==a.encrypted_key&&"string"!=typeof a.encrypted_key)throw new jS("JWE Encrypted Key incorrect type");if(void 0!==a.aad&&"string"!=typeof a.aad)throw new jS("JWE AAD incorrect type");if(void 0!==a.header&&!kp(a.header))throw new jS("JWE Shared Unprotected Header incorrect type");if(void 0!==a.unprotected&&!kp(a.unprotected))throw new jS("JWE Per-Recipient Unprotected Header incorrect type");if(a.protected)try{let b=jJ(a.protected);d=JSON.parse(jD.decode(b))}catch{throw new jS("JWE Protected Header is invalid")}if(!kF(d,a.header,a.unprotected))throw new jS("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");let k={...d,...a.header,...a.unprotected};if(kG(jS,new Map,c?.crit,d,k),void 0!==k.zip)throw new jQ('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');let{alg:l,enc:m}=k;if("string"!=typeof l||!l)throw new jS("missing JWE Algorithm (alg) in JWE Header");if("string"!=typeof m||!m)throw new jS("missing JWE Encryption Algorithm (enc) in JWE Header");let n=c&&kY("keyManagementAlgorithms",c.keyManagementAlgorithms),o=c&&kY("contentEncryptionAlgorithms",c.contentEncryptionAlgorithms);if(n&&!n.has(l)||!n&&l.startsWith("PBES2"))throw new jP('"alg" (Algorithm) Header Parameter value not allowed');if(o&&!o.has(m))throw new jP('"enc" (Encryption Algorithm) Header Parameter value not allowed');if(void 0!==a.encrypted_key)try{e=jJ(a.encrypted_key)}catch{throw new jS("Failed to base64url decode the encrypted_key")}let p=!1;"function"==typeof b&&(b=await b(d,a),p=!0),kJ("dir"===l?m:l,b,"decrypt");let q=await kt(b,l);try{f=await kX(l,q,e,k,c)}catch(a){if(a instanceof TypeError||a instanceof jS||a instanceof jQ)throw a;f=kv(m)}if(void 0!==a.iv)try{g=jJ(a.iv)}catch{throw new jS("Failed to base64url decode the iv")}if(void 0!==a.tag)try{h=jJ(a.tag)}catch{throw new jS("Failed to base64url decode the tag")}let r=void 0!==a.protected?jI(a.protected):new Uint8Array;i=void 0!==a.aad?jE(r,jI("."),jI(a.aad)):r;try{j=jJ(a.ciphertext)}catch{throw new jS("Failed to base64url decode the ciphertext")}let s={plaintext:await kB(m,f,j,g,h,i)};if(void 0!==a.protected&&(s.protectedHeader=d),void 0!==a.aad)try{s.additionalAuthenticatedData=jJ(a.aad)}catch{throw new jS("Failed to base64url decode the aad")}return(void 0!==a.unprotected&&(s.sharedUnprotectedHeader=a.unprotected),void 0!==a.header&&(s.unprotectedHeader=a.header),p)?{...s,key:q}:s}async function k$(a,b,c){if(a instanceof Uint8Array&&(a=jD.decode(a)),"string"!=typeof a)throw new jS("Compact JWE must be a string or Uint8Array");let{0:d,1:e,2:f,3:g,4:h,length:i}=a.split(".");if(5!==i)throw new jS("Invalid Compact JWE");let j=await kZ({ciphertext:g,iv:f||void 0,protected:d,tag:h||void 0,encrypted_key:e||void 0},b,c),k={plaintext:j.plaintext,protectedHeader:j.protectedHeader};return"function"==typeof b?{...k,key:j.key}:k}async function k_(a,b,c){let d=await k$(a,b,c),e=function(a,b,c={}){var d,e;let f,g;try{f=JSON.parse(jD.decode(b))}catch{}if(!kp(f))throw new jT("JWT Claims Set must be a top-level JSON object");let{typ:h}=c;if(h&&("string"!=typeof a.typ||kQ(a.typ)!==kQ(h)))throw new jN('unexpected "typ" JWT header value',f,"typ","check_failed");let{requiredClaims:i=[],issuer:j,subject:k,audience:l,maxTokenAge:m}=c,n=[...i];for(let a of(void 0!==m&&n.push("iat"),void 0!==l&&n.push("aud"),void 0!==k&&n.push("sub"),void 0!==j&&n.push("iss"),new Set(n.reverse())))if(!(a in f))throw new jN(`missing required "${a}" claim`,f,a,"missing");if(j&&!(Array.isArray(j)?j:[j]).includes(f.iss))throw new jN('unexpected "iss" claim value',f,"iss","check_failed");if(k&&f.sub!==k)throw new jN('unexpected "sub" claim value',f,"sub","check_failed");if(l&&(d=f.aud,e="string"==typeof l?[l]:l,"string"==typeof d?!e.includes(d):!(Array.isArray(d)&&e.some(Set.prototype.has.bind(new Set(d))))))throw new jN('unexpected "aud" claim value',f,"aud","check_failed");switch(typeof c.clockTolerance){case"string":g=kO(c.clockTolerance);break;case"number":g=c.clockTolerance;break;case"undefined":g=0;break;default:throw TypeError("Invalid clockTolerance option type")}let{currentDate:o}=c,p=kM(o||new Date);if((void 0!==f.iat||m)&&"number"!=typeof f.iat)throw new jN('"iat" claim must be a number',f,"iat","invalid");if(void 0!==f.nbf){if("number"!=typeof f.nbf)throw new jN('"nbf" claim must be a number',f,"nbf","invalid");if(f.nbf>p+g)throw new jN('"nbf" claim timestamp check failed',f,"nbf","check_failed")}if(void 0!==f.exp){if("number"!=typeof f.exp)throw new jN('"exp" claim must be a number',f,"exp","invalid");if(f.exp<=p-g)throw new jO('"exp" claim timestamp check failed',f,"exp","check_failed")}if(m){let a=p-f.iat;if(a-g>("number"==typeof m?m:kO(m)))throw new jO('"iat" claim timestamp check failed (too far in the past)',f,"iat","check_failed");if(a<0-g)throw new jN('"iat" claim timestamp check failed (it should be in the past)',f,"iat","check_failed")}return f}(d.protectedHeader,d.plaintext,c),{protectedHeader:f}=d;if(void 0!==f.iss&&f.iss!==e.iss)throw new jN('replicated "iss" claim header parameter mismatch',e,"iss","mismatch");if(void 0!==f.sub&&f.sub!==e.sub)throw new jN('replicated "sub" claim header parameter mismatch',e,"sub","mismatch");if(void 0!==f.aud&&JSON.stringify(f.aud)!==JSON.stringify(e.aud))throw new jN('replicated "aud" claim header parameter mismatch',e,"aud","mismatch");let g={payload:e,protectedHeader:f};return"function"==typeof b?{...g,key:d.key}:g}let k0=/^[!#$%&'*+\-.^_`|~0-9A-Za-z]+$/,k1=/^("?)[\u0021\u0023-\u002B\u002D-\u003A\u003C-\u005B\u005D-\u007E]*\1$/,k2=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,k3=/^[\u0020-\u003A\u003D-\u007E]*$/,k4=Object.prototype.toString,k5=((i=function(){}).prototype=Object.create(null),i);function k6(a,b){let c=new k5,d=a.length;if(d<2)return c;let e=b?.decode||la,f=0;do{let b=a.indexOf("=",f);if(-1===b)break;let g=a.indexOf(";",f),h=-1===g?d:g;if(b>h){f=a.lastIndexOf(";",b-1)+1;continue}let i=k7(a,f,b),j=k8(a,b,i),k=a.slice(i,j);if(void 0===c[k]){let d=k7(a,b+1,h),f=k8(a,h,d),g=e(a.slice(d,f));c[k]=g}f=h+1}while(f<d)return c}function k7(a,b,c){do{let c=a.charCodeAt(b);if(32!==c&&9!==c)return b}while(++b<c)return c}function k8(a,b,c){for(;b>c;){let c=a.charCodeAt(--b);if(32!==c&&9!==c)return b+1}return c}function k9(a,b,c){let d=c?.encode||encodeURIComponent;if(!k0.test(a))throw TypeError(`argument name is invalid: ${a}`);let e=d(b);if(!k1.test(e))throw TypeError(`argument val is invalid: ${b}`);let f=a+"="+e;if(!c)return f;if(void 0!==c.maxAge){if(!Number.isInteger(c.maxAge))throw TypeError(`option maxAge is invalid: ${c.maxAge}`);f+="; Max-Age="+c.maxAge}if(c.domain){if(!k2.test(c.domain))throw TypeError(`option domain is invalid: ${c.domain}`);f+="; Domain="+c.domain}if(c.path){if(!k3.test(c.path))throw TypeError(`option path is invalid: ${c.path}`);f+="; Path="+c.path}if(c.expires){var g;if(g=c.expires,"[object Date]"!==k4.call(g)||!Number.isFinite(c.expires.valueOf()))throw TypeError(`option expires is invalid: ${c.expires}`);f+="; Expires="+c.expires.toUTCString()}if(c.httpOnly&&(f+="; HttpOnly"),c.secure&&(f+="; Secure"),c.partitioned&&(f+="; Partitioned"),c.priority)switch("string"==typeof c.priority?c.priority.toLowerCase():void 0){case"low":f+="; Priority=Low";break;case"medium":f+="; Priority=Medium";break;case"high":f+="; Priority=High";break;default:throw TypeError(`option priority is invalid: ${c.priority}`)}if(c.sameSite)switch("string"==typeof c.sameSite?c.sameSite.toLowerCase():c.sameSite){case!0:case"strict":f+="; SameSite=Strict";break;case"lax":f+="; SameSite=Lax";break;case"none":f+="; SameSite=None";break;default:throw TypeError(`option sameSite is invalid: ${c.sameSite}`)}return f}function la(a){if(-1===a.indexOf("%"))return a;try{return decodeURIComponent(a)}catch(b){return a}}a.s(["parse",()=>k6,"serialize",()=>k9],59050);var lb=a.i(59050);let{parse:lc}=lb,ld="A256CBC-HS512";async function le(a){let{token:b={},secret:c,maxAge:d=2592e3,salt:e}=a,f=Array.isArray(c)?c:[c],g=await lg(ld,f[0],e),h=await kV({kty:"oct",k:kT.encode(g)},`sha${g.byteLength<<3}`);return await new kS(b).setProtectedHeader({alg:"dir",enc:ld,kid:h}).setIssuedAt().setExpirationTime((Date.now()/1e3|0)+d).setJti(crypto.randomUUID()).encrypt(g)}async function lf(a){let{token:b,secret:c,salt:d}=a,e=Array.isArray(c)?c:[c];if(!b)return null;let{payload:f}=await k_(b,async({kid:a,enc:b})=>{for(let c of e){let e=await lg(b,c,d);if(void 0===a||a===await kV({kty:"oct",k:kT.encode(e)},`sha${e.byteLength<<3}`))return e}throw Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:["dir"],contentEncryptionAlgorithms:[ld,"A256GCM"]});return f}async function lg(a,b,c){let d;switch(a){case"A256CBC-HS512":d=64;break;case"A256GCM":d=32;break;default:throw Error("Unsupported JWT Content Encryption Algorithm")}return await jB("sha256",b,c,`Auth.js Generated Encryption Key (${c})`,d)}async function lh({options:a,paramValue:b,cookieValue:c}){let{url:d,callbacks:e}=a,f=d.origin;return b?f=await e.redirect({url:b,baseUrl:d.origin}):c&&(f=await e.redirect({url:c,baseUrl:d.origin})),{callbackUrl:f,callbackUrlCookie:f!==c?f:void 0}}let li="\x1b[31m",lj="\x1b[0m",lk={error(a){let b=a instanceof iW?a.type:a.name;if(console.error(`${li}[auth][error]${lj} ${b}: ${a.message}`),a.cause&&"object"==typeof a.cause&&"err"in a.cause&&a.cause.err instanceof Error){let{err:b,...c}=a.cause;console.error(`${li}[auth][cause]${lj}:`,b.stack),c&&console.error(`${li}[auth][details]${lj}:`,JSON.stringify(c,null,2))}else a.stack&&console.error(a.stack.replace(/.*/,"").substring(1))},warn(a){console.warn(`\x1b[33m[auth][warn][${a}]${lj}`,"Read more: https://warnings.authjs.dev")},debug(a,b){console.log(`\x1b[90m[auth][debug]:${lj} ${a}`,JSON.stringify(b,null,2))}};function ll(a){let b={...lk};return a.debug||(b.debug=()=>{}),a.logger?.error&&(b.error=a.logger.error),a.logger?.warn&&(b.warn=a.logger.warn),a.logger?.debug&&(b.debug=a.logger.debug),a.logger??(a.logger=b),b}let lm=["providers","session","csrf","signin","signout","callback","verify-request","error","webauthn-options"],{parse:ln,serialize:lo}=lb;async function lp(a){if(!("body"in a)||!a.body||"POST"!==a.method)return;let b=a.headers.get("content-type");return b?.includes("application/json")?await a.json():b?.includes("application/x-www-form-urlencoded")?Object.fromEntries(new URLSearchParams(await a.text())):void 0}async function lq(a,b){try{if("GET"!==a.method&&"POST"!==a.method)throw new jf("Only GET and POST requests are supported");b.basePath??(b.basePath="/auth");let c=new URL(a.url),{action:d,providerId:e}=function(a,b){let c=a.match(RegExp(`^${b}(.+)`));if(null===c)throw new jf(`Cannot parse action at ${a}`);let d=c.at(-1).replace(/^\//,"").split("/").filter(Boolean);if(1!==d.length&&2!==d.length)throw new jf(`Cannot parse action at ${a}`);let[e,f]=d;if(!lm.includes(e)||f&&!["signin","callback","webauthn-options"].includes(e))throw new jf(`Cannot parse action at ${a}`);return{action:e,providerId:"undefined"==f?void 0:f}}(c.pathname,b.basePath);return{url:c,action:d,providerId:e,method:a.method,headers:Object.fromEntries(a.headers),body:a.body?await lp(a):void 0,cookies:ln(a.headers.get("cookie")??"")??{},error:c.searchParams.get("error")??void 0,query:Object.fromEntries(c.searchParams)}}catch(d){let c=ll(b);c.error(d),c.debug("request",a)}}function lr(a){let b=new Headers(a.headers);a.cookies?.forEach(a=>{let{name:c,value:d,options:e}=a,f=lo(c,d,e);b.has("Set-Cookie")?b.append("Set-Cookie",f):b.set("Set-Cookie",f)});let c=a.body;"application/json"===b.get("content-type")?c=JSON.stringify(a.body):"application/x-www-form-urlencoded"===b.get("content-type")&&(c=new URLSearchParams(a.body).toString());let d=new Response(c,{headers:b,status:a.redirect?302:a.status??200});return a.redirect&&d.headers.set("Location",a.redirect),d}async function ls(a){let b=new TextEncoder().encode(a);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",b))).map(a=>a.toString(16).padStart(2,"0")).join("").toString()}function lt(a){return Array.from(crypto.getRandomValues(new Uint8Array(a))).reduce((a,b)=>a+("0"+b.toString(16)).slice(-2),"")}async function lu({options:a,cookieValue:b,isPost:c,bodyValue:d}){if(b){let[e,f]=b.split("|");if(f===await ls(`${e}${a.secret}`))return{csrfTokenVerified:c&&e===d,csrfToken:e}}let e=lt(32),f=await ls(`${e}${a.secret}`);return{cookie:`${e}|${f}`,csrfToken:e}}function lv(a,b){if(!b)throw new jk(`CSRF token was missing during an action ${a}`)}function lw(a){return null!==a&&"object"==typeof a}function lx(a,...b){if(!b.length)return a;let c=b.shift();if(lw(a)&&lw(c))for(let b in c)lw(c[b])?(lw(a[b])||(a[b]=Array.isArray(c[b])?[]:{}),lx(a[b],c[b])):void 0!==c[b]&&(a[b]=c[b]);return lx(a,...b)}let ly=Symbol("skip-csrf-check"),lz=Symbol("return-type-raw"),lA=Symbol("custom-fetch"),lB=Symbol("conform-internal"),lC=a=>lE({id:a.sub??a.id??crypto.randomUUID(),name:a.name??a.nickname??a.preferred_username,email:a.email,image:a.picture}),lD=a=>lE({access_token:a.access_token,id_token:a.id_token,refresh_token:a.refresh_token,expires_at:a.expires_at,scope:a.scope,token_type:a.token_type,session_state:a.session_state});function lE(a){let b={};for(let[c,d]of Object.entries(a))void 0!==d&&(b[c]=d);return b}function lF(a,b){if(!a&&b)return;if("string"==typeof a)return{url:new URL(a)};let c=new URL(a?.url??"https://authjs.dev");if(a?.params!=null)for(let[b,d]of Object.entries(a.params))"claims"===b&&(d=JSON.stringify(d)),c.searchParams.set(b,String(d));return{url:c,request:a?.request,conform:a?.conform,...a?.clientPrivateKey?{clientPrivateKey:a?.clientPrivateKey}:null}}let lG={signIn:()=>!0,redirect:({url:a,baseUrl:b})=>a.startsWith("/")?`${b}${a}`:new URL(a).origin===b?a:b,session:({session:a})=>({user:{name:a.user?.name,email:a.user?.email,image:a.user?.image},expires:a.expires?.toISOString?.()??a.expires}),jwt:({token:a})=>a};async function lH({authOptions:a,providerId:b,action:c,url:d,cookies:e,callbackUrl:f,csrfToken:g,csrfDisabled:h,isPost:i}){var j,k;let l=ll(a),{providers:m,provider:n}=function(a){let{providerId:b,config:c}=a,d=new URL(c.basePath??"/auth",a.url.origin),e=c.providers.map(a=>{let b="function"==typeof a?a():a,{options:e,...f}=b,g=e?.id??f.id,h=lx(f,e,{signinUrl:`${d}/signin/${g}`,callbackUrl:`${d}/callback/${g}`});if("oauth"===b.type||"oidc"===b.type){var i;let a,b,d,f;h.redirectProxyUrl??(h.redirectProxyUrl=e?.redirectProxyUrl??c.redirectProxyUrl);let g=((i=h).issuer&&(i.wellKnown??(i.wellKnown=`${i.issuer}/.well-known/openid-configuration`)),(a=lF(i.authorization,i.issuer))&&!a.url?.searchParams.has("scope")&&a.url.searchParams.set("scope","openid profile email"),b=lF(i.token,i.issuer),d=lF(i.userinfo,i.issuer),f=i.checks??["pkce"],i.redirectProxyUrl&&(f.includes("state")||f.push("state"),i.redirectProxyUrl=`${i.redirectProxyUrl}/callback/${i.id}`),{...i,authorization:a,token:b,checks:f,userinfo:d,profile:i.profile??lC,account:i.account??lD});return g.authorization?.url.searchParams.get("response_mode")==="form_post"&&delete g.redirectProxyUrl,g[lA]??(g[lA]=e?.[lA]),g}return h}),f=e.find(({id:a})=>a===b);if(b&&!f){let a=e.map(a=>a.id).join(", ");throw Error(`Provider with id "${b}" not found. Available providers: [${a}].`)}return{providers:e,provider:f}}({url:d,providerId:b,config:a}),o=!1;if((n?.type==="oauth"||n?.type==="oidc")&&n.redirectProxyUrl)try{o=new URL(n.redirectProxyUrl).origin===d.origin}catch{throw TypeError(`redirectProxyUrl must be a valid URL. Received: ${n.redirectProxyUrl}`)}let p={debug:!1,pages:{},theme:{colorScheme:"auto",logo:"",brandColor:"",buttonText:""},...a,url:d,action:c,provider:n,cookies:lx(iU(a.useSecureCookies??"https:"===d.protocol),a.cookies),providers:m,session:{strategy:a.adapter?"database":"jwt",maxAge:2592e3,updateAge:86400,generateSessionToken:()=>crypto.randomUUID(),...a.session},jwt:{secret:a.secret,maxAge:a.session?.maxAge??2592e3,encode:le,decode:lf,...a.jwt},events:(j=a.events??{},k=l,Object.keys(j).reduce((a,b)=>(a[b]=async(...a)=>{try{let c=j[b];return await c(...a)}catch(a){k.error(new i0(a))}},a),{})),adapter:function(a,b){if(a)return Object.keys(a).reduce((c,d)=>(c[d]=async(...c)=>{try{b.debug(`adapter_${d}`,{args:c});let e=a[d];return await e(...c)}catch(c){let a=new iY(c);throw b.error(a),a}},c),{})}(a.adapter,l),callbacks:{...lG,...a.callbacks},logger:l,callbackUrl:d.origin,isOnRedirectProxy:o,experimental:{...a.experimental}},q=[];if(h)p.csrfTokenVerified=!0;else{let{csrfToken:a,cookie:b,csrfTokenVerified:c}=await lu({options:p,cookieValue:e?.[p.cookies.csrfToken.name],isPost:i,bodyValue:g});p.csrfToken=a,p.csrfTokenVerified=c,b&&q.push({name:p.cookies.csrfToken.name,value:b,options:p.cookies.csrfToken.options})}let{callbackUrl:r,callbackUrlCookie:s}=await lh({options:p,cookieValue:e?.[p.cookies.callbackUrl.name],paramValue:f});return p.callbackUrl=r,s&&q.push({name:p.cookies.callbackUrl.name,value:s,options:p.cookies.callbackUrl.options}),{options:p,cookies:q}}var lI,lJ,lK,lL,lM,lN,lO,lP,lQ,lR,lS,lT,lU,lV,lW,lX,lY,lZ,l$,l_,l0={},l1=[],l2=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,l3=Array.isArray;function l4(a,b){for(var c in b)a[c]=b[c];return a}function l5(a){a&&a.parentNode&&a.parentNode.removeChild(a)}function l6(a,b,c,d,e){var f={type:a,props:b,key:c,ref:d,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:null==e?++lU:e,__i:-1,__u:0};return null==e&&null!=lT.vnode&&lT.vnode(f),f}function l7(a){return a.children}function l8(a,b){this.props=a,this.context=b}function l9(a,b){if(null==b)return a.__?l9(a.__,a.__i+1):null;for(var c;b<a.__k.length;b++)if(null!=(c=a.__k[b])&&null!=c.__e)return c.__e;return"function"==typeof a.type?l9(a):null}function ma(a){(!a.__d&&(a.__d=!0)&&lV.push(a)&&!mb.__r++||lW!==lT.debounceRendering)&&((lW=lT.debounceRendering)||lX)(mb)}function mb(){var a,b,c,d,e,f,g,h;for(lV.sort(lY);a=lV.shift();)a.__d&&(b=lV.length,d=void 0,f=(e=(c=a).__v).__e,g=[],h=[],c.__P&&((d=l4({},e)).__v=e.__v+1,lT.vnode&&lT.vnode(d),mg(c.__P,d,e,c.__n,c.__P.namespaceURI,32&e.__u?[f]:null,g,null==f?l9(e):f,!!(32&e.__u),h),d.__v=e.__v,d.__.__k[d.__i]=d,function(a,b,c){b.__d=void 0;for(var d=0;d<c.length;d++)mh(c[d],c[++d],c[++d]);lT.__c&&lT.__c(b,a),a.some(function(b){try{a=b.__h,b.__h=[],a.some(function(a){a.call(b)})}catch(a){lT.__e(a,b.__v)}})}(g,d,h),d.__e!=f&&function a(b){var c,d;if(null!=(b=b.__)&&null!=b.__c){for(b.__e=b.__c.base=null,c=0;c<b.__k.length;c++)if(null!=(d=b.__k[c])&&null!=d.__e){b.__e=b.__c.base=d.__e;break}return a(b)}}(d)),lV.length>b&&lV.sort(lY));mb.__r=0}function mc(a,b,c,d,e,f,g,h,i,j,k){var l,m,n,o,p,q=d&&d.__k||l1,r=b.length;for(c.__d=i,function(a,b,c){var d,e,f,g,h,i=b.length,j=c.length,k=j,l=0;for(a.__k=[],d=0;d<i;d++)null!=(e=b[d])&&"boolean"!=typeof e&&"function"!=typeof e?(g=d+l,(e=a.__k[d]="string"==typeof e||"number"==typeof e||"bigint"==typeof e||e.constructor==String?l6(null,e,null,null,null):l3(e)?l6(l7,{children:e},null,null,null):void 0===e.constructor&&e.__b>0?l6(e.type,e.props,e.key,e.ref?e.ref:null,e.__v):e).__=a,e.__b=a.__b+1,f=null,-1!==(h=e.__i=function(a,b,c,d){var e=a.key,f=a.type,g=c-1,h=c+1,i=b[c];if(null===i||i&&e==i.key&&f===i.type&&0==(131072&i.__u))return c;if(d>+(null!=i&&0==(131072&i.__u)))for(;g>=0||h<b.length;){if(g>=0){if((i=b[g])&&0==(131072&i.__u)&&e==i.key&&f===i.type)return g;g--}if(h<b.length){if((i=b[h])&&0==(131072&i.__u)&&e==i.key&&f===i.type)return h;h++}}return -1}(e,c,g,k))&&(k--,(f=c[h])&&(f.__u|=131072)),null==f||null===f.__v?(-1==h&&l--,"function"!=typeof e.type&&(e.__u|=65536)):h!==g&&(h==g-1?l--:h==g+1?l++:(h>g?l--:l++,e.__u|=65536))):e=a.__k[d]=null;if(k)for(d=0;d<j;d++)null!=(f=c[d])&&0==(131072&f.__u)&&(f.__e==a.__d&&(a.__d=l9(f)),function a(b,c,d){var e,f;if(lT.unmount&&lT.unmount(b),(e=b.ref)&&(e.current&&e.current!==b.__e||mh(e,null,c)),null!=(e=b.__c)){if(e.componentWillUnmount)try{e.componentWillUnmount()}catch(a){lT.__e(a,c)}e.base=e.__P=null}if(e=b.__k)for(f=0;f<e.length;f++)e[f]&&a(e[f],c,d||"function"!=typeof b.type);d||l5(b.__e),b.__c=b.__=b.__e=b.__d=void 0}(f,f))}(c,b,q),i=c.__d,l=0;l<r;l++)null!=(n=c.__k[l])&&(m=-1===n.__i?l0:q[n.__i]||l0,n.__i=l,mg(a,n,m,e,f,g,h,i,j,k),o=n.__e,n.ref&&m.ref!=n.ref&&(m.ref&&mh(m.ref,null,n),k.push(n.ref,n.__c||o,n)),null==p&&null!=o&&(p=o),65536&n.__u||m.__k===n.__k?i=function a(b,c,d){var e,f;if("function"==typeof b.type){for(e=b.__k,f=0;e&&f<e.length;f++)e[f]&&(e[f].__=b,c=a(e[f],c,d));return c}b.__e!=c&&(c&&b.type&&!d.contains(c)&&(c=l9(b)),d.insertBefore(b.__e,c||null),c=b.__e);do c=c&&c.nextSibling;while(null!=c&&8===c.nodeType)return c}(n,i,a):"function"==typeof n.type&&void 0!==n.__d?i=n.__d:o&&(i=o.nextSibling),n.__d=void 0,n.__u&=-196609);c.__d=i,c.__e=p}function md(a,b,c){"-"===b[0]?a.setProperty(b,null==c?"":c):a[b]=null==c?"":"number"!=typeof c||l2.test(b)?c:c+"px"}function me(a,b,c,d,e){var f;a:if("style"===b)if("string"==typeof c)a.style.cssText=c;else{if("string"==typeof d&&(a.style.cssText=d=""),d)for(b in d)c&&b in c||md(a.style,b,"");if(c)for(b in c)d&&c[b]===d[b]||md(a.style,b,c[b])}else if("o"===b[0]&&"n"===b[1])f=b!==(b=b.replace(/(PointerCapture)$|Capture$/i,"$1")),b=b.toLowerCase()in a||"onFocusOut"===b||"onFocusIn"===b?b.toLowerCase().slice(2):b.slice(2),a.l||(a.l={}),a.l[b+f]=c,c?d?c.u=d.u:(c.u=lZ,a.addEventListener(b,f?l_:l$,f)):a.removeEventListener(b,f?l_:l$,f);else{if("http://www.w3.org/2000/svg"==e)b=b.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=b&&"height"!=b&&"href"!=b&&"list"!=b&&"form"!=b&&"tabIndex"!=b&&"download"!=b&&"rowSpan"!=b&&"colSpan"!=b&&"role"!=b&&"popover"!=b&&b in a)try{a[b]=null==c?"":c;break a}catch(a){}"function"==typeof c||(null==c||!1===c&&"-"!==b[4]?a.removeAttribute(b):a.setAttribute(b,"popover"==b&&1==c?"":c))}}function mf(a){return function(b){if(this.l){var c=this.l[b.type+a];if(null==b.t)b.t=lZ++;else if(b.t<c.u)return;return c(lT.event?lT.event(b):b)}}}function mg(a,b,c,d,e,f,g,h,i,j){var k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A=b.type;if(void 0!==b.constructor)return null;128&c.__u&&(i=!!(32&c.__u),f=[h=b.__e=c.__e]),(k=lT.__b)&&k(b);a:if("function"==typeof A)try{if(r=b.props,s="prototype"in A&&A.prototype.render,t=(k=A.contextType)&&d[k.__c],u=k?t?t.props.value:k.__:d,c.__c?q=(l=b.__c=c.__c).__=l.__E:(s?b.__c=l=new A(r,u):(b.__c=l=new l8(r,u),l.constructor=A,l.render=mi),t&&t.sub(l),l.props=r,l.state||(l.state={}),l.context=u,l.__n=d,m=l.__d=!0,l.__h=[],l._sb=[]),s&&null==l.__s&&(l.__s=l.state),s&&null!=A.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=l4({},l.__s)),l4(l.__s,A.getDerivedStateFromProps(r,l.__s))),n=l.props,o=l.state,l.__v=b,m)s&&null==A.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),s&&null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(s&&null==A.getDerivedStateFromProps&&r!==n&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(r,u),!l.__e&&(null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(r,l.__s,u)||b.__v===c.__v)){for(b.__v!==c.__v&&(l.props=r,l.state=l.__s,l.__d=!1),b.__e=c.__e,b.__k=c.__k,b.__k.some(function(a){a&&(a.__=b)}),v=0;v<l._sb.length;v++)l.__h.push(l._sb[v]);l._sb=[],l.__h.length&&g.push(l);break a}null!=l.componentWillUpdate&&l.componentWillUpdate(r,l.__s,u),s&&null!=l.componentDidUpdate&&l.__h.push(function(){l.componentDidUpdate(n,o,p)})}if(l.context=u,l.props=r,l.__P=a,l.__e=!1,w=lT.__r,x=0,s){for(l.state=l.__s,l.__d=!1,w&&w(b),k=l.render(l.props,l.state,l.context),y=0;y<l._sb.length;y++)l.__h.push(l._sb[y]);l._sb=[]}else do l.__d=!1,w&&w(b),k=l.render(l.props,l.state,l.context),l.state=l.__s;while(l.__d&&++x<25)l.state=l.__s,null!=l.getChildContext&&(d=l4(l4({},d),l.getChildContext())),s&&!m&&null!=l.getSnapshotBeforeUpdate&&(p=l.getSnapshotBeforeUpdate(n,o)),mc(a,l3(z=null!=k&&k.type===l7&&null==k.key?k.props.children:k)?z:[z],b,c,d,e,f,g,h,i,j),l.base=b.__e,b.__u&=-161,l.__h.length&&g.push(l),q&&(l.__E=l.__=null)}catch(a){if(b.__v=null,i||null!=f){for(b.__u|=i?160:128;h&&8===h.nodeType&&h.nextSibling;)h=h.nextSibling;f[f.indexOf(h)]=null,b.__e=h}else b.__e=c.__e,b.__k=c.__k;lT.__e(a,b,c)}else null==f&&b.__v===c.__v?(b.__k=c.__k,b.__e=c.__e):b.__e=function(a,b,c,d,e,f,g,h,i){var j,k,l,m,n,o,p,q=c.props,r=b.props,s=b.type;if("svg"===s?e="http://www.w3.org/2000/svg":"math"===s?e="http://www.w3.org/1998/Math/MathML":e||(e="http://www.w3.org/1999/xhtml"),null!=f){for(j=0;j<f.length;j++)if((n=f[j])&&"setAttribute"in n==!!s&&(s?n.localName===s:3===n.nodeType)){a=n,f[j]=null;break}}if(null==a){if(null===s)return document.createTextNode(r);a=document.createElementNS(e,s,r.is&&r),h&&(lT.__m&&lT.__m(b,f),h=!1),f=null}if(null===s)q===r||h&&a.data===r||(a.data=r);else{if(f=f&&lS.call(a.childNodes),q=c.props||l0,!h&&null!=f)for(q={},j=0;j<a.attributes.length;j++)q[(n=a.attributes[j]).name]=n.value;for(j in q)if(n=q[j],"children"==j);else if("dangerouslySetInnerHTML"==j)l=n;else if(!(j in r)){if("value"==j&&"defaultValue"in r||"checked"==j&&"defaultChecked"in r)continue;me(a,j,null,n,e)}for(j in r)n=r[j],"children"==j?m=n:"dangerouslySetInnerHTML"==j?k=n:"value"==j?o=n:"checked"==j?p=n:h&&"function"!=typeof n||q[j]===n||me(a,j,n,q[j],e);if(k)h||l&&(k.__html===l.__html||k.__html===a.innerHTML)||(a.innerHTML=k.__html),b.__k=[];else if(l&&(a.innerHTML=""),mc(a,l3(m)?m:[m],b,c,d,"foreignObject"===s?"http://www.w3.org/1999/xhtml":e,f,g,f?f[0]:c.__k&&l9(c,0),h,i),null!=f)for(j=f.length;j--;)l5(f[j]);h||(j="value","progress"===s&&null==o?a.removeAttribute("value"):void 0===o||o===a[j]&&("progress"!==s||o)&&("option"!==s||o===q[j])||me(a,j,o,q[j],e),j="checked",void 0!==p&&p!==a[j]&&me(a,j,p,q[j],e))}return a}(c.__e,b,c,d,e,f,g,i,j);(k=lT.diffed)&&k(b)}function mh(a,b,c){try{if("function"==typeof a){var d="function"==typeof a.__u;d&&a.__u(),d&&null==b||(a.__u=a(b))}else a.current=b}catch(a){lT.__e(a,c)}}function mi(a,b,c){return this.constructor(a,c)}lS=l1.slice,lT={__e:function(a,b,c,d){for(var e,f,g;b=b.__;)if((e=b.__c)&&!e.__)try{if((f=e.constructor)&&null!=f.getDerivedStateFromError&&(e.setState(f.getDerivedStateFromError(a)),g=e.__d),null!=e.componentDidCatch&&(e.componentDidCatch(a,d||{}),g=e.__d),g)return e.__E=e}catch(b){a=b}throw a}},lU=0,l8.prototype.setState=function(a,b){var c;c=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=l4({},this.state),"function"==typeof a&&(a=a(l4({},c),this.props)),a&&l4(c,a),null!=a&&this.__v&&(b&&this._sb.push(b),ma(this))},l8.prototype.forceUpdate=function(a){this.__v&&(this.__e=!0,a&&this.__h.push(a),ma(this))},l8.prototype.render=l7,lV=[],lX="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,lY=function(a,b){return a.__v.__b-b.__v.__b},mb.__r=0,lZ=0,l$=mf(!1),l_=mf(!0);var mj=/[\s\n\\/='"\0<>]/,mk=/^(xlink|xmlns|xml)([A-Z])/,ml=/^accessK|^auto[A-Z]|^cell|^ch|^col|cont|cross|dateT|encT|form[A-Z]|frame|hrefL|inputM|maxL|minL|noV|playsI|popoverT|readO|rowS|src[A-Z]|tabI|useM|item[A-Z]/,mm=/^ac|^ali|arabic|basel|cap|clipPath$|clipRule$|color|dominant|enable|fill|flood|font|glyph[^R]|horiz|image|letter|lighting|marker[^WUH]|overline|panose|pointe|paint|rendering|shape|stop|strikethrough|stroke|text[^L]|transform|underline|unicode|units|^v[^i]|^w|^xH/,mn=new Set(["draggable","spellcheck"]),mo=/["&<]/;function mp(a){if(0===a.length||!1===mo.test(a))return a;for(var b=0,c=0,d="",e="";c<a.length;c++){switch(a.charCodeAt(c)){case 34:e="&quot;";break;case 38:e="&amp;";break;case 60:e="&lt;";break;default:continue}c!==b&&(d+=a.slice(b,c)),d+=e,b=c+1}return c!==b&&(d+=a.slice(b,c)),d}var mq={},mr=new Set(["animation-iteration-count","border-image-outset","border-image-slice","border-image-width","box-flex","box-flex-group","box-ordinal-group","column-count","fill-opacity","flex","flex-grow","flex-negative","flex-order","flex-positive","flex-shrink","flood-opacity","font-weight","grid-column","grid-row","line-clamp","line-height","opacity","order","orphans","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-miterlimit","stroke-opacity","stroke-width","tab-size","widows","z-index","zoom"]),ms=/[A-Z]/g;function mt(){this.__d=!0}function mu(a,b,c){if(!a.s){if(c instanceof mz){if(!c.s)return void(c.o=mu.bind(null,a,b));1&b&&(b=c.s),c=c.v}if(c&&c.then)return void c.then(mu.bind(null,a,b),mu.bind(null,a,2));a.s=b,a.v=c;let d=a.o;d&&d(a)}}var mv,mw,mx,my,mz=function(){function a(){}return a.prototype.then=function(b,c){var d=new a,e=this.s;if(e){var f=1&e?b:c;if(f){try{mu(d,1,f(this.v))}catch(a){mu(d,2,a)}return d}return this}return this.o=function(a){try{var e=a.v;1&a.s?mu(d,1,b?b(e):e):c?mu(d,1,c(e)):mu(d,2,e)}catch(a){mu(d,2,a)}},d},a}(),mA={},mB=[],mC=Array.isArray,mD=Object.assign;function mE(a,b){var c,d=a.type,e=!0;return a.__c?(e=!1,(c=a.__c).state=c.__s):c=new d(a.props,b),a.__c=c,c.__v=a,c.props=a.props,c.context=b,c.__d=!0,null==c.state&&(c.state=mA),null==c.__s&&(c.__s=c.state),d.getDerivedStateFromProps?c.state=mD({},c.state,d.getDerivedStateFromProps(c.props,c.state)):e&&c.componentWillMount?(c.componentWillMount(),c.state=c.__s!==c.state?c.__s:c.state):!e&&c.componentWillUpdate&&c.componentWillUpdate(),mx&&mx(a),c.render(c.props,c.state,b)}var mF=new Set(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),mG=0;function mH(a,b,c,d,e,f){b||(b={});var g,h,i=b;"ref"in b&&(g=b.ref,delete b.ref);var j={type:a,props:i,key:c,ref:g,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,constructor:void 0,__v:--mG,__i:-1,__u:0,__source:e,__self:f};if("function"==typeof a&&(g=a.defaultProps))for(h in g)void 0===i[h]&&(i[h]=g[h]);return lT.vnode&&lT.vnode(j),j}async function mI(a,b){let c=window.SimpleWebAuthnBrowser;async function d(c){let d=new URL(`${a}/webauthn-options/${b}`);c&&d.searchParams.append("action",c),f().forEach(a=>{d.searchParams.append(a.name,a.value)});let e=await fetch(d);return e.ok?e.json():void console.error("Failed to fetch options",e)}function e(){let a=`#${b}-form`,c=document.querySelector(a);if(!c)throw Error(`Form '${a}' not found`);return c}function f(){return Array.from(e().querySelectorAll("input[data-form-field]"))}async function g(a,b){let c=e();if(a){let b=document.createElement("input");b.type="hidden",b.name="action",b.value=a,c.appendChild(b)}if(b){let a=document.createElement("input");a.type="hidden",a.name="data",a.value=JSON.stringify(b),c.appendChild(a)}return c.submit()}async function h(a,b){let d=await c.startAuthentication(a,b);return await g("authenticate",d)}async function i(a){f().forEach(a=>{if(a.required&&!a.value)throw Error(`Missing required field: ${a.name}`)});let b=await c.startRegistration(a);return await g("register",b)}async function j(){if(!c.browserSupportsWebAuthnAutofill())return;let a=await d("authenticate");if(!a)return void console.error("Failed to fetch option for autofill authentication");try{await h(a.options,!0)}catch(a){console.error(a)}}(async function(){let a=e();if(!c.browserSupportsWebAuthn()){a.style.display="none";return}a&&a.addEventListener("submit",async a=>{a.preventDefault();let b=await d(void 0);if(!b)return void console.error("Failed to fetch options for form submission");if("authenticate"===b.action)try{await h(b.options,!1)}catch(a){console.error(a)}else if("register"===b.action)try{await i(b.options)}catch(a){console.error(a)}})})(),j()}let mJ={default:"Unable to sign in.",Signin:"Try signing in with a different account.",OAuthSignin:"Try signing in with a different account.",OAuthCallbackError:"Try signing in with a different account.",OAuthCreateAccount:"Try signing in with a different account.",EmailCreateAccount:"Try signing in with a different account.",Callback:"Try signing in with a different account.",OAuthAccountNotLinked:"To confirm your identity, sign in with the same account you used originally.",EmailSignin:"The e-mail could not be sent.",CredentialsSignin:"Sign in failed. Check the details you provided are correct.",SessionRequired:"Please sign in to access this page."},mK=`:root {
  --border-width: 1px;
  --border-radius: 0.5rem;
  --color-error: #c94b4b;
  --color-info: #157efb;
  --color-info-hover: #0f6ddb;
  --color-info-text: #fff;
}

.__next-auth-theme-auto,
.__next-auth-theme-light {
  --color-background: #ececec;
  --color-background-hover: rgba(236, 236, 236, 0.8);
  --color-background-card: #fff;
  --color-text: #000;
  --color-primary: #444;
  --color-control-border: #bbb;
  --color-button-active-background: #f9f9f9;
  --color-button-active-border: #aaa;
  --color-separator: #ccc;
  --provider-bg: #fff;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #fff
  );
}

.__next-auth-theme-dark {
  --color-background: #161b22;
  --color-background-hover: rgba(22, 27, 34, 0.8);
  --color-background-card: #0d1117;
  --color-text: #fff;
  --color-primary: #ccc;
  --color-control-border: #555;
  --color-button-active-background: #060606;
  --color-button-active-border: #666;
  --color-separator: #444;
  --provider-bg: #161b22;
  --provider-bg-hover: color-mix(
    in srgb,
    var(--provider-brand-color) 30%,
    #000
  );
}

.__next-auth-theme-dark img[src$="42-school.svg"],
  .__next-auth-theme-dark img[src$="apple.svg"],
  .__next-auth-theme-dark img[src$="boxyhq-saml.svg"],
  .__next-auth-theme-dark img[src$="eveonline.svg"],
  .__next-auth-theme-dark img[src$="github.svg"],
  .__next-auth-theme-dark img[src$="mailchimp.svg"],
  .__next-auth-theme-dark img[src$="medium.svg"],
  .__next-auth-theme-dark img[src$="okta.svg"],
  .__next-auth-theme-dark img[src$="patreon.svg"],
  .__next-auth-theme-dark img[src$="ping-id.svg"],
  .__next-auth-theme-dark img[src$="roblox.svg"],
  .__next-auth-theme-dark img[src$="threads.svg"],
  .__next-auth-theme-dark img[src$="wikimedia.svg"] {
    filter: invert(1);
  }

.__next-auth-theme-dark #submitButton {
    background-color: var(--provider-bg, var(--color-info));
  }

@media (prefers-color-scheme: dark) {
  .__next-auth-theme-auto {
    --color-background: #161b22;
    --color-background-hover: rgba(22, 27, 34, 0.8);
    --color-background-card: #0d1117;
    --color-text: #fff;
    --color-primary: #ccc;
    --color-control-border: #555;
    --color-button-active-background: #060606;
    --color-button-active-border: #666;
    --color-separator: #444;
    --provider-bg: #161b22;
    --provider-bg-hover: color-mix(
      in srgb,
      var(--provider-brand-color) 30%,
      #000
    );
  }
    .__next-auth-theme-auto img[src$="42-school.svg"],
    .__next-auth-theme-auto img[src$="apple.svg"],
    .__next-auth-theme-auto img[src$="boxyhq-saml.svg"],
    .__next-auth-theme-auto img[src$="eveonline.svg"],
    .__next-auth-theme-auto img[src$="github.svg"],
    .__next-auth-theme-auto img[src$="mailchimp.svg"],
    .__next-auth-theme-auto img[src$="medium.svg"],
    .__next-auth-theme-auto img[src$="okta.svg"],
    .__next-auth-theme-auto img[src$="patreon.svg"],
    .__next-auth-theme-auto img[src$="ping-id.svg"],
    .__next-auth-theme-auto img[src$="roblox.svg"],
    .__next-auth-theme-auto img[src$="threads.svg"],
    .__next-auth-theme-auto img[src$="wikimedia.svg"] {
      filter: invert(1);
    }
    .__next-auth-theme-auto #submitButton {
      background-color: var(--provider-bg, var(--color-info));
    }
}

html {
  box-sizing: border-box;
}

*,
*:before,
*:after {
  box-sizing: inherit;
  margin: 0;
  padding: 0;
}

body {
  background-color: var(--color-background);
  margin: 0;
  padding: 0;
  font-family:
    ui-sans-serif,
    system-ui,
    -apple-system,
    BlinkMacSystemFont,
    "Segoe UI",
    Roboto,
    "Helvetica Neue",
    Arial,
    "Noto Sans",
    sans-serif,
    "Apple Color Emoji",
    "Segoe UI Emoji",
    "Segoe UI Symbol",
    "Noto Color Emoji";
}

h1 {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  font-weight: 400;
  color: var(--color-text);
}

p {
  margin-bottom: 1.5rem;
  padding: 0 1rem;
  color: var(--color-text);
}

form {
  margin: 0;
  padding: 0;
}

label {
  font-weight: 500;
  text-align: left;
  margin-bottom: 0.25rem;
  display: block;
  color: var(--color-text);
}

input[type] {
  box-sizing: border-box;
  display: block;
  width: 100%;
  padding: 0.5rem 1rem;
  border: var(--border-width) solid var(--color-control-border);
  background: var(--color-background-card);
  font-size: 1rem;
  border-radius: var(--border-radius);
  color: var(--color-text);
}

p {
  font-size: 1.1rem;
  line-height: 2rem;
}

a.button {
  text-decoration: none;
  line-height: 1rem;
}

a.button:link,
  a.button:visited {
    background-color: var(--color-background);
    color: var(--color-primary);
  }

button,
a.button {
  padding: 0.75rem 1rem;
  color: var(--provider-color, var(--color-primary));
  background-color: var(--provider-bg, var(--color-background));
  border: 1px solid #00000031;
  font-size: 0.9rem;
  height: 50px;
  border-radius: var(--border-radius);
  transition: background-color 250ms ease-in-out;
  font-weight: 300;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: space-between;
}

:is(button,a.button):hover {
    background-color: var(--provider-bg-hover, var(--color-background-hover));
    cursor: pointer;
  }

:is(button,a.button):active {
    cursor: pointer;
  }

:is(button,a.button) span {
    color: var(--provider-bg);
  }

#submitButton {
  color: var(--button-text-color, var(--color-info-text));
  background-color: var(--brand-color, var(--color-info));
  width: 100%;
}

#submitButton:hover {
    background-color: var(
      --button-hover-bg,
      var(--color-info-hover)
    ) !important;
  }

a.site {
  color: var(--color-primary);
  text-decoration: none;
  font-size: 1rem;
  line-height: 2rem;
}

a.site:hover {
    text-decoration: underline;
  }

.page {
  position: absolute;
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

.page > div {
    text-align: center;
  }

.error a.button {
    padding-left: 2rem;
    padding-right: 2rem;
    margin-top: 0.5rem;
  }

.error .message {
    margin-bottom: 1.5rem;
  }

.signin input[type="text"] {
    margin-left: auto;
    margin-right: auto;
    display: block;
  }

.signin hr {
    display: block;
    border: 0;
    border-top: 1px solid var(--color-separator);
    margin: 2rem auto 1rem auto;
    overflow: visible;
  }

.signin hr::before {
      content: "or";
      background: var(--color-background-card);
      color: #888;
      padding: 0 0.4rem;
      position: relative;
      top: -0.7rem;
    }

.signin .error {
    background: #f5f5f5;
    font-weight: 500;
    border-radius: 0.3rem;
    background: var(--color-error);
  }

.signin .error p {
      text-align: left;
      padding: 0.5rem 1rem;
      font-size: 0.9rem;
      line-height: 1.2rem;
      color: var(--color-info-text);
    }

.signin > div,
  .signin form {
    display: block;
  }

.signin > div input[type], .signin form input[type] {
      margin-bottom: 0.5rem;
    }

.signin > div button, .signin form button {
      width: 100%;
    }

.signin .provider + .provider {
    margin-top: 1rem;
  }

.logo {
  display: inline-block;
  max-width: 150px;
  margin: 1.25rem 0;
  max-height: 70px;
}

.card {
  background-color: var(--color-background-card);
  border-radius: 1rem;
  padding: 1.25rem 2rem;
}

.card .header {
    color: var(--color-primary);
  }

.card input[type]::-moz-placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type]::placeholder {
    color: color-mix(
      in srgb,
      var(--color-text) 20%,
      var(--color-button-active-background)
    );
  }

.card input[type] {
    background: color-mix(in srgb, var(--color-background-card) 95%, black);
  }

.section-header {
  color: var(--color-text);
}

@media screen and (min-width: 450px) {
  .card {
    margin: 2rem 0;
    width: 368px;
  }
}

@media screen and (max-width: 450px) {
  .card {
    margin: 1rem 0;
    width: 343px;
  }
}
`;function mL({html:a,title:b,status:c,cookies:d,theme:e,headTags:f}){return{cookies:d,status:c,headers:{"Content-Type":"text/html"},body:`<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><style>${mK}</style><title>${b}</title>${f??""}</head><body class="__next-auth-theme-${e?.colorScheme??"auto"}"><div class="page">${function(a,b,c){var d=lT.__s;lT.__s=!0,mv=lT.__b,mw=lT.diffed,mx=lT.__r,my=lT.unmount;var e=function(a,b,c){var d,e,f,g={};for(f in b)"key"==f?d=b[f]:"ref"==f?e=b[f]:g[f]=b[f];if(arguments.length>2&&(g.children=arguments.length>3?lS.call(arguments,2):c),"function"==typeof a&&null!=a.defaultProps)for(f in a.defaultProps)void 0===g[f]&&(g[f]=a.defaultProps[f]);return l6(a,g,d,e,null)}(l7,null);e.__k=[a];try{var f=function a(b,c,d,e,f,g,h){if(null==b||!0===b||!1===b||""===b)return"";var i=typeof b;if("object"!=i)return"function"==i?"":"string"==i?mp(b):b+"";if(mC(b)){var j,k="";f.__k=b;for(var l=0;l<b.length;l++){var m=b[l];if(null!=m&&"boolean"!=typeof m){var n,o=a(m,c,d,e,f,g,h);"string"==typeof o?k+=o:(j||(j=[]),k&&j.push(k),k="",mC(o)?(n=j).push.apply(n,o):j.push(o))}}return j?(k&&j.push(k),j):k}if(void 0!==b.constructor)return"";b.__=f,mv&&mv(b);var p=b.type,q=b.props;if("function"==typeof p){var r,s,t,u=c;if(p===l7){if("tpl"in q){for(var v="",w=0;w<q.tpl.length;w++)if(v+=q.tpl[w],q.exprs&&w<q.exprs.length){var x=q.exprs[w];if(null==x)continue;"object"==typeof x&&(void 0===x.constructor||mC(x))?v+=a(x,c,d,e,b,g,h):v+=x}return v}if("UNSTABLE_comment"in q)return"<!--"+mp(q.UNSTABLE_comment)+"-->";s=q.children}else{if(null!=(r=p.contextType)){var y=c[r.__c];u=y?y.props.value:r.__}var z=p.prototype&&"function"==typeof p.prototype.render;if(z)s=mE(b,u),t=b.__c;else{b.__c=t={__v:b,context:u,props:b.props,setState:mt,forceUpdate:mt,__d:!0,__h:[]};for(var A=0;t.__d&&A++<25;)t.__d=!1,mx&&mx(b),s=p.call(t,q,u);t.__d=!0}if(null!=t.getChildContext&&(c=mD({},c,t.getChildContext())),z&&lT.errorBoundaries&&(p.getDerivedStateFromError||t.componentDidCatch)){s=null!=s&&s.type===l7&&null==s.key&&null==s.props.tpl?s.props.children:s;try{return a(s,c,d,e,b,g,h)}catch(f){return p.getDerivedStateFromError&&(t.__s=p.getDerivedStateFromError(f)),t.componentDidCatch&&t.componentDidCatch(f,mA),t.__d?(s=mE(b,c),null!=(t=b.__c).getChildContext&&(c=mD({},c,t.getChildContext())),a(s=null!=s&&s.type===l7&&null==s.key&&null==s.props.tpl?s.props.children:s,c,d,e,b,g,h)):""}finally{mw&&mw(b),b.__=null,my&&my(b)}}}s=null!=s&&s.type===l7&&null==s.key&&null==s.props.tpl?s.props.children:s;try{var B=a(s,c,d,e,b,g,h);return mw&&mw(b),b.__=null,lT.unmount&&lT.unmount(b),B}catch(f){if(!g&&h&&h.onError){var C=h.onError(f,b,function(f){return a(f,c,d,e,b,g,h)});if(void 0!==C)return C;var D=lT.__e;return D&&D(f,b),""}if(!g||!f||"function"!=typeof f.then)throw f;return f.then(function f(){try{return a(s,c,d,e,b,g,h)}catch(i){if(!i||"function"!=typeof i.then)throw i;return i.then(function(){return a(s,c,d,e,b,g,h)},f)}})}}var E,F="<"+p,G="";for(var H in q){var I=q[H];if("function"!=typeof I||"class"===H||"className"===H){switch(H){case"children":E=I;continue;case"key":case"ref":case"__self":case"__source":continue;case"htmlFor":if("for"in q)continue;H="for";break;case"className":if("class"in q)continue;H="class";break;case"defaultChecked":H="checked";break;case"defaultSelected":H="selected";break;case"defaultValue":case"value":switch(H="value",p){case"textarea":E=I;continue;case"select":e=I;continue;case"option":e!=I||"selected"in q||(F+=" selected")}break;case"dangerouslySetInnerHTML":G=I&&I.__html;continue;case"style":"object"==typeof I&&(I=function(a){var b="";for(var c in a){var d=a[c];if(null!=d&&""!==d){var e="-"==c[0]?c:mq[c]||(mq[c]=c.replace(ms,"-$&").toLowerCase()),f=";";"number"!=typeof d||e.startsWith("--")||mr.has(e)||(f="px;"),b=b+e+":"+d+f}}return b||void 0}(I));break;case"acceptCharset":H="accept-charset";break;case"httpEquiv":H="http-equiv";break;default:if(mk.test(H))H=H.replace(mk,"$1:$2").toLowerCase();else{if(mj.test(H))continue;("-"===H[4]||mn.has(H))&&null!=I?I+="":d?mm.test(H)&&(H="panose1"===H?"panose-1":H.replace(/([A-Z])/g,"-$1").toLowerCase()):ml.test(H)&&(H=H.toLowerCase())}}null!=I&&!1!==I&&(F=!0===I||""===I?F+" "+H:F+" "+H+'="'+("string"==typeof I?mp(I):I+"")+'"')}}if(mj.test(p))throw Error(p+" is not a valid HTML tag name in "+F+">");if(G||("string"==typeof E?G=mp(E):null!=E&&!1!==E&&!0!==E&&(G=a(E,c,"svg"===p||"foreignObject"!==p&&d,e,b,g,h))),mw&&mw(b),b.__=null,my&&my(b),!G&&mF.has(p))return F+"/>";var J="</"+p+">",K=F+">";return mC(G)?[K].concat(G,[J]):"string"!=typeof G?[K,G,J]:K+G+J}(a,mA,!1,void 0,e,!1,void 0);return mC(f)?f.join(""):f}catch(a){if(a.then)throw Error('Use "renderToStringAsync" for suspenseful rendering.');throw a}finally{lT.__c&&lT.__c(a,mB),lT.__s=d,mB.length=0}}(a)}</div></body></html>`}}function mM(a){let{url:b,theme:c,query:d,cookies:e,pages:f,providers:g}=a;return{csrf:(a,b,c)=>a?(b.logger.warn("csrf-disabled"),c.push({name:b.cookies.csrfToken.name,value:"",options:{...b.cookies.csrfToken.options,maxAge:0}}),{status:404,cookies:c}):{headers:{"Content-Type":"application/json","Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"},body:{csrfToken:b.csrfToken},cookies:c},providers:a=>({headers:{"Content-Type":"application/json"},body:a.reduce((a,{id:b,name:c,type:d,signinUrl:e,callbackUrl:f})=>(a[b]={id:b,name:c,type:d,signinUrl:e,callbackUrl:f},a),{})}),signin(b,h){if(b)throw new jf("Unsupported action");if(f?.signIn){let b=`${f.signIn}${f.signIn.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:a.callbackUrl??"/"})}`;return h&&(b=`${b}&${new URLSearchParams({error:h})}`),{redirect:b,cookies:e}}let i=g?.find(a=>"webauthn"===a.type&&a.enableConditionalUI&&!!a.simpleWebAuthnBrowserVersion),j="";if(i){let{simpleWebAuthnBrowserVersion:a}=i;j=`<script src="https://unpkg.com/@simplewebauthn/browser@${a}/dist/bundle/index.umd.min.js" crossorigin="anonymous"></script>`}return mL({cookies:e,theme:c,html:function(a){let{csrfToken:b,providers:c=[],callbackUrl:d,theme:e,email:f,error:g}=a;"u">typeof document&&e?.brandColor&&document.documentElement.style.setProperty("--brand-color",e.brandColor),"u">typeof document&&e?.buttonText&&document.documentElement.style.setProperty("--button-text-color",e.buttonText);let h=g&&(mJ[g]??mJ.default),i=c.find(a=>"webauthn"===a.type&&a.enableConditionalUI)?.id;return mH("div",{className:"signin",children:[e?.brandColor&&mH("style",{dangerouslySetInnerHTML:{__html:`:root {--brand-color: ${e.brandColor}}`}}),e?.buttonText&&mH("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${e.buttonText}
        }
      `}}),mH("div",{className:"card",children:[h&&mH("div",{className:"error",children:mH("p",{children:h})}),e?.logo&&mH("img",{src:e.logo,alt:"Logo",className:"logo"}),c.map((a,e)=>{let g,h,i;("oauth"===a.type||"oidc"===a.type)&&({bg:g="#fff",brandColor:h,logo:i=`https://authjs.dev/img/providers/${a.id}.svg`}=a.style??{});let j=h??g??"#fff";return mH("div",{className:"provider",children:["oauth"===a.type||"oidc"===a.type?mH("form",{action:a.signinUrl,method:"POST",children:[mH("input",{type:"hidden",name:"csrfToken",value:b}),d&&mH("input",{type:"hidden",name:"callbackUrl",value:d}),mH("button",{type:"submit",className:"button",style:{"--provider-brand-color":j},tabIndex:0,children:[mH("span",{style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)","mix-blend-mode":"luminosity",opacity:.95},children:["Sign in with ",a.name]}),i&&mH("img",{loading:"lazy",height:24,src:i})]})]}):null,("email"===a.type||"credentials"===a.type||"webauthn"===a.type)&&e>0&&"email"!==c[e-1].type&&"credentials"!==c[e-1].type&&"webauthn"!==c[e-1].type&&mH("hr",{}),"email"===a.type&&mH("form",{action:a.signinUrl,method:"POST",children:[mH("input",{type:"hidden",name:"csrfToken",value:b}),mH("label",{className:"section-header",htmlFor:`input-email-for-${a.id}-provider`,children:"Email"}),mH("input",{id:`input-email-for-${a.id}-provider`,autoFocus:!0,type:"email",name:"email",value:f,placeholder:"email@example.com",required:!0}),mH("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",a.name]})]}),"credentials"===a.type&&mH("form",{action:a.callbackUrl,method:"POST",children:[mH("input",{type:"hidden",name:"csrfToken",value:b}),Object.keys(a.credentials).map(b=>mH("div",{children:[mH("label",{className:"section-header",htmlFor:`input-${b}-for-${a.id}-provider`,children:a.credentials[b].label??b}),mH("input",{name:b,id:`input-${b}-for-${a.id}-provider`,type:a.credentials[b].type??"text",placeholder:a.credentials[b].placeholder??"",...a.credentials[b]})]},`input-group-${a.id}`)),mH("button",{id:"submitButton",type:"submit",tabIndex:0,children:["Sign in with ",a.name]})]}),"webauthn"===a.type&&mH("form",{action:a.callbackUrl,method:"POST",id:`${a.id}-form`,children:[mH("input",{type:"hidden",name:"csrfToken",value:b}),Object.keys(a.formFields).map(b=>mH("div",{children:[mH("label",{className:"section-header",htmlFor:`input-${b}-for-${a.id}-provider`,children:a.formFields[b].label??b}),mH("input",{name:b,"data-form-field":!0,id:`input-${b}-for-${a.id}-provider`,type:a.formFields[b].type??"text",placeholder:a.formFields[b].placeholder??"",...a.formFields[b]})]},`input-group-${a.id}`)),mH("button",{id:`submitButton-${a.id}`,type:"submit",tabIndex:0,children:["Sign in with ",a.name]})]}),("email"===a.type||"credentials"===a.type||"webauthn"===a.type)&&e+1<c.length&&mH("hr",{})]},a.id)})]}),i&&mH(l7,{children:mH("script",{dangerouslySetInnerHTML:{__html:`
const currentURL = window.location.href;
const authURL = currentURL.substring(0, currentURL.lastIndexOf('/'));
(${mI})(authURL, "${i}");
`}})})]})}({csrfToken:a.csrfToken,providers:a.providers?.filter(a=>["email","oauth","oidc"].includes(a.type)||"credentials"===a.type&&a.credentials||"webauthn"===a.type&&a.formFields||!1),callbackUrl:a.callbackUrl,theme:a.theme,error:h,...d}),title:"Sign In",headTags:j})},signout:()=>f?.signOut?{redirect:f.signOut,cookies:e}:mL({cookies:e,theme:c,html:function(a){let{url:b,csrfToken:c,theme:d}=a;return mH("div",{className:"signout",children:[d?.brandColor&&mH("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${d.brandColor}
        }
      `}}),d?.buttonText&&mH("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --button-text-color: ${d.buttonText}
        }
      `}}),mH("div",{className:"card",children:[d?.logo&&mH("img",{src:d.logo,alt:"Logo",className:"logo"}),mH("h1",{children:"Signout"}),mH("p",{children:"Are you sure you want to sign out?"}),mH("form",{action:b?.toString(),method:"POST",children:[mH("input",{type:"hidden",name:"csrfToken",value:c}),mH("button",{id:"submitButton",type:"submit",children:"Sign out"})]})]})]})}({csrfToken:a.csrfToken,url:b,theme:c}),title:"Sign Out"}),verifyRequest:a=>f?.verifyRequest?{redirect:`${f.verifyRequest}${b?.search??""}`,cookies:e}:mL({cookies:e,theme:c,html:function(a){let{url:b,theme:c}=a;return mH("div",{className:"verify-request",children:[c.brandColor&&mH("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${c.brandColor}
        }
      `}}),mH("div",{className:"card",children:[c.logo&&mH("img",{src:c.logo,alt:"Logo",className:"logo"}),mH("h1",{children:"Check your email"}),mH("p",{children:"A sign in link has been sent to your email address."}),mH("p",{children:mH("a",{className:"site",href:b.origin,children:b.host})})]})]})}({url:b,theme:c,...a}),title:"Verify Request"}),error:a=>f?.error?{redirect:`${f.error}${f.error.includes("?")?"&":"?"}error=${a}`,cookies:e}:mL({cookies:e,theme:c,...function(a){let{url:b,error:c="default",theme:d}=a,e=`${b}/signin`,f={default:{status:200,heading:"Error",message:mH("p",{children:mH("a",{className:"site",href:b?.origin,children:b?.host})})},Configuration:{status:500,heading:"Server error",message:mH("div",{children:[mH("p",{children:"There is a problem with the server configuration."}),mH("p",{children:"Check the server logs for more information."})]})},AccessDenied:{status:403,heading:"Access Denied",message:mH("div",{children:[mH("p",{children:"You do not have permission to sign in."}),mH("p",{children:mH("a",{className:"button",href:e,children:"Sign in"})})]})},Verification:{status:403,heading:"Unable to sign in",message:mH("div",{children:[mH("p",{children:"The sign in link is no longer valid."}),mH("p",{children:"It may have been used already or it may have expired."})]}),signin:mH("a",{className:"button",href:e,children:"Sign in"})}},{status:g,heading:h,message:i,signin:j}=f[c]??f.default;return{status:g,html:mH("div",{className:"error",children:[d?.brandColor&&mH("style",{dangerouslySetInnerHTML:{__html:`
        :root {
          --brand-color: ${d?.brandColor}
        }
      `}}),mH("div",{className:"card",children:[d?.logo&&mH("img",{src:d?.logo,alt:"Logo",className:"logo"}),mH("h1",{children:h}),mH("div",{className:"message",children:i}),j]})]})}}({url:b,theme:c,error:a}),title:"Error"})}}function mN(a,b=Date.now()){return new Date(b+1e3*a)}async function mO(a,b,c,d){if(!c?.providerAccountId||!c.type)throw Error("Missing or invalid provider account");if(!["email","oauth","oidc","webauthn"].includes(c.type))throw Error("Provider not supported");let{adapter:e,jwt:f,events:g,session:{strategy:h,generateSessionToken:i}}=d;if(!e)return{user:b,account:c};let j=c,{createUser:k,updateUser:l,getUser:m,getUserByAccount:n,getUserByEmail:o,linkAccount:p,createSession:q,getSessionAndUser:r,deleteSession:s}=e,t=null,u=null,v=!1,w="jwt"===h;if(a)if(w)try{let b=d.cookies.sessionToken.name;(t=await f.decode({...f,token:a,salt:b}))&&"sub"in t&&t.sub&&(u=await m(t.sub))}catch{}else{let b=await r(a);b&&(t=b.session,u=b.user)}if("email"===j.type){let c=await o(b.email);return c?(u?.id!==c.id&&!w&&a&&await s(a),u=await l({id:c.id,emailVerified:new Date}),await g.updateUser?.({user:u})):(u=await k({...b,emailVerified:new Date}),await g.createUser?.({user:u}),v=!0),{session:t=w?{}:await q({sessionToken:i(),userId:u.id,expires:mN(d.session.maxAge)}),user:u,isNewUser:v}}if("webauthn"===j.type){let a=await n({providerAccountId:j.providerAccountId,provider:j.provider});if(a){if(u){if(a.id===u.id){let a={...j,userId:u.id};return{session:t,user:u,isNewUser:v,account:a}}throw new jp("The account is already associated with another user",{provider:j.provider})}t=w?{}:await q({sessionToken:i(),userId:a.id,expires:mN(d.session.maxAge)});let b={...j,userId:a.id};return{session:t,user:a,isNewUser:v,account:b}}{if(u){await p({...j,userId:u.id}),await g.linkAccount?.({user:u,account:j,profile:b});let a={...j,userId:u.id};return{session:t,user:u,isNewUser:v,account:a}}if(b.email?await o(b.email):null)throw new jp("Another account already exists with the same e-mail address",{provider:j.provider});u=await k({...b}),await g.createUser?.({user:u}),await p({...j,userId:u.id}),await g.linkAccount?.({user:u,account:j,profile:b}),t=w?{}:await q({sessionToken:i(),userId:u.id,expires:mN(d.session.maxAge)});let a={...j,userId:u.id};return{session:t,user:u,isNewUser:!0,account:a}}}let x=await n({providerAccountId:j.providerAccountId,provider:j.provider});if(x){if(u){if(x.id===u.id)return{session:t,user:u,isNewUser:v};throw new ja("The account is already associated with another user",{provider:j.provider})}return{session:t=w?{}:await q({sessionToken:i(),userId:x.id,expires:mN(d.session.maxAge)}),user:x,isNewUser:v}}{let{provider:a}=d,{type:c,provider:e,providerAccountId:f,userId:h,...l}=j;if(j=Object.assign(a.account(l)??{},{providerAccountId:f,provider:e,type:c,userId:h}),u)return await p({...j,userId:u.id}),await g.linkAccount?.({user:u,account:j,profile:b}),{session:t,user:u,isNewUser:v};let m=b.email?await o(b.email):null;if(m){let a=d.provider;if(a?.allowDangerousEmailAccountLinking)u=m,v=!1;else throw new ja("Another account already exists with the same e-mail address",{provider:j.provider})}else u=await k({...b,emailVerified:null}),v=!0;return await g.createUser?.({user:u}),await p({...j,userId:u.id}),await g.linkAccount?.({user:u,account:j,profile:b}),{session:t=w?{}:await q({sessionToken:i(),userId:u.id,expires:mN(d.session.maxAge)}),user:u,isNewUser:v}}}function mP(a,b){if(null==a)return!1;try{return a instanceof b||Object.getPrototypeOf(a)[Symbol.toStringTag]===b.prototype[Symbol.toStringTag]}catch{return!1}}("u"<typeof navigator||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(f="oauth4webapi/v3.8.3");let mQ="ERR_INVALID_ARG_VALUE",mR="ERR_INVALID_ARG_TYPE";function mS(a,b,c){let d=TypeError(a,{cause:c});return Object.assign(d,{code:b}),d}let mT=Symbol(),mU=Symbol(),mV=Symbol(),mW=Symbol(),mX=Symbol(),mY=Symbol();Symbol();let mZ=new TextEncoder,m$=new TextDecoder;function m_(a){return"string"==typeof a?mZ.encode(a):m$.decode(a)}function m0(a){return"string"==typeof a?h(a):g(a)}g=Uint8Array.prototype.toBase64?a=>(a instanceof ArrayBuffer&&(a=new Uint8Array(a)),a.toBase64({alphabet:"base64url",omitPadding:!0})):a=>{a instanceof ArrayBuffer&&(a=new Uint8Array(a));let b=[];for(let c=0;c<a.byteLength;c+=32768)b.push(String.fromCharCode.apply(null,a.subarray(c,c+32768)));return btoa(b.join("")).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},h=Uint8Array.fromBase64?a=>{try{return Uint8Array.fromBase64(a,{alphabet:"base64url"})}catch(a){throw mS("The input to be decoded is not correctly encoded.",mQ,a)}}:a=>{try{let b=atob(a.replace(/-/g,"+").replace(/_/g,"/").replace(/\s/g,"")),c=new Uint8Array(b.length);for(let a=0;a<b.length;a++)c[a]=b.charCodeAt(a);return c}catch(a){throw mS("The input to be decoded is not correctly encoded.",mQ,a)}};class m1 extends Error{code;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=n2,Error.captureStackTrace?.(this,this.constructor)}}class m2 extends Error{code;constructor(a,b){super(a,b),this.name=this.constructor.name,b?.code&&(this.code=b?.code),Error.captureStackTrace?.(this,this.constructor)}}function m3(a,b,c){return new m2(a,{code:b,cause:c})}function m4(a){return!(null===a||"object"!=typeof a||Array.isArray(a))}function m5(a){mP(a,Headers)&&(a=Object.fromEntries(a.entries()));let b=new Headers(a??{});if(f&&!b.has("user-agent")&&b.set("user-agent",f),b.has("authorization"))throw mS('"options.headers" must not include the "authorization" header name',mQ);return b}function m6(a,b){if(void 0!==b){if("function"==typeof b&&(b=b(a.href)),!(b instanceof AbortSignal))throw mS('"options.signal" must return or be an instance of AbortSignal',mR);return b}}function m7(a){return a.includes("//")?a.replace("//","/"):a}async function m8(a,b,c,d){if(!(a instanceof URL))throw mS(`"${b}" must be an instance of URL`,mR);no(a,d?.[mT]!==!0);let e=c(new URL(a.href)),f=m5(d?.headers);return f.set("accept","application/json"),(d?.[mW]||fetch)(e.href,{body:void 0,headers:Object.fromEntries(f.entries()),method:"GET",redirect:"manual",signal:m6(e,d?.signal)})}async function m9(a,b){return m8(a,"issuerIdentifier",a=>{switch(b?.algorithm){case void 0:case"oidc":a.pathname=m7(`${a.pathname}/.well-known/openid-configuration`);break;case"oauth2":!function(a,b,c=!1){"/"===a.pathname?a.pathname=b:a.pathname=m7(`${b}/${c?a.pathname:a.pathname.replace(/(\/)$/,"")}`)}(a,".well-known/oauth-authorization-server");break;default:throw mS('"options.algorithm" must be "oidc" (default), or "oauth2"',mQ)}return a},b)}function na(a,b,c,d,e){try{if("number"!=typeof a||!Number.isFinite(a))throw mS(`${c} must be a number`,mR,e);if(a>0)return;if(b){if(0!==a)throw mS(`${c} must be a non-negative number`,mQ,e);return}throw mS(`${c} must be a positive number`,mQ,e)}catch(a){if(d)throw m3(a.message,d,e);throw a}}function nb(a,b,c,d){try{if("string"!=typeof a)throw mS(`${b} must be a string`,mR,d);if(0===a.length)throw mS(`${b} must not be empty`,mQ,d)}catch(a){if(c)throw m3(a.message,c,d);throw a}}async function nc(a,b){if(!(a instanceof URL)&&a!==oo)throw mS('"expectedIssuerIdentifier" must be an instance of URL',mR);if(!mP(b,Response))throw mS('"response" must be an instance of Response',mR);if(200!==b.status)throw m3('"response" is not a conform Authorization Server Metadata response (unexpected HTTP status code)',n8,b);og(b);let c=await on(b);if(nb(c.issuer,'"response" body "issuer" property',n6,{body:c}),a!==oo&&new URL(c.issuer).href!==a.href)throw m3('"response" body "issuer" property does not match the expected value',od,{expected:a.href,body:c,attribute:"issuer"});return c}function nd(a){var b=a,c="application/json";if(nF(b)!==c)throw function(a,...b){let c='"response" content-type must be ';if(b.length>2){let a=b.pop();c+=`${b.join(", ")}, or ${a}`}else 2===b.length?c+=`${b[0]} or ${b[1]}`:c+=b[0];return m3(c,n7,a)}(b,c)}function ne(){return m0(crypto.getRandomValues(new Uint8Array(32)))}async function nf(a){return nb(a,"codeVerifier"),m0(await crypto.subtle.digest("SHA-256",m_(a)))}function ng(a){let b=a?.[mU];return"number"==typeof b&&Number.isFinite(b)?b:0}function nh(a){let b=a?.[mV];return"number"==typeof b&&Number.isFinite(b)&&-1!==Math.sign(b)?b:30}function ni(){return Math.floor(Date.now()/1e3)}function nj(a){if("object"!=typeof a||null===a)throw mS('"as" must be an object',mR);nb(a.issuer,'"as.issuer"')}function nk(a){if("object"!=typeof a||null===a)throw mS('"client" must be an object',mR);nb(a.client_id,'"client.client_id"')}function nl(a,b){let c=ni()+ng(b);return{jti:ne(),aud:a.issuer,exp:c+60,iat:c,nbf:c,iss:b.client_id,sub:b.client_id}}async function nm(a,b,c){if(!c.usages.includes("sign"))throw mS('CryptoKey instances used for signing assertions must include "sign" in their "usages"',mQ);let d=`${m0(m_(JSON.stringify(a)))}.${m0(m_(JSON.stringify(b)))}`,e=m0(await crypto.subtle.sign(function(a){switch(a.algorithm.name){case"ECDSA":return{name:a.algorithm.name,hash:function(a){let{algorithm:b}=a;switch(b.namedCurve){case"P-256":return"SHA-256";case"P-384":return"SHA-384";case"P-521":return"SHA-512";default:throw new m1("unsupported ECDSA namedCurve",{cause:a})}}(a)};case"RSA-PSS":switch(oh(a),a.algorithm.hash.name){case"SHA-256":case"SHA-384":case"SHA-512":return{name:a.algorithm.name,saltLength:parseInt(a.algorithm.hash.name.slice(-3),10)>>3};default:throw new m1("unsupported RSA-PSS hash name",{cause:a})}case"RSASSA-PKCS1-v1_5":return oh(a),a.algorithm.name;case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":case"Ed25519":return a.algorithm.name}throw new m1("unsupported CryptoKey algorithm name",{cause:a})}(c),c,m_(d)));return`${d}.${e}`}let nn=URL.parse?(a,b)=>URL.parse(a,b):(a,b)=>{try{return new URL(a,b)}catch{return null}};function no(a,b){if(b&&"https:"!==a.protocol)throw m3("only requests to HTTPS are allowed",n9,a);if("https:"!==a.protocol&&"http:"!==a.protocol)throw m3("only HTTP and HTTPS requests are allowed",oa,a)}function np(a,b,c,d){let e;if("string"!=typeof a||!(e=nn(a)))throw m3(`authorization server metadata does not contain a valid ${c?`"as.mtls_endpoint_aliases.${b}"`:`"as.${b}"`}`,void 0===a?oe:of,{attribute:c?`mtls_endpoint_aliases.${b}`:b});return no(e,d),e}function nq(a,b,c,d){return c&&a.mtls_endpoint_aliases&&b in a.mtls_endpoint_aliases?np(a.mtls_endpoint_aliases[b],b,c,d):np(a[b],b,c,d)}class nr extends Error{cause;code;error;status;error_description;response;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=n1,this.cause=b.cause,this.error=b.cause.error,this.status=b.response.status,this.error_description=b.cause.error_description,Object.defineProperty(this,"response",{enumerable:!1,value:b.response}),Error.captureStackTrace?.(this,this.constructor)}}class ns extends Error{cause;code;error;error_description;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=n3,this.cause=b.cause,this.error=b.cause.get("error"),this.error_description=b.cause.get("error_description")??void 0,Error.captureStackTrace?.(this,this.constructor)}}class nt extends Error{cause;code;response;status;constructor(a,b){super(a,b),this.name=this.constructor.name,this.code=n0,this.cause=b.cause,this.status=b.response.status,this.response=b.response,Object.defineProperty(this,"response",{enumerable:!1}),Error.captureStackTrace?.(this,this.constructor)}}let nu="[a-zA-Z0-9!#$%&\\'\\*\\+\\-\\.\\^_`\\|~]+",nv=RegExp("^[,\\s]*("+nu+")"),nw=RegExp("^[,\\s]*("+nu+')\\s*=\\s*"((?:[^"\\\\]|\\\\[\\s\\S])*)"[,\\s]*(.*)'),nx=RegExp("^[,\\s]*"+("("+nu+")\\s*=\\s*(")+nu+")[,\\s]*(.*)"),ny=RegExp("^([a-zA-Z0-9\\-\\._\\~\\+\\/]+={0,2})(?:$|[,\\s])(.*)");async function nz(a){if(a.status>399&&a.status<500){og(a),nd(a);try{let b=await a.clone().json();if(m4(b)&&"string"==typeof b.error&&b.error.length)return b}catch{}}}async function nA(a,b,c){if(a.status!==b){let b;if(nN(a),b=await nz(a))throw await a.body?.cancel(),new nr("server responded with an error in the response body",{cause:b,response:a});throw m3(`"response" is not a conform ${c} response (unexpected HTTP status code)`,n8,a)}}function nB(a){if(!nS.has(a))throw mS('"options.DPoP" is not a valid DPoPHandle',mQ)}async function nC(a,b,c,d,e,f){if(nb(a,'"accessToken"'),!(c instanceof URL))throw mS('"url" must be an instance of URL',mR);no(c,f?.[mT]!==!0),d=m5(d),f?.DPoP&&(nB(f.DPoP),await f.DPoP.addProof(c,d,b.toUpperCase(),a)),d.set("authorization",`${d.has("dpop")?"DPoP":"Bearer"} ${a}`);let g=await (f?.[mW]||fetch)(c.href,{body:e,headers:Object.fromEntries(d.entries()),method:b,redirect:"manual",signal:m6(c,f?.signal)});return f?.DPoP?.cacheNonce(g,c),g}async function nD(a,b,c,d){nj(a),nk(b);let e=nq(a,"userinfo_endpoint",b.use_mtls_endpoint_aliases,d?.[mT]!==!0),f=m5(d?.headers);return b.userinfo_signed_response_alg?f.set("accept","application/jwt"):(f.set("accept","application/json"),f.append("accept","application/jwt")),nC(c,"GET",e,f,null,{...d,[mU]:ng(b)})}let nE=Symbol();function nF(a){return a.headers.get("content-type")?.split(";")[0]}async function nG(a,b,c,d,e){let f;if(nj(a),nk(b),!mP(d,Response))throw mS('"response" must be an instance of Response',mR);if(nN(d),200!==d.status)throw m3('"response" is not a conform UserInfo Endpoint response (unexpected HTTP status code)',n8,d);if(og(d),"application/jwt"===nF(d)){let{claims:c,jwt:g}=await oi(await d.text(),oj.bind(void 0,b.userinfo_signed_response_alg,a.userinfo_signing_alg_values_supported,void 0),ng(b),nh(b),e?.[mY]).then(nO.bind(void 0,b.client_id)).then(nQ.bind(void 0,a));nK.set(d,g),f=c}else{if(b.userinfo_signed_response_alg)throw m3("JWT UserInfo Response expected",n4,d);f=await on(d)}if(nb(f.sub,'"response" body "sub" property',n6,{body:f}),c===nE);else if(nb(c,'"expectedSubject"'),f.sub!==c)throw m3('unexpected "response" body "sub" property value',od,{expected:c,body:f,attribute:"sub"});return f}async function nH(a,b,c,d,e,f,g){return await c(a,b,e,f),f.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"),(g?.[mW]||fetch)(d.href,{body:e,headers:Object.fromEntries(f.entries()),method:"POST",redirect:"manual",signal:m6(d,g?.signal)})}async function nI(a,b,c,d,e,f){let g=nq(a,"token_endpoint",b.use_mtls_endpoint_aliases,f?.[mT]!==!0);e.set("grant_type",d);let h=m5(f?.headers);h.set("accept","application/json"),f?.DPoP!==void 0&&(nB(f.DPoP),await f.DPoP.addProof(g,h,"POST"));let i=await nH(a,b,c,g,e,h,f);return f?.DPoP?.cacheNonce(i,g),i}let nJ=new WeakMap,nK=new WeakMap;function nL(a){if(!a.id_token)return;let b=nJ.get(a);if(!b)throw mS('"ref" was already garbage collected or did not resolve from the proper sources',mQ);return b}async function nM(a,b,c,d,e,f){if(nj(a),nk(b),!mP(c,Response))throw mS('"response" must be an instance of Response',mR);await nA(c,200,"Token Endpoint"),og(c);let g=await on(c);if(nb(g.access_token,'"response" body "access_token" property',n6,{body:g}),nb(g.token_type,'"response" body "token_type" property',n6,{body:g}),g.token_type=g.token_type.toLowerCase(),void 0!==g.expires_in){let a="number"!=typeof g.expires_in?parseFloat(g.expires_in):g.expires_in;na(a,!0,'"response" body "expires_in" property',n6,{body:g}),g.expires_in=a}if(void 0!==g.refresh_token&&nb(g.refresh_token,'"response" body "refresh_token" property',n6,{body:g}),void 0!==g.scope&&"string"!=typeof g.scope)throw m3('"response" body "scope" property must be a string',n6,{body:g});if(void 0!==g.id_token){nb(g.id_token,'"response" body "id_token" property',n6,{body:g});let f=["aud","exp","iat","iss","sub"];!0===b.require_auth_time&&f.push("auth_time"),void 0!==b.default_max_age&&(na(b.default_max_age,!0,'"client.default_max_age"'),f.push("auth_time")),d?.length&&f.push(...d);let{claims:h,jwt:i}=await oi(g.id_token,oj.bind(void 0,b.id_token_signed_response_alg,a.id_token_signing_alg_values_supported,"RS256"),ng(b),nh(b),e).then(nW.bind(void 0,f)).then(nR.bind(void 0,a)).then(nP.bind(void 0,b.client_id));if(Array.isArray(h.aud)&&1!==h.aud.length){if(void 0===h.azp)throw m3('ID Token "aud" (audience) claim includes additional untrusted audiences',oc,{claims:h,claim:"aud"});if(h.azp!==b.client_id)throw m3('unexpected ID Token "azp" (authorized party) claim value',oc,{expected:b.client_id,claims:h,claim:"azp"})}void 0!==h.auth_time&&na(h.auth_time,!0,'ID Token "auth_time" (authentication time)',n6,{claims:h}),nK.set(c,i),nJ.set(g,h)}if(f?.[g.token_type]!==void 0)f[g.token_type](c,g);else if("dpop"!==g.token_type&&"bearer"!==g.token_type)throw new m1("unsupported `token_type` value",{cause:{body:g}});return g}function nN(a){let b;if(b=function(a){if(!mP(a,Response))throw mS('"response" must be an instance of Response',mR);let b=a.headers.get("www-authenticate");if(null===b)return;let c=[],d=b;for(;d;){let a,b=d.match(nv),e=b?.["1"].toLowerCase();if(!e)return;let f=d.substring(b[0].length);if(f&&!f.match(/^[\s,]/))return;let g=f.match(/^\s+(.*)$/),h=!!g;d=g?g[1]:void 0;let i={};if(h)for(;d;){let c,e;if(b=d.match(nw)){if([,c,e,d]=b,e.includes("\\"))try{e=JSON.parse(`"${e}"`)}catch{}i[c.toLowerCase()]=e;continue}if(b=d.match(nx)){[,c,e,d]=b,i[c.toLowerCase()]=e;continue}if(b=d.match(ny)){if(Object.keys(i).length)break;[,a,d]=b;break}return}else d=f||void 0;let j={scheme:e,parameters:i};a&&(j.token68=a),c.push(j)}if(c.length)return c}(a))throw new nt("server responded with a challenge in the WWW-Authenticate HTTP Header",{cause:b,response:a})}function nO(a,b){return void 0!==b.claims.aud?nP(a,b):b}function nP(a,b){if(Array.isArray(b.claims.aud)){if(!b.claims.aud.includes(a))throw m3('unexpected JWT "aud" (audience) claim value',oc,{expected:a,claims:b.claims,claim:"aud"})}else if(b.claims.aud!==a)throw m3('unexpected JWT "aud" (audience) claim value',oc,{expected:a,claims:b.claims,claim:"aud"});return b}function nQ(a,b){return void 0!==b.claims.iss?nR(a,b):b}function nR(a,b){let c=a[op]?.(b)??a.issuer;if(b.claims.iss!==c)throw m3('unexpected JWT "iss" (issuer) claim value',oc,{expected:c,claims:b.claims,claim:"iss"});return b}let nS=new WeakSet,nT=Symbol();async function nU(a,b,c,d,e,f,g){if(nj(a),nk(b),!nS.has(d))throw mS('"callbackParameters" must be an instance of URLSearchParams obtained from "validateAuthResponse()", or "validateJwtAuthResponse()',mQ);nb(e,'"redirectUri"');let h=ok(d,"code");if(!h)throw m3('no authorization code in "callbackParameters"',n6);let i=new URLSearchParams(g?.additionalParameters);return i.set("redirect_uri",e),i.set("code",h),f!==nT&&(nb(f,'"codeVerifier"'),i.set("code_verifier",f)),nI(a,b,c,"authorization_code",i,g)}let nV={aud:"audience",c_hash:"code hash",client_id:"client id",exp:"expiration time",iat:"issued at",iss:"issuer",jti:"jwt id",nonce:"nonce",s_hash:"state hash",sub:"subject",ath:"access token hash",htm:"http method",htu:"http uri",cnf:"confirmation",auth_time:"authentication time"};function nW(a,b){for(let c of a)if(void 0===b.claims[c])throw m3(`JWT "${c}" (${nV[c]}) claim missing`,n6,{claims:b.claims});return b}let nX=Symbol(),nY=Symbol();async function nZ(a,b,c,d){return"string"==typeof d?.expectedNonce||"number"==typeof d?.maxAge||d?.requireIdToken?n$(a,b,c,d.expectedNonce,d.maxAge,d[mY],d.recognizedTokenTypes):n_(a,b,c,d?.[mY],d?.recognizedTokenTypes)}async function n$(a,b,c,d,e,f,g){let h=[];switch(d){case void 0:d=nX;break;case nX:break;default:nb(d,'"expectedNonce" argument'),h.push("nonce")}switch(e??=b.default_max_age){case void 0:e=nY;break;case nY:break;default:na(e,!0,'"maxAge" argument'),h.push("auth_time")}let i=await nM(a,b,c,h,f,g);nb(i.id_token,'"response" body "id_token" property',n6,{body:i});let j=nL(i);if(e!==nY){let a=ni()+ng(b),c=nh(b);if(j.auth_time+e<a-c)throw m3("too much time has elapsed since the last End-User authentication",ob,{claims:j,now:a,tolerance:c,claim:"auth_time"})}if(d===nX){if(void 0!==j.nonce)throw m3('unexpected ID Token "nonce" claim value',oc,{expected:void 0,claims:j,claim:"nonce"})}else if(j.nonce!==d)throw m3('unexpected ID Token "nonce" claim value',oc,{expected:d,claims:j,claim:"nonce"});return i}async function n_(a,b,c,d,e){let f=await nM(a,b,c,void 0,d,e),g=nL(f);if(g){if(void 0!==b.default_max_age){na(b.default_max_age,!0,'"client.default_max_age"');let a=ni()+ng(b),c=nh(b);if(g.auth_time+b.default_max_age<a-c)throw m3("too much time has elapsed since the last End-User authentication",ob,{claims:g,now:a,tolerance:c,claim:"auth_time"})}if(void 0!==g.nonce)throw m3('unexpected ID Token "nonce" claim value',oc,{expected:void 0,claims:g,claim:"nonce"})}return f}let n0="OAUTH_WWW_AUTHENTICATE_CHALLENGE",n1="OAUTH_RESPONSE_BODY_ERROR",n2="OAUTH_UNSUPPORTED_OPERATION",n3="OAUTH_AUTHORIZATION_RESPONSE_ERROR",n4="OAUTH_JWT_USERINFO_EXPECTED",n5="OAUTH_PARSE_ERROR",n6="OAUTH_INVALID_RESPONSE",n7="OAUTH_RESPONSE_IS_NOT_JSON",n8="OAUTH_RESPONSE_IS_NOT_CONFORM",n9="OAUTH_HTTP_REQUEST_FORBIDDEN",oa="OAUTH_REQUEST_PROTOCOL_FORBIDDEN",ob="OAUTH_JWT_TIMESTAMP_CHECK_FAILED",oc="OAUTH_JWT_CLAIM_COMPARISON_FAILED",od="OAUTH_JSON_ATTRIBUTE_COMPARISON_FAILED",oe="OAUTH_MISSING_SERVER_METADATA",of="OAUTH_INVALID_SERVER_METADATA";function og(a){if(a.bodyUsed)throw mS('"response" body has been used already',mQ)}function oh(a){let{algorithm:b}=a;if("number"!=typeof b.modulusLength||b.modulusLength<2048)throw new m1(`unsupported ${b.name} modulusLength`,{cause:a})}async function oi(a,b,c,d,e){let f,g,{0:h,1:i,length:j}=a.split(".");if(5===j)if(void 0!==e)a=await e(a),{0:h,1:i,length:j}=a.split(".");else throw new m1("JWE decryption is not configured",{cause:a});if(3!==j)throw m3("Invalid JWT",n6,a);try{f=JSON.parse(m_(m0(h)))}catch(a){throw m3("failed to parse JWT Header body as base64url encoded JSON",n5,a)}if(!m4(f))throw m3("JWT Header must be a top level object",n6,a);if(b(f),void 0!==f.crit)throw new m1('no JWT "crit" header parameter extensions are supported',{cause:{header:f}});try{g=JSON.parse(m_(m0(i)))}catch(a){throw m3("failed to parse JWT Payload body as base64url encoded JSON",n5,a)}if(!m4(g))throw m3("JWT Payload must be a top level object",n6,a);let k=ni()+c;if(void 0!==g.exp){if("number"!=typeof g.exp)throw m3('unexpected JWT "exp" (expiration time) claim type',n6,{claims:g});if(g.exp<=k-d)throw m3('unexpected JWT "exp" (expiration time) claim value, expiration is past current timestamp',ob,{claims:g,now:k,tolerance:d,claim:"exp"})}if(void 0!==g.iat&&"number"!=typeof g.iat)throw m3('unexpected JWT "iat" (issued at) claim type',n6,{claims:g});if(void 0!==g.iss&&"string"!=typeof g.iss)throw m3('unexpected JWT "iss" (issuer) claim type',n6,{claims:g});if(void 0!==g.nbf){if("number"!=typeof g.nbf)throw m3('unexpected JWT "nbf" (not before) claim type',n6,{claims:g});if(g.nbf>k+d)throw m3('unexpected JWT "nbf" (not before) claim value',ob,{claims:g,now:k,tolerance:d,claim:"nbf"})}if(void 0!==g.aud&&"string"!=typeof g.aud&&!Array.isArray(g.aud))throw m3('unexpected JWT "aud" (audience) claim type',n6,{claims:g});return{header:f,claims:g,jwt:a}}function oj(a,b,c,d){if(void 0!==a){if("string"==typeof a?d.alg!==a:!a.includes(d.alg))throw m3('unexpected JWT "alg" header parameter',n6,{header:d,expected:a,reason:"client configuration"});return}if(Array.isArray(b)){if(!b.includes(d.alg))throw m3('unexpected JWT "alg" header parameter',n6,{header:d,expected:b,reason:"authorization server metadata"});return}if(void 0!==c){if("string"==typeof c?d.alg!==c:"function"==typeof c?!c(d.alg):!c.includes(d.alg))throw m3('unexpected JWT "alg" header parameter',n6,{header:d,expected:c,reason:"default value"});return}throw m3('missing client or server configuration to verify used JWT "alg" header parameter',void 0,{client:a,issuer:b,fallback:c})}function ok(a,b){let{0:c,length:d}=a.getAll(b);if(d>1)throw m3(`"${b}" parameter must be provided only once`,n6);return c}let ol=Symbol(),om=Symbol();async function on(a,b=nd){let c;try{c=await a.json()}catch(c){throw b(a),m3('failed to parse "response" body as JSON',n5,c)}if(!m4(c))throw m3('"response" body must be a top level object',n6,{body:c});return c}let oo=Symbol(),op=Symbol();async function oq(a,b,c){let{cookies:d,logger:e}=c,f=d[a],g=new Date;g.setTime(g.getTime()+9e5),e.debug(`CREATE_${a.toUpperCase()}`,{name:f.name,payload:b,COOKIE_TTL:900,expires:g});let h=await le({...c.jwt,maxAge:900,token:{value:b},salt:f.name}),i={...f.options,expires:g};return{name:f.name,value:h,options:i}}async function or(a,b,c){try{let{logger:d,cookies:e,jwt:f}=c;if(d.debug(`PARSE_${a.toUpperCase()}`,{cookie:b}),!b)throw new i4(`${a} cookie was missing`);let g=await lf({...f,token:b,salt:e[a].name});if(g?.value)return g.value;throw Error("Invalid cookie")}catch(b){throw new i4(`${a} value could not be parsed`,{cause:b})}}function os(a,b,c){let{logger:d,cookies:e}=b,f=e[a];d.debug(`CLEAR_${a.toUpperCase()}`,{cookie:f}),c.push({name:f.name,value:"",options:{...e[a].options,maxAge:0}})}function ot(a,b){return async function(c,d,e){let{provider:f,logger:g}=e;if(!f?.checks?.includes(a))return;let h=c?.[e.cookies[b].name];g.debug(`USE_${b.toUpperCase()}`,{value:h});let i=await or(b,h,e);return os(b,e,d),i}}let ou={async create(a){let b=ne(),c=await nf(b);return{cookie:await oq("pkceCodeVerifier",b,a),value:c}},use:ot("pkce","pkceCodeVerifier")},ov="encodedState",ow={async create(a,b){let{provider:c}=a;if(!c.checks.includes("state")){if(b)throw new i4("State data was provided but the provider is not configured to use state");return}let d={origin:b,random:ne()},e=await le({secret:a.jwt.secret,token:d,salt:ov,maxAge:900});return{cookie:await oq("state",e,a),value:e}},use:ot("state","state"),async decode(a,b){try{b.logger.debug("DECODE_STATE",{state:a});let c=await lf({secret:b.jwt.secret,token:a,salt:ov});if(c)return c;throw Error("Invalid state")}catch(a){throw new i4("State could not be decoded",{cause:a})}}},ox={async create(a){if(!a.provider.checks.includes("nonce"))return;let b=ne();return{cookie:await oq("nonce",b,a),value:b}},use:ot("nonce","nonce")},oy="encodedWebauthnChallenge",oz={create:async(a,b,c)=>({cookie:await oq("webauthnChallenge",await le({secret:a.jwt.secret,token:{challenge:b,registerData:c},salt:oy,maxAge:900}),a)}),async use(a,b,c){let d=b?.[a.cookies.webauthnChallenge.name],e=await or("webauthnChallenge",d,a),f=await lf({secret:a.jwt.secret,token:e,salt:oy});if(os("webauthnChallenge",a,c),!f)throw new i4("WebAuthn challenge was missing");return f}};function oA(a){return encodeURIComponent(a).replace(/%20/g,"+")}async function oB(a,b,c){var d,e;let f,g,h,i,j,{logger:k,provider:l}=c,{token:m,userinfo:n}=l;if(m?.url&&"authjs.dev"!==m.url.host||n?.url&&"authjs.dev"!==n.url.host)f={issuer:l.issuer??"https://authjs.dev",token_endpoint:m?.url.toString(),userinfo_endpoint:n?.url.toString()};else{let a=new URL(l.issuer),b=await m9(a,{[mT]:!0,[mW]:l[lA]});if(!(f=await nc(a,b)).token_endpoint)throw TypeError("TODO: Authorization server did not provide a token endpoint.");if(!f.userinfo_endpoint)throw TypeError("TODO: Authorization server did not provide a userinfo endpoint.")}let o={client_id:l.clientId,...l.client};switch(o.token_endpoint_auth_method){case void 0:case"client_secret_basic":g=(a,b,c,d)=>{var e,f;let g,h,i;d.set("authorization",(e=l.clientId,f=l.clientSecret,g=oA(e),h=oA(f),i=btoa(`${g}:${h}`),`Basic ${i}`))};break;case"client_secret_post":nb(d=l.clientSecret,'"clientSecret"'),g=(a,b,c,e)=>{c.set("client_id",b.client_id),c.set("client_secret",d)};break;case"client_secret_jwt":nb(e=l.clientSecret,'"clientSecret"'),j=void 0,g=async(a,b,c,d)=>{i||=await crypto.subtle.importKey("raw",m_(e),{hash:"SHA-256",name:"HMAC"},!1,["sign"]);let f={alg:"HS256"},g=nl(a,b);j?.(f,g);let h=`${m0(m_(JSON.stringify(f)))}.${m0(m_(JSON.stringify(g)))}`,k=await crypto.subtle.sign(i.algorithm,i,m_(h));c.set("client_id",b.client_id),c.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),c.set("client_assertion",`${h}.${m0(new Uint8Array(k))}`)};break;case"private_key_jwt":g=function(a,b){let{key:c,kid:d}=a instanceof CryptoKey?{key:a}:a?.key instanceof CryptoKey?(void 0!==a.kid&&nb(a.kid,'"kid"'),{key:a.key,kid:a.kid}):{};var e='"clientPrivateKey.key"';if(!(c instanceof CryptoKey))throw mS(`${e} must be a CryptoKey`,mR);if("private"!==c.type)throw mS(`${e} must be a private CryptoKey`,mQ);return async(a,e,f,g)=>{let h={alg:function(a){switch(a.algorithm.name){case"RSA-PSS":switch(a.algorithm.hash.name){case"SHA-256":return"PS256";case"SHA-384":return"PS384";case"SHA-512":return"PS512";default:throw new m1("unsupported RsaHashedKeyAlgorithm hash name",{cause:a})}case"RSASSA-PKCS1-v1_5":switch(a.algorithm.hash.name){case"SHA-256":return"RS256";case"SHA-384":return"RS384";case"SHA-512":return"RS512";default:throw new m1("unsupported RsaHashedKeyAlgorithm hash name",{cause:a})}case"ECDSA":switch(a.algorithm.namedCurve){case"P-256":return"ES256";case"P-384":return"ES384";case"P-521":return"ES512";default:throw new m1("unsupported EcKeyAlgorithm namedCurve",{cause:a})}case"Ed25519":case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return a.algorithm.name;case"EdDSA":return"Ed25519";default:throw new m1("unsupported CryptoKey algorithm name",{cause:a})}}(c),kid:d},i=nl(a,e);b?.[mX]?.(h,i),f.set("client_id",e.client_id),f.set("client_assertion_type","urn:ietf:params:oauth:client-assertion-type:jwt-bearer"),f.set("client_assertion",await nm(h,i,c))}}(l.token.clientPrivateKey,{[mX](a,b){b.aud=[f.issuer,f.token_endpoint]}});break;case"none":g=(a,b,c,d)=>{c.set("client_id",b.client_id)};break;default:throw Error("unsupported client authentication method")}let p=[],q=await ow.use(b,p,c);try{h=function(a,b,c,d){var e;if(nj(a),nk(b),c instanceof URL&&(c=c.searchParams),!(c instanceof URLSearchParams))throw mS('"parameters" must be an instance of URLSearchParams, or URL',mR);if(ok(c,"response"))throw m3('"parameters" contains a JARM response, use validateJwtAuthResponse() instead of validateAuthResponse()',n6,{parameters:c});let f=ok(c,"iss"),g=ok(c,"state");if(!f&&a.authorization_response_iss_parameter_supported)throw m3('response parameter "iss" (issuer) missing',n6,{parameters:c});if(f&&f!==a.issuer)throw m3('unexpected "iss" (issuer) response parameter value',n6,{expected:a.issuer,parameters:c});switch(d){case void 0:case om:if(void 0!==g)throw m3('unexpected "state" response parameter encountered',n6,{expected:void 0,parameters:c});break;case ol:break;default:if(nb(d,'"expectedState" argument'),g!==d)throw m3(void 0===g?'response parameter "state" missing':'unexpected "state" response parameter value',n6,{expected:d,parameters:c})}if(ok(c,"error"))throw new ns("authorization response from the server is an error",{cause:c});let h=ok(c,"id_token"),i=ok(c,"token");if(void 0!==h||void 0!==i)throw new m1("implicit and hybrid flows are not supported");return e=new URLSearchParams(c),nS.add(e),e}(f,o,new URLSearchParams(a),l.checks.includes("state")?q:ol)}catch(a){if(a instanceof ns){let b={providerId:l.id,...Object.fromEntries(a.cause.entries())};throw k.debug("OAuthCallbackError",b),new jb("OAuth Provider returned an error",b)}throw a}let r=await ou.use(b,p,c),s=l.callbackUrl;!c.isOnRedirectProxy&&l.redirectProxyUrl&&(s=l.redirectProxyUrl);let t=await nU(f,o,g,h,s,r??"decoy",{[mT]:!0,[mW]:(...a)=>(l.checks.includes("pkce")||a[1].body.delete("code_verifier"),(l[lA]??fetch)(...a))});l.token?.conform&&(t=await l.token.conform(t.clone())??t);let u={},v="oidc"===l.type;if(l[lB])switch(l.id){case"microsoft-entra-id":case"azure-ad":{let a=await t.clone().json();if(a.error){let b={providerId:l.id,...a};throw new jb(`OAuth Provider returned an error: ${a.error}`,b)}let{tid:b}=function(a){let b,c;if("string"!=typeof a)throw new jT("JWTs must use Compact JWS serialization, JWT must be a string");let{1:d,length:e}=a.split(".");if(5===e)throw new jT("Only JWTs using Compact JWS serialization can be decoded");if(3!==e)throw new jT("Invalid JWT");if(!d)throw new jT("JWTs must contain a payload");try{b=jJ(d)}catch{throw new jT("Failed to base64url decode the payload")}try{c=JSON.parse(jD.decode(b))}catch{throw new jT("Failed to parse the decoded payload as JSON")}if(!kp(c))throw new jT("Invalid JWT Claims Set");return c}(a.id_token);if("string"==typeof b){let a=f.issuer?.match(/microsoftonline\.com\/(\w+)\/v2\.0/)?.[1]??"common",c=new URL(f.issuer.replace(a,b)),d=await m9(c,{[mW]:l[lA]});f=await nc(c,d)}}}let w=await nZ(f,o,t,{expectedNonce:await ox.use(b,p,c),requireIdToken:v});if(v){let b=nL(w);if(u=b,l[lB]&&"apple"===l.id)try{u.user=JSON.parse(a?.user)}catch{}if(!1===l.idToken){let a=await nD(f,o,w.access_token,{[mW]:l[lA],[mT]:!0});u=await nG(f,o,b.sub,a)}}else if(n?.request){let a=await n.request({tokens:w,provider:l});a instanceof Object&&(u=a)}else if(n?.url){let a=await nD(f,o,w.access_token,{[mW]:l[lA],[mT]:!0});u=await a.json()}else throw TypeError("No userinfo endpoint configured");return w.expires_in&&(w.expires_at=Math.floor(Date.now()/1e3)+Number(w.expires_in)),{...await oC(u,l,w,k),profile:u,cookies:p}}async function oC(a,b,c,d){try{let d=await b.profile(a,c);return{user:{...d,id:crypto.randomUUID(),email:d.email?.toLowerCase()},account:{...c,provider:b.id,type:b.type,providerAccountId:d.id??crypto.randomUUID()}}}catch(c){d.debug("getProfile error details",a),d.error(new jc(c,{provider:b.id}))}}async function oD(a,b,c,d){let e=await oI(a,b,c),{cookie:f}=await oz.create(a,e.challenge,c);return{status:200,cookies:[...d??[],f],body:{action:"register",options:e},headers:{"Content-Type":"application/json"}}}async function oE(a,b,c,d){let e=await oH(a,b,c),{cookie:f}=await oz.create(a,e.challenge);return{status:200,cookies:[...d??[],f],body:{action:"authenticate",options:e},headers:{"Content-Type":"application/json"}}}async function oF(a,b,c){let d,{adapter:e,provider:f}=a,g=b.body&&"string"==typeof b.body.data?JSON.parse(b.body.data):void 0;if(!g||"object"!=typeof g||!("id"in g)||"string"!=typeof g.id)throw new iW("Invalid WebAuthn Authentication response");let h=oL(oK(g.id)),i=await e.getAuthenticator(h);if(!i)throw new iW(`WebAuthn authenticator not found in database: ${JSON.stringify({credentialID:h})}`);let{challenge:j}=await oz.use(a,b.cookies,c);try{var k;let c=f.getRelayingParty(a,b);d=await f.simpleWebAuthn.verifyAuthenticationResponse({...f.verifyAuthenticationOptions,expectedChallenge:j,response:g,authenticator:{...k=i,credentialDeviceType:k.credentialDeviceType,transports:oM(k.transports),credentialID:oK(k.credentialID),credentialPublicKey:oK(k.credentialPublicKey)},expectedOrigin:c.origin,expectedRPID:c.id})}catch(a){throw new jo(a)}let{verified:l,authenticationInfo:m}=d;if(!l)throw new jo("WebAuthn authentication response could not be verified");try{let{newCounter:a}=m;await e.updateAuthenticatorCounter(i.credentialID,a)}catch(a){throw new iY(`Failed to update authenticator counter. This may cause future authentication attempts to fail. ${JSON.stringify({credentialID:h,oldCounter:i.counter,newCounter:m.newCounter})}`,a)}let n=await e.getAccount(i.providerAccountId,f.id);if(!n)throw new iW(`WebAuthn account not found in database: ${JSON.stringify({credentialID:h,providerAccountId:i.providerAccountId})}`);let o=await e.getUser(n.userId);if(!o)throw new iW(`WebAuthn user not found in database: ${JSON.stringify({credentialID:h,providerAccountId:i.providerAccountId,userID:n.userId})}`);return{account:n,user:o}}async function oG(a,b,c){var d;let e,{provider:f}=a,g=b.body&&"string"==typeof b.body.data?JSON.parse(b.body.data):void 0;if(!g||"object"!=typeof g||!("id"in g)||"string"!=typeof g.id)throw new iW("Invalid WebAuthn Registration response");let{challenge:h,registerData:i}=await oz.use(a,b.cookies,c);if(!i)throw new iW("Missing user registration data in WebAuthn challenge cookie");try{let c=f.getRelayingParty(a,b);e=await f.simpleWebAuthn.verifyRegistrationResponse({...f.verifyRegistrationOptions,expectedChallenge:h,response:g,expectedOrigin:c.origin,expectedRPID:c.id})}catch(a){throw new jo(a)}if(!e.verified||!e.registrationInfo)throw new jo("WebAuthn registration response could not be verified");let j={providerAccountId:oL(e.registrationInfo.credentialID),provider:a.provider.id,type:f.type},k={providerAccountId:j.providerAccountId,counter:e.registrationInfo.counter,credentialID:oL(e.registrationInfo.credentialID),credentialPublicKey:oL(e.registrationInfo.credentialPublicKey),credentialBackedUp:e.registrationInfo.credentialBackedUp,credentialDeviceType:e.registrationInfo.credentialDeviceType,transports:(d=g.response.transports,d?.join(","))};return{user:i,account:j,authenticator:k}}async function oH(a,b,c){let{provider:d,adapter:e}=a,f=c&&c.id?await e.listAuthenticatorsByUserId(c.id):null,g=d.getRelayingParty(a,b);return await d.simpleWebAuthn.generateAuthenticationOptions({...d.authenticationOptions,rpID:g.id,allowCredentials:f?.map(a=>({id:oK(a.credentialID),type:"public-key",transports:oM(a.transports)}))})}async function oI(a,b,c){let{provider:d,adapter:e}=a,f=c.id?await e.listAuthenticatorsByUserId(c.id):null,g=lt(32),h=d.getRelayingParty(a,b);return await d.simpleWebAuthn.generateRegistrationOptions({...d.registrationOptions,userID:g,userName:c.email,userDisplayName:c.name??void 0,rpID:h.id,rpName:h.name,excludeCredentials:f?.map(a=>({id:oK(a.credentialID),type:"public-key",transports:oM(a.transports)}))})}function oJ(a){let{provider:b,adapter:c}=a;if(!c)throw new i6("An adapter is required for the WebAuthn provider");if(!b||"webauthn"!==b.type)throw new jh("Provider must be WebAuthn");return{...a,provider:b,adapter:c}}function oK(a){return new Uint8Array(Buffer.from(a,"base64"))}function oL(a){return Buffer.from(a).toString("base64")}function oM(a){return a?a.split(","):void 0}async function oN(a,b,c,d){if(!b.provider)throw new jh("Callback route called without provider");let{query:e,body:f,method:g,headers:h}=a,{provider:i,adapter:j,url:k,callbackUrl:l,pages:m,jwt:n,events:o,callbacks:p,session:{strategy:q,maxAge:r},logger:s}=b,t="jwt"===q;try{if("oauth"===i.type||"oidc"===i.type){let g,h=i.authorization?.url.searchParams.get("response_mode")==="form_post"?f:e;if(b.isOnRedirectProxy&&h?.state){let a=await ow.decode(h.state,b);if(a?.origin&&new URL(a.origin).origin!==b.url.origin){let b=`${a.origin}?${new URLSearchParams(h)}`;return s.debug("Proxy redirecting to",b),{redirect:b,cookies:d}}}let q=await oB(h,a.cookies,b);q.cookies.length&&d.push(...q.cookies),s.debug("authorization result",q);let{user:u,account:v,profile:w}=q;if(!u||!v||!w)return{redirect:`${k}/signin`,cookies:d};if(j){let{getUserByAccount:a}=j;g=await a({providerAccountId:v.providerAccountId,provider:i.id})}let x=await oO({user:g??u,account:v,profile:w},b);if(x)return{redirect:x,cookies:d};let{user:y,session:z,isNewUser:A}=await mO(c.value,u,v,b);if(t){let a={name:y.name,email:y.email,picture:y.image,sub:y.id?.toString()},e=await p.jwt({token:a,user:y,account:v,profile:w,isNewUser:A,trigger:A?"signUp":"signIn"});if(null===e)d.push(...c.clean());else{let a=b.cookies.sessionToken.name,f=await n.encode({...n,token:e,salt:a}),g=new Date;g.setTime(g.getTime()+1e3*r);let h=c.chunk(f,{expires:g});d.push(...h)}}else d.push({name:b.cookies.sessionToken.name,value:z.sessionToken,options:{...b.cookies.sessionToken.options,expires:z.expires}});if(await o.signIn?.({user:y,account:v,profile:w,isNewUser:A}),A&&m.newUser)return{redirect:`${m.newUser}${m.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:l})}`,cookies:d};return{redirect:l,cookies:d}}if("email"===i.type){let a=e?.token,f=e?.email;if(!a){let b=TypeError("Missing token. The sign-in URL was manually opened without token or the link was not sent correctly in the email.",{cause:{hasToken:!!a}});throw b.name="Configuration",b}let g=i.secret??b.secret,h=await j.useVerificationToken({identifier:f,token:await ls(`${a}${g}`)}),k=!!h,q=k&&h.expires.valueOf()<Date.now();if(!k||q||f&&h.identifier!==f)throw new jj({hasInvite:k,expired:q});let{identifier:s}=h,u=await j.getUserByEmail(s)??{id:crypto.randomUUID(),email:s,emailVerified:null},v={providerAccountId:u.email,userId:u.id,type:"email",provider:i.id},w=await oO({user:u,account:v},b);if(w)return{redirect:w,cookies:d};let{user:x,session:y,isNewUser:z}=await mO(c.value,u,v,b);if(t){let a={name:x.name,email:x.email,picture:x.image,sub:x.id?.toString()},e=await p.jwt({token:a,user:x,account:v,isNewUser:z,trigger:z?"signUp":"signIn"});if(null===e)d.push(...c.clean());else{let a=b.cookies.sessionToken.name,f=await n.encode({...n,token:e,salt:a}),g=new Date;g.setTime(g.getTime()+1e3*r);let h=c.chunk(f,{expires:g});d.push(...h)}}else d.push({name:b.cookies.sessionToken.name,value:y.sessionToken,options:{...b.cookies.sessionToken.options,expires:y.expires}});if(await o.signIn?.({user:x,account:v,isNewUser:z}),z&&m.newUser)return{redirect:`${m.newUser}${m.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:l})}`,cookies:d};return{redirect:l,cookies:d}}if("credentials"===i.type&&"POST"===g){let a=f??{};Object.entries(e??{}).forEach(([a,b])=>k.searchParams.set(a,b));let j=await i.authorize(a,new Request(k,{headers:h,method:g,body:JSON.stringify(f)}));if(j)j.id=j.id?.toString()??crypto.randomUUID();else throw new i2;let m={providerAccountId:j.id,type:"credentials",provider:i.id},q=await oO({user:j,account:m,credentials:a},b);if(q)return{redirect:q,cookies:d};let s={name:j.name,email:j.email,picture:j.image,sub:j.id},t=await p.jwt({token:s,user:j,account:m,isNewUser:!1,trigger:"signIn"});if(null===t)d.push(...c.clean());else{let a=b.cookies.sessionToken.name,e=await n.encode({...n,token:t,salt:a}),f=new Date;f.setTime(f.getTime()+1e3*r);let g=c.chunk(e,{expires:f});d.push(...g)}return await o.signIn?.({user:j,account:m}),{redirect:l,cookies:d}}else if("webauthn"===i.type&&"POST"===g){let e,f,g,h=a.body?.action;if("string"!=typeof h||"authenticate"!==h&&"register"!==h)throw new iW("Invalid action parameter");let i=oJ(b);switch(h){case"authenticate":{let b=await oF(i,a,d);e=b.user,f=b.account;break}case"register":{let c=await oG(b,a,d);e=c.user,f=c.account,g=c.authenticator}}await oO({user:e,account:f},b);let{user:j,isNewUser:k,session:q,account:s}=await mO(c.value,e,f,b);if(!s)throw new iW("Error creating or finding account");if(g&&j.id&&await i.adapter.createAuthenticator({...g,userId:j.id}),t){let a={name:j.name,email:j.email,picture:j.image,sub:j.id?.toString()},e=await p.jwt({token:a,user:j,account:s,isNewUser:k,trigger:k?"signUp":"signIn"});if(null===e)d.push(...c.clean());else{let a=b.cookies.sessionToken.name,f=await n.encode({...n,token:e,salt:a}),g=new Date;g.setTime(g.getTime()+1e3*r);let h=c.chunk(f,{expires:g});d.push(...h)}}else d.push({name:b.cookies.sessionToken.name,value:q.sessionToken,options:{...b.cookies.sessionToken.options,expires:q.expires}});if(await o.signIn?.({user:j,account:s,isNewUser:k}),k&&m.newUser)return{redirect:`${m.newUser}${m.newUser.includes("?")?"&":"?"}${new URLSearchParams({callbackUrl:l})}`,cookies:d};return{redirect:l,cookies:d}}throw new jh(`Callback for provider type (${i.type}) is not supported`)}catch(b){if(b instanceof iW)throw b;let a=new i$(b,{provider:i.id});throw s.debug("callback route error details",{method:g,query:e,body:f}),a}}async function oO(a,b){let c,{signIn:d,redirect:e}=b.callbacks;try{c=await d(a)}catch(a){if(a instanceof iW)throw a;throw new iZ(a)}if(!c)throw new iZ("AccessDenied");if("string"==typeof c)return await e({url:c,baseUrl:b.url.origin})}async function oP(a,b,c,d,e){let{adapter:f,jwt:g,events:h,callbacks:i,logger:j,session:{strategy:k,maxAge:l}}=a,m={body:null,headers:{"Content-Type":"application/json",...!d&&{"Cache-Control":"private, no-cache, no-store",Expires:"0",Pragma:"no-cache"}},cookies:c},n=b.value;if(!n)return m;if("jwt"===k){try{let c=a.cookies.sessionToken.name,f=await g.decode({...g,token:n,salt:c});if(!f)throw Error("Invalid JWT");let j=await i.jwt({token:f,...d&&{trigger:"update"},session:e}),k=mN(l);if(null!==j){let a={user:{name:j.name,email:j.email,image:j.picture},expires:k.toISOString()},d=await i.session({session:a,token:j});m.body=d;let e=await g.encode({...g,token:j,salt:c}),f=b.chunk(e,{expires:k});m.cookies?.push(...f),await h.session?.({session:d,token:j})}else m.cookies?.push(...b.clean())}catch(a){j.error(new i5(a)),m.cookies?.push(...b.clean())}return m}try{let{getSessionAndUser:c,deleteSession:g,updateSession:j}=f,k=await c(n);if(k&&k.session.expires.valueOf()<Date.now()&&(await g(n),k=null),k){let{user:b,session:c}=k,f=a.session.updateAge,g=c.expires.valueOf()-1e3*l+1e3*f,o=mN(l);g<=Date.now()&&await j({sessionToken:n,expires:o});let p=await i.session({session:{...c,user:b},user:b,newSession:e,...d?{trigger:"update"}:{}});m.body=p,m.cookies?.push({name:a.cookies.sessionToken.name,value:n,options:{...a.cookies.sessionToken.options,expires:o}}),await h.session?.({session:p})}else n&&m.cookies?.push(...b.clean())}catch(a){j.error(new jd(a))}return m}async function oQ(a,b){let c,d,{logger:e,provider:f}=b,g=f.authorization?.url;if(!g||"authjs.dev"===g.host){let a=new URL(f.issuer),b=await m9(a,{[mW]:f[lA],[mT]:!0}),c=await nc(a,b).catch(b=>{if(!(b instanceof TypeError)||"Invalid URL"!==b.message)throw b;throw TypeError(`Discovery request responded with an invalid issuer. expected: ${a}`)});if(!c.authorization_endpoint)throw TypeError("Authorization server did not provide an authorization endpoint.");g=new URL(c.authorization_endpoint)}let h=g.searchParams,i=f.callbackUrl;!b.isOnRedirectProxy&&f.redirectProxyUrl&&(i=f.redirectProxyUrl,d=f.callbackUrl,e.debug("using redirect proxy",{redirect_uri:i,data:d}));let j=Object.assign({response_type:"code",client_id:f.clientId,redirect_uri:i,...f.authorization?.params},Object.fromEntries(f.authorization?.url.searchParams??[]),a);for(let a in j)h.set(a,j[a]);let k=[];f.authorization?.url.searchParams.get("response_mode")==="form_post"&&(b.cookies.state.options.sameSite="none",b.cookies.state.options.secure=!0,b.cookies.nonce.options.sameSite="none",b.cookies.nonce.options.secure=!0);let l=await ow.create(b,d);if(l&&(h.set("state",l.value),k.push(l.cookie)),f.checks?.includes("pkce"))if(c&&!c.code_challenge_methods_supported?.includes("S256"))"oidc"===f.type&&(f.checks=["nonce"]);else{let{value:a,cookie:c}=await ou.create(b);h.set("code_challenge",a),h.set("code_challenge_method","S256"),k.push(c)}let m=await ox.create(b);return m&&(h.set("nonce",m.value),k.push(m.cookie)),"oidc"!==f.type||g.searchParams.has("scope")||g.searchParams.set("scope","openid profile email"),e.debug("authorization url is ready",{url:g,cookies:k,provider:f}),{redirect:g.toString(),cookies:k}}async function oR(a,b){let c,{body:d}=a,{provider:e,callbacks:f,adapter:g}=b,h=(e.normalizeIdentifier??function(a){if(!a)throw Error("Missing email from request body.");let b=a.toLowerCase().trim();if(b.includes('"'))throw Error("Invalid email address format.");let[c,d]=b.split("@");if(!c||!d||2!==b.split("@").length||!(d=d.split(",")[0]))throw Error("Invalid email address format.");return`${c}@${d}`})(d?.email),i={id:crypto.randomUUID(),email:h,emailVerified:null},j=await g.getUserByEmail(h)??i,k={providerAccountId:h,userId:j.id,type:"email",provider:e.id};try{c=await f.signIn({user:j,account:k,email:{verificationRequest:!0}})}catch(a){throw new iZ(a)}if(!c)throw new iZ("AccessDenied");if("string"==typeof c)return{redirect:await f.redirect({url:c,baseUrl:b.url.origin})};let{callbackUrl:l,theme:m}=b,n=await e.generateVerificationToken?.()??lt(32),o=new Date(Date.now()+(e.maxAge??86400)*1e3),p=e.secret??b.secret,q=new URL(b.basePath,b.url.origin),r=e.sendVerificationRequest({identifier:h,token:n,expires:o,url:`${q}/callback/${e.id}?${new URLSearchParams({callbackUrl:l,token:n,email:h})}`,provider:e,theme:m,request:new Request(a.url,{headers:a.headers,method:a.method,body:"POST"===a.method?JSON.stringify(a.body??{}):void 0})}),s=g.createVerificationToken?.({identifier:h,token:await ls(`${n}${p}`),expires:o});return await Promise.all([r,s]),{redirect:`${q}/verify-request?${new URLSearchParams({provider:e.id,type:e.type})}`}}async function oS(a,b,c){let d=`${c.url.origin}${c.basePath}/signin`;if(!c.provider)return{redirect:d,cookies:b};switch(c.provider.type){case"oauth":case"oidc":{let{redirect:d,cookies:e}=await oQ(a.query,c);return e&&b.push(...e),{redirect:d,cookies:b}}case"email":return{...await oR(a,c),cookies:b};default:return{redirect:d,cookies:b}}}async function oT(a,b,c){let{jwt:d,events:e,callbackUrl:f,logger:g,session:h}=c,i=b.value;if(!i)return{redirect:f,cookies:a};try{if("jwt"===h.strategy){let a=c.cookies.sessionToken.name,b=await d.decode({...d,token:i,salt:a});await e.signOut?.({token:b})}else{let a=await c.adapter?.deleteSession(i);await e.signOut?.({session:a})}}catch(a){g.error(new je(a))}return a.push(...b.clean()),{redirect:f,cookies:a}}async function oU(a,b){let{adapter:c,jwt:d,session:{strategy:e}}=a,f=b.value;if(!f)return null;if("jwt"===e){let b=a.cookies.sessionToken.name,c=await d.decode({...d,token:f,salt:b});if(c&&c.sub)return{id:c.sub,name:c.name,email:c.email,image:c.picture}}else{let a=await c?.getSessionAndUser(f);if(a)return a.user}return null}async function oV(a,b,c,d){let e=oJ(b),{provider:f}=e,{action:g}=a.query??{};if("register"!==g&&"authenticate"!==g&&void 0!==g)return{status:400,body:{error:"Invalid action"},cookies:d,headers:{"Content-Type":"application/json"}};let h=await oU(b,c),i=h?{user:h,exists:!0}:await f.getUserInfo(b,a),j=i?.user;switch(function(a,b,c){let{user:d,exists:e=!1}=c??{};switch(a){case"authenticate":return"authenticate";case"register":if(d&&b===e)return"register";break;case void 0:if(!b)if(!d)return"authenticate";else if(e)return"authenticate";else return"register"}return null}(g,!!h,i)){case"authenticate":return oE(e,a,j,d);case"register":if("string"==typeof j?.email)return oD(e,a,j,d);break;default:return{status:400,body:{error:"Invalid request"},cookies:d,headers:{"Content-Type":"application/json"}}}}async function oW(a,b){let{action:c,providerId:d,error:e,method:f}=a,g=b.skipCSRFCheck===ly,{options:h,cookies:i}=await lH({authOptions:b,action:c,providerId:d,url:a.url,callbackUrl:a.body?.callbackUrl??a.query?.callbackUrl,csrfToken:a.body?.csrfToken,cookies:a.cookies,isPost:"POST"===f,csrfDisabled:g}),j=new iV(h.cookies.sessionToken,a.cookies,h.logger);if("GET"===f){let b=mM({...h,query:a.query,cookies:i});switch(c){case"callback":return await oN(a,h,j,i);case"csrf":return b.csrf(g,h,i);case"error":return b.error(e);case"providers":return b.providers(h.providers);case"session":return await oP(h,j,i);case"signin":return b.signin(d,e);case"signout":return b.signout();case"verify-request":return b.verifyRequest();case"webauthn-options":return await oV(a,h,j,i)}}else{let{csrfTokenVerified:b}=h;switch(c){case"callback":return"credentials"===h.provider.type&&lv(c,b),await oN(a,h,j,i);case"session":return lv(c,b),await oP(h,j,i,!0,a.body?.data);case"signin":return lv(c,b),await oS(a,i,h);case"signout":return lv(c,b),await oT(i,j,h)}}throw new jf(`Cannot handle action: ${c}`)}function oX(a,b,c,d,e){let f,g=e?.basePath,h=d.AUTH_URL??d.NEXTAUTH_URL;if(h)f=new URL(h),g&&"/"!==g&&"/"!==f.pathname&&(f.pathname!==g&&ll(e).warn("env-url-basepath-mismatch"),f.pathname="/");else{let a=c.get("x-forwarded-host")??c.get("host"),d=c.get("x-forwarded-proto")??b??"https",e=d.endsWith(":")?d:d+":";f=new URL(`${e}//${a}`)}let i=f.toString().replace(/\/$/,"");if(g){let b=g?.replace(/(^\/|\/$)/g,"")??"";return new URL(`${i}/${b}/${a}`)}return new URL(`${i}/${a}`)}async function oY(a,b){let c=ll(b),d=await lq(a,b);if(!d)return Response.json("Bad request.",{status:400});let e=function(a,b){let{url:c}=a,d=[];if(!jr&&b.debug&&d.push("debug-enabled"),!b.trustHost)return new ji(`Host must be trusted. URL was: ${a.url}`);if(!b.secret?.length)return new i9("Please define a `secret`");let e=a.query?.callbackUrl;if(e&&!js(e,c.origin))return new i1(`Invalid callback URL. Received: ${e}`);let{callbackUrl:f}=iU(b.useSecureCookies??"https:"===c.protocol),g=a.cookies?.[b.cookies?.callbackUrl?.name??f.name];if(g&&!js(g,c.origin))return new i1(`Invalid callback URL. Received: ${g}`);let h=!1;for(let a of b.providers){let b="function"==typeof a?a():a;if(("oauth"===b.type||"oidc"===b.type)&&!(b.issuer??b.options?.issuer)){let a,{authorization:c,token:d,userinfo:e}=b;if("string"==typeof c||c?.url?"string"==typeof d||d?.url?"string"==typeof e||e?.url||(a="userinfo"):a="token":a="authorization",a)return new i3(`Provider "${b.id}" is missing both \`issuer\` and \`${a}\` endpoint config. At least one of them is required`)}if("credentials"===b.type)jt=!0;else if("email"===b.type)ju=!0;else if("webauthn"===b.type){var i;if(jv=!0,b.simpleWebAuthnBrowserVersion&&(i=b.simpleWebAuthnBrowserVersion,!/^v\d+(?:\.\d+){0,2}$/.test(i)))return new iW(`Invalid provider config for "${b.id}": simpleWebAuthnBrowserVersion "${b.simpleWebAuthnBrowserVersion}" must be a valid semver string.`);if(b.enableConditionalUI){if(h)return new jm("Multiple webauthn providers have 'enableConditionalUI' set to True. Only one provider can have this option enabled at a time");if(h=!0,!Object.values(b.formFields).some(a=>a.autocomplete&&a.autocomplete.toString().indexOf("webauthn")>-1))return new jn(`Provider "${b.id}" has 'enableConditionalUI' set to True, but none of its formFields have 'webauthn' in their autocomplete param`)}}}if(jt){let a=b.session?.strategy==="database",c=!b.providers.some(a=>"credentials"!==("function"==typeof a?a():a).type);if(a&&c)return new jg("Signing in with credentials only supported if JWT strategy is enabled");if(b.providers.some(a=>{let b="function"==typeof a?a():a;return"credentials"===b.type&&!b.authorize}))return new i8("Must define an authorize() handler to use credentials authentication provider")}let{adapter:j,session:k}=b,l=[];if(ju||k?.strategy==="database"||!k?.strategy&&j)if(ju){if(!j)return new i6("Email login requires an adapter");l.push(...jw)}else{if(!j)return new i6("Database session requires an adapter");l.push(...jx)}if(jv){if(!b.experimental?.enableWebAuthn)return new jq("WebAuthn is an experimental feature. To enable it, set `experimental.enableWebAuthn` to `true` in your config");if(d.push("experimental-webauthn"),!j)return new i6("WebAuthn requires an adapter");l.push(...jy)}if(j){let a=l.filter(a=>!(a in j));if(a.length)return new i7(`Required adapter methods were missing: ${a.join(", ")}`)}return jr||(jr=!0),d}(d,b);if(Array.isArray(e))e.forEach(c.warn);else if(e){if(c.error(e),!new Set(["signin","signout","error","verify-request"]).has(d.action)||"GET"!==d.method)return Response.json({message:"There was a problem with the server configuration. Check the server logs for more information."},{status:500});let{pages:a,theme:f}=b,g=a?.error&&d.url.searchParams.get("callbackUrl")?.startsWith(a.error);if(!a?.error||g)return g&&c.error(new i_(`The error page ${a?.error} should not require authentication`)),lr(mM({theme:f}).error("Configuration"));let h=`${d.url.origin}${a.error}?error=Configuration`;return Response.redirect(h)}let f=a.headers?.has("X-Auth-Return-Redirect"),g=b.raw===lz;try{let a=await oW(d,b);if(g)return a;let c=lr(a),e=c.headers.get("Location");if(!f||!e)return c;return Response.json({url:e},{headers:c.headers})}catch(l){c.error(l);let e=l instanceof iW;if(e&&g&&!f)throw l;if("POST"===a.method&&"session"===d.action)return Response.json(null,{status:400});let h=new URLSearchParams({error:l instanceof iW&&jl.has(l.type)?l.type:"Configuration"});l instanceof i2&&h.set("code",l.code);let i=e&&l.kind||"error",j=b.pages?.[i]??`${b.basePath}/${i.toLowerCase()}`,k=`${d.url.origin}${j}?${h}`;if(f)return Response.json({url:k});return Response.redirect(k)}}var oZ=a.i(92229);function o$(a){let b=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!b)return a;let{origin:c}=new URL(b),{href:d,origin:e}=a.nextUrl;return new oZ.NextRequest(d.replace(e,c),a)}function o_(a){try{a.secret??(a.secret=process.env.AUTH_SECRET??process.env.NEXTAUTH_SECRET);let b=process.env.AUTH_URL??process.env.NEXTAUTH_URL;if(!b)return;let{pathname:c}=new URL(b);if("/"===c)return;a.basePath||(a.basePath=c)}catch{}finally{a.basePath||(a.basePath="/api/auth"),function(a,b,c=!1){try{let d=a.AUTH_URL;d&&(b.basePath?c||ll(b).warn("env-url-basepath-redundant"):b.basePath=new URL(d).pathname)}catch{}finally{b.basePath??(b.basePath="/auth")}if(!b.secret?.length){b.secret=[];let c=a.AUTH_SECRET;for(let d of(c&&b.secret.push(c),[1,2,3])){let c=a[`AUTH_SECRET_${d}`];c&&b.secret.unshift(c)}}b.redirectProxyUrl??(b.redirectProxyUrl=a.AUTH_REDIRECT_PROXY_URL),b.trustHost??(b.trustHost=!!(a.AUTH_URL??a.AUTH_TRUST_HOST??a.VERCEL??a.CF_PAGES??"production"!==a.NODE_ENV)),b.providers=b.providers.map(b=>{let{id:c}="function"==typeof b?b({}):b,d=c.toUpperCase().replace(/-/g,"_"),e=a[`AUTH_${d}_ID`],f=a[`AUTH_${d}_SECRET`],g=a[`AUTH_${d}_ISSUER`],h=a[`AUTH_${d}_KEY`],i="function"==typeof b?b({clientId:e,clientSecret:f,issuer:g,apiKey:h}):b;return"oauth"===i.type||"oidc"===i.type?(i.clientId??(i.clientId=e),i.clientSecret??(i.clientSecret=f),i.issuer??(i.issuer=g)):"email"===i.type&&(i.apiKey??(i.apiKey=h)),i})}(process.env,a,!0)}}var o0=a.i(56030);async function o1(a,b){return oY(new Request(oX("session",a.get("x-forwarded-proto"),a,process.env,b),{headers:{cookie:a.get("cookie")??""}}),{...b,callbacks:{...b.callbacks,async session(...a){let c=await b.callbacks?.session?.(...a)??{...a[0].session,expires:a[0].session.expires?.toISOString?.()??a[0].session.expires};return{user:a[0].user??a[0].token,...c}}}})}function o2(a){return"function"==typeof a}function o3(a,b){return"function"==typeof a?async(...c)=>{if(!c.length){let c=await (0,o0.headers)(),d=await a(void 0);return b?.(d),o1(c,d).then(a=>a.json())}if(c[0]instanceof Request){let d=c[0],e=c[1],f=await a(d);return b?.(f),o4([d,e],f)}if(o2(c[0])){let d=c[0];return async(...c)=>{let e=await a(c[0]);return b?.(e),o4(c,e,d)}}let d="req"in c[0]?c[0].req:c[0],e="res"in c[0]?c[0].res:c[1],f=await a(d);return b?.(f),o1(new Headers(d.headers),f).then(async a=>{let b=await a.json();for(let b of a.headers.getSetCookie())"headers"in e?e.headers.append("set-cookie",b):e.appendHeader("set-cookie",b);return b})}:(...b)=>{if(!b.length)return Promise.resolve((0,o0.headers)()).then(b=>o1(b,a).then(a=>a.json()));if(b[0]instanceof Request)return o4([b[0],b[1]],a);if(o2(b[0])){let c=b[0];return async(...b)=>o4(b,a,c).then(a=>a)}let c="req"in b[0]?b[0].req:b[0],d="res"in b[0]?b[0].res:b[1];return o1(new Headers(c.headers),a).then(async a=>{let b=await a.json();for(let b of a.headers.getSetCookie())"headers"in d?d.headers.append("set-cookie",b):d.appendHeader("set-cookie",b);return b})}}async function o4(a,b,c){let d=o$(a[0]),e=await o1(d.headers,b),f=await e.json(),g=!0;b.callbacks?.authorized&&(g=await b.callbacks.authorized({request:d,auth:f}));let h=oZ.NextResponse.next?.();if(g instanceof Response){var i,j,k;let a,c;h=g;let e=g.headers.get("Location"),{pathname:f}=d.nextUrl;e&&(i=f,j=new URL(e).pathname,k=b,a=j.replace(`${i}/`,""),c=Object.values(k.pages??{}),(o5.has(a)||c.includes(j))&&j===i)&&(g=!0)}else if(c)d.auth=f,h=await c(d,a[1])??oZ.NextResponse.next();else if(!g){let a=b.pages?.signIn??`${b.basePath}/signin`;if(d.nextUrl.pathname!==a){let b=d.nextUrl.clone();b.pathname=a,b.searchParams.set("callbackUrl",d.nextUrl.href),h=oZ.NextResponse.redirect(b)}}let l=new Response(h?.body,h);for(let a of e.headers.getSetCookie())l.headers.append("set-cookie",a);return l}let o5=new Set(["providers","session","csrf","signin","signout","callback","verify-request","error"]);var o6=a.i(20145);async function o7(a,b={},c,d){let e=new Headers(await (0,o0.headers)()),{redirect:f=!0,redirectTo:g,...h}=b instanceof FormData?Object.fromEntries(b):b,i=g?.toString()??e.get("Referer")??"/",j=oX("signin",e.get("x-forwarded-proto"),e,process.env,d);if(!a)return j.searchParams.append("callbackUrl",i),f&&(0,o6.redirect)(j.toString()),j.toString();let k=`${j}/${a}?${new URLSearchParams(c)}`,l={};for(let b of d.providers){let{options:c,...d}="function"==typeof b?b():b,e=c?.id??d.id;if(e===a){l={id:e,type:c?.type??d.type};break}}if(!l.id){let a=`${j}?${new URLSearchParams({callbackUrl:i})}`;return f&&(0,o6.redirect)(a),a}"credentials"===l.type&&(k=k.replace("signin","callback")),e.set("Content-Type","application/x-www-form-urlencoded");let m=new Request(k,{method:"POST",headers:e,body:new URLSearchParams({...h,callbackUrl:i})}),n=await oY(m,{...d,raw:lz,skipCSRFCheck:ly}),o=await (0,o0.cookies)();for(let a of n?.cookies??[])o.set(a.name,a.value,a.options);let p=(n instanceof Response?n.headers.get("Location"):n.redirect)??k;return f?(0,o6.redirect)(p):p}async function o8(a,b){let c=new Headers(await (0,o0.headers)());c.set("Content-Type","application/x-www-form-urlencoded");let d=oX("signout",c.get("x-forwarded-proto"),c,process.env,b),e=new URLSearchParams({callbackUrl:a?.redirectTo??c.get("Referer")??"/"}),f=new Request(d,{method:"POST",headers:c,body:e}),g=await oY(f,{...b,raw:lz,skipCSRFCheck:ly}),h=await (0,o0.cookies)();for(let a of g?.cookies??[])h.set(a.name,a.value,a.options);return a?.redirect??!0?(0,o6.redirect)(g.redirect):g}async function o9(a,b){let c=new Headers(await (0,o0.headers)());c.set("Content-Type","application/json");let d=new Request(oX("session",c.get("x-forwarded-proto"),c,process.env,b),{method:"POST",headers:c,body:JSON.stringify({data:a})}),e=await oY(d,{...b,raw:lz,skipCSRFCheck:ly}),f=await (0,o0.cookies)();for(let a of e?.cookies??[])f.set(a.name,a.value,a.options);return e.body}let{handlers:pa,auth:pb,signIn:pc,signOut:pd}=function(a){if("function"==typeof a){let b=async b=>{let c=await a(b);return o_(c),oY(o$(b),c)};return{handlers:{GET:b,POST:b},auth:o3(a,a=>o_(a)),signIn:async(b,c,d)=>{let e=await a(void 0);return o_(e),o7(b,c,d,e)},signOut:async b=>{let c=await a(void 0);return o_(c),o8(b,c)},unstable_update:async b=>{let c=await a(void 0);return o_(c),o9(b,c)}}}o_(a);let b=b=>oY(o$(b),a);return{handlers:{GET:b,POST:b},auth:o3(a),signIn:(b,c,d)=>o7(b,c,d,a),signOut:b=>o8(b,a),unstable_update:b=>o9(b,a)}}({adapter:function(a,b){if(aK(a,hA))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??g8("user",{id:g2("id",{length:255}).primaryKey().$defaultFn(()=>crypto.randomUUID()),name:g2("name",{length:255}),email:g2("email",{length:255}).unique(),emailVerified:gV("emailVerified",{mode:"date",fsp:3}),image:g2("image",{length:255})}),c=a.accountsTable??g8("account",{userId:g2("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),type:g2("type",{length:255}).$type().notNull(),provider:g2("provider",{length:255}).notNull(),providerAccountId:g2("providerAccountId",{length:255}).notNull(),refresh_token:g2("refresh_token",{length:255}),access_token:g2("access_token",{length:255}),expires_at:gq("expires_at"),token_type:g2("token_type",{length:255}),scope:g2("scope",{length:255}),id_token:g2("id_token",{length:2048}),session_state:g2("session_state",{length:255})},a=>({compositePk:g9({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??g8("session",{sessionToken:g2("sessionToken",{length:255}).primaryKey(),userId:g2("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),expires:gV("expires",{mode:"date"}).notNull()}),e=a.verificationTokensTable??g8("verificationToken",{identifier:g2("identifier",{length:255}).notNull(),token:g2("token",{length:255}).notNull(),expires:gV("expires",{mode:"date"}).notNull()},a=>({compositePk:g9({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??g8("authenticator",{credentialID:g2("credentialID",{length:255}).notNull().unique(),userId:g2("userId",{length:255}).notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:g2("providerAccountId",{length:255}).notNull(),credentialPublicKey:g2("credentialPublicKey",{length:255}).notNull(),counter:gq("counter").notNull(),credentialDeviceType:g2("credentialDeviceType",{length:255}).notNull(),credentialBackedUp:fR("credentialBackedUp").notNull(),transports:g2("transports",{length:255})},a=>({compositePk:g9({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=bO(c).id.defaultFn,[g]=await a.insert(c).values(f?e:{...e,id:d}).$returningId();return a.select().from(c).where(d3(c.id,g?g.id:d)).then(a=>a[0])},getUser:async b=>a.select().from(c).where(d3(c.id,b)).then(a=>a.length>0?a[0]:null),getUserByEmail:async b=>a.select().from(c).where(d3(c.email,b)).then(a=>a.length>0?a[0]:null),createSession:async b=>(await a.insert(e).values(b),a.select().from(e).where(d3(e.sessionToken,b.sessionToken)).then(a=>a[0])),getSessionAndUser:async b=>a.select({session:e,user:c}).from(e).where(d3(e.sessionToken,b)).innerJoin(c,d3(c.id,e.userId)).then(a=>a.length>0?a[0]:null),async updateUser(b){if(!b.id)throw Error("No user id.");await a.update(c).set(b).where(d3(c.id,b.id));let[d]=await a.select().from(c).where(d3(c.id,b.id));if(!d)throw Error("No user found.");return d},updateSession:async b=>(await a.update(e).set(b).where(d3(e.sessionToken,b.sessionToken)),a.select().from(e).where(d3(e.sessionToken,b.sessionToken)).then(a=>a[0])),async linkAccount(b){await a.insert(d).values(b)},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,d3(d.userId,c.id)).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId))).then(a=>a[0]);return e?.user??null},async deleteSession(b){await a.delete(e).where(d3(e.sessionToken,b))},createVerificationToken:async b=>(await a.insert(f).values(b),a.select().from(f).where(d3(f.identifier,b.identifier)).then(a=>a[0])),async useVerificationToken(b){let c=await a.select().from(f).where(d5(d3(f.identifier,b.identifier),d3(f.token,b.token))).then(a=>a.length>0?a[0]:null);return c&&await a.delete(f).where(d5(d3(f.identifier,b.identifier),d3(f.token,b.token))),c},async deleteUser(b){await a.delete(c).where(d3(c.id,b))},async unlinkAccount(b){await a.delete(d).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId)))},getAccount:async(b,c)=>a.select().from(d).where(d5(d3(d.provider,c),d3(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>(await a.insert(g).values(b),await a.select().from(g).where(d3(g.credentialID,b.credentialID)).then(a=>a[0]??null)),getAuthenticator:async b=>await a.select().from(g).where(d3(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>await a.select().from(g).where(d3(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){await a.update(g).set({counter:c}).where(d3(g.credentialID,b));let d=await a.select().from(g).where(d3(g.credentialID,b)).then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,b);if(aK(a,e6))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??dM("user",{id:dh("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:dh("name"),email:dh("email").unique(),emailVerified:dq("emailVerified",{mode:"date"}),image:dh("image")}),c=a.accountsTable??dM("account",{userId:dh("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),type:dh("type").$type().notNull(),provider:dh("provider").notNull(),providerAccountId:dh("providerAccountId").notNull(),refresh_token:dh("refresh_token"),access_token:dh("access_token"),expires_at:cr("expires_at"),token_type:dh("token_type"),scope:dh("scope"),id_token:dh("id_token"),session_state:dh("session_state")},a=>({compositePk:dT({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??dM("session",{sessionToken:dh("sessionToken").primaryKey(),userId:dh("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),expires:dq("expires",{mode:"date"}).notNull()}),e=a.verificationTokensTable??dM("verificationToken",{identifier:dh("identifier").notNull(),token:dh("token").notNull(),expires:dq("expires",{mode:"date"}).notNull()},a=>({compositePk:dT({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??dM("authenticator",{credentialID:dh("credentialID").notNull().unique(),userId:dh("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:dh("providerAccountId").notNull(),credentialPublicKey:dh("credentialPublicKey").notNull(),counter:cr("counter").notNull(),credentialDeviceType:dh("credentialDeviceType").notNull(),credentialBackedUp:b3("credentialBackedUp").notNull(),transports:dh("transports")},a=>({compositePK:dT({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=bO(c).id.hasDefault;return a.insert(c).values(f?e:{...e,id:d}).returning().then(a=>a[0])},getUser:async b=>a.select().from(c).where(d3(c.id,b)).then(a=>a.length>0?a[0]:null),getUserByEmail:async b=>a.select().from(c).where(d3(c.email,b)).then(a=>a.length>0?a[0]:null),createSession:async b=>a.insert(e).values(b).returning().then(a=>a[0]),getSessionAndUser:async b=>a.select({session:e,user:c}).from(e).where(d3(e.sessionToken,b)).innerJoin(c,d3(c.id,e.userId)).then(a=>a.length>0?a[0]:null),async updateUser(b){if(!b.id)throw Error("No user id.");let[d]=await a.update(c).set(b).where(d3(c.id,b.id)).returning();if(!d)throw Error("No user found.");return d},updateSession:async b=>a.update(e).set(b).where(d3(e.sessionToken,b.sessionToken)).returning().then(a=>a[0]),async linkAccount(b){await a.insert(d).values(b)},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,d3(d.userId,c.id)).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId))).then(a=>a[0]);return e?.user??null},async deleteSession(b){await a.delete(e).where(d3(e.sessionToken,b))},createVerificationToken:async b=>a.insert(f).values(b).returning().then(a=>a[0]),useVerificationToken:async b=>a.delete(f).where(d5(d3(f.identifier,b.identifier),d3(f.token,b.token))).returning().then(a=>a.length>0?a[0]:null),async deleteUser(b){await a.delete(c).where(d3(c.id,b))},async unlinkAccount(b){await a.delete(d).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId)))},getAccount:async(b,c)=>a.select().from(d).where(d5(d3(d.provider,c),d3(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>a.insert(g).values(b).returning().then(a=>a[0]??null),getAuthenticator:async b=>a.select().from(g).where(d3(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>a.select().from(g).where(d3(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){let d=await a.update(g).set({counter:c}).where(d3(g.credentialID,b)).returning().then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,b);if(aK(a,iR))return function(a,b){let{usersTable:c,accountsTable:d,sessionsTable:e,verificationTokensTable:f,authenticatorsTable:g}=function(a={}){let b=a.usersTable??ii("user",{id:ie("id").primaryKey().$defaultFn(()=>crypto.randomUUID()),name:ie("name"),email:ie("email").unique(),emailVerified:h_("emailVerified",{mode:"timestamp_ms"}),image:ie("image")}),c=a.accountsTable??ii("account",{userId:ie("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),type:ie("type").$type().notNull(),provider:ie("provider").notNull(),providerAccountId:ie("providerAccountId").notNull(),refresh_token:ie("refresh_token"),access_token:ie("access_token"),expires_at:h_("expires_at"),token_type:ie("token_type"),scope:ie("scope"),id_token:ie("id_token"),session_state:ie("session_state")},a=>({compositePk:it({columns:[a.provider,a.providerAccountId]})})),d=a.sessionsTable??ii("session",{sessionToken:ie("sessionToken").primaryKey(),userId:ie("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),expires:h_("expires",{mode:"timestamp_ms"}).notNull()}),e=a.verificationTokensTable??ii("verificationToken",{identifier:ie("identifier").notNull(),token:ie("token").notNull(),expires:h_("expires",{mode:"timestamp_ms"}).notNull()},a=>({compositePk:it({columns:[a.identifier,a.token]})})),f=a.authenticatorsTable??ii("authenticator",{credentialID:ie("credentialID").notNull().unique(),userId:ie("userId").notNull().references(()=>b.id,{onDelete:"cascade"}),providerAccountId:ie("providerAccountId").notNull(),credentialPublicKey:ie("credentialPublicKey").notNull(),counter:h_("counter").notNull(),credentialDeviceType:ie("credentialDeviceType").notNull(),credentialBackedUp:h_("credentialBackedUp",{mode:"boolean"}).notNull(),transports:ie("transports")},a=>({compositePK:it({columns:[a.userId,a.credentialID]})}));return{usersTable:b,accountsTable:c,sessionsTable:d,verificationTokensTable:e,authenticatorsTable:f}}(b);return{async createUser(b){let{id:d,...e}=b,f=bO(c).id.hasDefault;return a.insert(c).values(f?e:{...e,id:d}).returning().get()},getUser:async b=>await a.select().from(c).where(d3(c.id,b)).get()??null,getUserByEmail:async b=>await a.select().from(c).where(d3(c.email,b)).get()??null,createSession:async b=>a.insert(e).values(b).returning().get(),getSessionAndUser:async b=>await a.select({session:e,user:c}).from(e).where(d3(e.sessionToken,b)).innerJoin(c,d3(c.id,e.userId)).get()??null,async updateUser(b){if(!b.id)throw Error("No user id.");let d=await a.update(c).set(b).where(d3(c.id,b.id)).returning().get();if(!d)throw Error("User not found.");return d},updateSession:async b=>await a.update(e).set(b).where(d3(e.sessionToken,b.sessionToken)).returning().get()??null,async linkAccount(b){await a.insert(d).values(b).run()},async getUserByAccount(b){let e=await a.select({account:d,user:c}).from(d).innerJoin(c,d3(d.userId,c.id)).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId))).get();return e?.user??null},async deleteSession(b){await a.delete(e).where(d3(e.sessionToken,b)).run()},createVerificationToken:async b=>a.insert(f).values(b).returning().get(),useVerificationToken:async b=>await a.delete(f).where(d5(d3(f.identifier,b.identifier),d3(f.token,b.token))).returning().get()??null,async deleteUser(b){await a.delete(c).where(d3(c.id,b)).run()},async unlinkAccount(b){await a.delete(d).where(d5(d3(d.provider,b.provider),d3(d.providerAccountId,b.providerAccountId))).run()},getAccount:async(b,c)=>a.select().from(d).where(d5(d3(d.provider,c),d3(d.providerAccountId,b))).then(a=>a[0]??null),createAuthenticator:async b=>a.insert(g).values(b).returning().then(a=>a[0]??null),getAuthenticator:async b=>a.select().from(g).where(d3(g.credentialID,b)).then(a=>a[0]??null),listAuthenticatorsByUserId:async b=>a.select().from(g).where(d3(g.userId,b)).then(a=>a),async updateAuthenticatorCounter(b,c){let d=await a.update(g).set({counter:c}).where(d3(g.credentialID,b)).returning().then(a=>a[0]);if(!d)throw Error("Authenticator not found.");return d}}}(a,b);throw Error(`Unsupported database type (${typeof a}) in Auth.js Drizzle adapter.`)}(fq,{usersTable:fk,accountsTable:fl,sessionsTable:fm,verificationTokensTable:fn}),providers:[{id:"google",name:"Google",type:"oidc",issuer:"https://accounts.google.com",style:{brandColor:"#1a73e8"},options:{clientId:process.env.AUTH_GOOGLE_ID,clientSecret:process.env.AUTH_GOOGLE_SECRET,authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}}}],session:{strategy:"jwt"},callbacks:{jwt:async({token:a,user:b,account:c})=>(b&&(a.id=b.id,a.role=b.role),c&&(a.accessToken=c.access_token),a),session:async({session:a,token:b})=>(a.user&&(a.user.id=b.id,a.user.role=b.role),a)}});a.s(["auth",0,pb,"signIn",0,pc],18145)}];

//# sourceMappingURL=_16e6e79e._.js.map